var $kyu = $kyu || {}; $kyu.loadedKyubitJS = []; $kyu.dashboardFont = "Calibri"; $kyu.dashboardFontColor = "#333333"; $kyu.dashboardFontSize = 12; $kyu.dashboardLargeFontSize = 16; $kyu.fontSize = 12; $kyu.titleFontSize = 14; $kyu.fontColor = "#333333"; $kyu.internalChartID = 0; $kyu.configs = []; $kyu.mainColor = "#00a3df"; $kyu.refreshEnabled = !1; $kyu.internalTileNo = 100; $kyu.lastEvent = null; $kyu.rtime; $kyu.timeout = !1; $kyu.delta = 200; $kyu.token = null; $kyu.memberColors = [];
var MOBILE_APP = !1, IS_MOBILE = !1, globalMode = "Dashboard", currentView = "Dashboard", largeTileMode = !1, ANALYSIS_TYPE = 1, currentDataSourceId; $kyu.getSessionAuthInfo = function (a) { $.ajax({ crossDomain: !0, type: "GET", contentType: "application/json; charset=utf-8", url: $kyu.globalConfig.URL + "/WebServices/Users.asmx/GetSessionAuthenticationInfoAPI", data: "{}", dataType: "jsonp", success: function (b) { a(b) } }) };
$kyu.login = function (a) { var b = "{'userName':'" + a.userName + "','password':'" + a.password + "'}", b = b.replace(/'/g, '"'), b = JSON.parse(b); $.ajax({ crossDomain: !0, type: "GET", contentType: "application/json; charset=utf-8", url: $kyu.globalConfig.URL + "/WebServices/Users.asmx/LoginAPI", data: b, dataType: "jsonp", success: function (b) { $kyu.token = b.Token; a.callback(b) } }) };
$kyu.loginWin = function (a) { var b = "{'domain':'" + a.domain + "','userName':'" + a.userName + "','password':'" + a.password + "'}", b = b.replace(/'/g, '"'), b = JSON.parse(b); $.ajax({ crossDomain: !0, type: "GET", contentType: "application/json; charset=utf-8", url: $kyu.globalConfig.URL + "/WebServices/Users.asmx/LoginWinAPI", data: b, dataType: "jsonp", success: function (b) { $kyu.token = b.Token; a.callback(b) } }) };
$kyu.logOut = function (a) { var b; b = "{'domain':'1'}".replace(/'/g, '"'); b = JSON.parse(b); $.ajax({ crossDomain: !0, type: "GET", contentType: "application/json; charset=utf-8", url: $kyu.globalConfig.URL + "/WebServices/Users.asmx/LogOutAPI", data: b, dataType: "jsonp", success: function (b) { a.callback(b) } }) };
$kyu.openDashboard = function (a) { var b = $kyu.globalConfig.URL + "/Forms/Dashboard.aspx?DashboardID=" + a.DashboardID, b = b + (a.Align ? "&align=" + a.Align : ""), b = b + (a.Font ? "&font=" + a.Font : ""), b = b + (a.FontColor ? "&fontColor=" + a.FontColor : ""), b = b + (a.FontSize ? "&tileFontSize=" + a.FontSize : ""), b = b + (a.LargeTileHeight ? "&largeTileHeight=" + a.LargeTileHeight : ""); $("#" + a.IFrameID).attr("src", b) };
$kyu.openPublishedReport = function (a) { var b = $kyu.globalConfig.URL + "Report.aspx?Analysis=" + a.AnalysisAlias; $("#" + a.IFrameID).attr("src", b) }; $kyu.openOLAPReport = function (a) { var b = $kyu.globalConfig.URL + "Forms/prepareReport.aspx?DefaultReport=1&AnalysisID=" + a.AnalysisID; $("#" + a.IFrameID).attr("src", b) };
$kyu.openWindow = function (a, b) { var d = document.createElement("form"); b && (d.target = "_blank"); d.method = "POST"; d.action = a; d.style.display = "none"; var e = document.createElement("input"); e.type = "hidden"; e.name = "token"; e.value = $kyu.token; d.appendChild(e); document.body.appendChild(d); d.submit(); document.body.removeChild(d) };
$kyu.openIFrame = function (a, b) { var d = document.createElement("form"); d.method = "POST"; d.action = a; d.style.display = "none"; d.target = b; var e = document.createElement("input"); e.type = "hidden"; e.name = "token"; e.value = $kyu.token; d.appendChild(e); document.body.appendChild(d); d.submit(); document.body.removeChild(d) };
$kyu.initVisualization = function (a, b) {
    $kyu.HideMenu(); $kyu.dashboardFont = $kyu.globalConfig.font; $kyu.dashboardFontSize = $kyu.globalConfig.chartFontSize.replace("px", "").replace("pt", ""); $kyu.dashboardFontColor = $kyu.globalConfig.chartFontColor; $kyu.fontSize = $kyu.globalConfig.fontSize; $kyu.fontColor = $kyu.globalConfig.fontColor; $kyu.titleFontSize = $kyu.globalConfig.titleFontSize; $kyu.mainColor = $kyu.globalConfig.mainColor; $kyu.config = b; $kyu.configs.push({ divID: a, config: b }); b.URL || ($kyu.config.URL = $kyu.globalConfig.URL);
    b.font && ($kyu.dashboardFont = b.font); b.chartFontSize && ($kyu.dashboardFontSize = b.chartFontSize.replace("px", "").replace("pt", "")); b.chartFontColor && ($kyu.dashboardFontColor = b.chartFontColor); b.fontSize && ($kyu.fontSize = b.fontSize); b.fontColor && ($kyu.fontColor = b.fontColor); b.titleFontSize && ($kyu.titleFontSize = b.titleFontSize); $("#" + a).css("width", b.width); $("#" + a).css("height", b.height); $kyu.addFullHTML(); $("#mouseoverbox").css("font-family", $kyu.dashboardFont); $kyu.loadScript(a, b); $("#" + a).bind("mousedown",
        function () { $kyu.HideMenu() })
}; $(window).resize(function () { $kyu.rtime = new Date; !1 === $kyu.timeout && ($kyu.timeout = !0, setTimeout($kyu.resizeend, $kyu.delta)) }); $kyu.resizeend = function () { new Date - $kyu.rtime < $kyu.delta ? setTimeout($kyu.resizeend, $kyu.delta) : ($kyu.timeout = !1, $kyu.renderAgain(), $("#LargeTileDiv").is(":visible") && $kyu.renderLargeTile(null, !0), $("#GenericPopupDiv").is(":visible") && $kyu.renderDrillthrough(), $("#CubeStructurePickerDiv").is(":visible") && $kyu.ShowCenterFixed("CubeStructurePickerDiv")) };
$kyu.loadScript = function (a, b, d) {
    var e; "Column_Stack" == b.chartType ? e = "ColumnStackChart.js" : "Column_100" == b.chartType ? e = "Column100Chart.js" : "Bubble_Chart" == b.chartType ? e = "BubbleChart.js" : "Area_Chart" == b.chartType ? e = "AreaChart.js" : "Area_Stack" == b.chartType ? e = "AreaStackChart.js" : "Area_100" == b.chartType ? e = "Area100Chart.js" : "Pie_Chart" == b.chartType || "Doughnut_Chart" == b.chartType ? e = "PieChart.js" : "KPI" == b.chartType ? e = "KPIDash.js" : "Gauge_Meter" == b.chartType ? e = "Gauge.js" : "List" == b.chartType ? e = "List.js" : "Card" ==
        b.chartType || "CardSmall" == b.chartType ? e = "Card.js" : "Table" == b.chartType ? e = "Table.js" : "Scorecard" == b.chartType ? e = "Scorecard.js" : "Table" == b.chartType ? e = "Table.js" : "Combo" == b.chartType ? e = "ComboChart.js" : "Geo_Map" == b.chartType ? e = "GeoMap.js" : "Goal_Meter" == b.chartType ? e = "GoalMeter.js" : "TreeMap" == b.chartType ? e = "TreeMap.js" : "Bar_Chart" == b.chartType ? e = "BarChart.js" : "Bar_Stack" == b.chartType ? e = "BarChart.js" : "Bar_100" == b.chartType ? e = "BarChart.js" : "Sunburst" == b.chartType ? e = "Sunburst.js" : "HeatMap" == b.chartType &&
            (e = "HeatMap.js"); -1 < $.inArray(e, $kyu.loadedKyubitJS) || "Line_Chart" == b.chartType || "Spline_Chart" == b.chartType || "Column_Chart" == b.chartType ? d ? d() : $kyu.showVisualization(a, b) : ($kyu.loadedKyubitJS.push(e), e = $kyu.config.URL + "/Javascripts/Tiles/" + e, "TreeMap" == b.chartType ? $.when($.getScript($kyu.config.URL + "/Javascripts/jquery-ui-1.9.2.custom.min.js"), $.getScript($kyu.config.URL + "/Javascripts/jquery.ui.treemap.js"), $.getScript(e), $.Deferred(function (a) { $(a.resolve) })).done(function () {
                setTimeout(function () {
                    d ?
                        d() : $kyu.showVisualization(a, b)
                }, 20)
            }) : "Geo_Map" == b.chartType ? $.when($.getScript($kyu.config.URL + "/Javascripts/jquery-jvectormap-2.0.3.min.js"), $.getScript($kyu.config.URL + "/Javascripts/GeoMaps/regions.js"), $.getScript(e), $.getScript($kyu.config.URL + "/Javascripts/Tiles/ComboChart.js"), $.Deferred(function (a) { $(a.resolve) })).done(function () { setTimeout(function () { d ? d() : $kyu.showVisualization(a, b) }, 20) }) : $.getScript(e, function () { d ? d() : $kyu.showVisualization(a, b) }))
};
$kyu.findConfig = function (a) { var b = null; $.each($kyu.configs, function (d, e) { if (e.divID == a) return b = e.config, !1 }); return b }; $kyu.showVisualization = function (a, b) { var d = $kyu.createTile(a, b); $kyu.renderTile(d, b) };
$kyu.createTile = function (a, b) {
    $kyu.internalChartID++; var d = []; d.push('<table id="KyubitTile' + $kyu.internalChartID + '" border="0"  class="tile tileBorderRound kyubitTile" data-title="' + b.name + '" '); d.push('style="width:100%;height:100%;"> '); d.push('<tbody><tr><td style="vertical-align:top;">'); d.push('<table cellpadding="0" cellspacing="0" style="width:100%;"><tbody>'); d.push('<tr><td class="tileTitle" style="font-family:' + $kyu.dashboardFont + ";color:" + $kyu.fontColor + ";font-size:" + $kyu.titleFontSize +
        '">' + b.name + "</td>"); d.push('<td class="tileToolbar">&nbsp;'); if (b.openAnalysisIcon && b.analysisId) { var e = $kyu.globalConfig.analysisIcon ? $kyu.globalConfig.analysisIcon : $kyu.config.URL + "/images/analysis.png"; d.push('<a style="float:right" href="javascript:$kyu.continueAnalysis(' + b.analysisId + ')"><img class="iconAnalysis" src="' + e + '" border="0" style="align:top" title="' + $kyu.lng("_openAnalysis") + '"></a>&nbsp;') } b.allowLargeView && (e = $kyu.globalConfig.enlargeIcon ? $kyu.globalConfig.enlargeIcon : $kyu.config.URL +
            "/images/expand12_pos.png", d.push('<a class="magnify" style="float: right; margin-left: 5px; margin-right: 5px; " href="javascript:void(0)" onclick="$kyu.showLargeTile(this)"><img class="iconAnalysis" src="' + e + '" border="0" style="align:top;" title="' + $kyu.lng("_showEnlarged") + '"></a>')); b.dashboardID && (e = $kyu.globalConfig.openDashboardIcon ? $kyu.globalConfig.openDashboardIcon : $kyu.config.URL + "/images/dash/childDashboard.png", d.push('&nbsp;<a style="float:right;" href="javascript:$kyu.openNewTab(\'' +
                b.URL + "/Dashboard/" + b.dashboardID + '\')"><img class="iconDashboard" src="' + e + '" ' + ($kyu.globalConfig.openDashboardIcon ? "" : 'width="16" height="16"') + ' border="0" style="align:top;margin-bottom:1px" title="' + $kyu.lng("_openDashboard") + '"/></a>')); b.refreshTime && (d.push('<div class="showLastRefresh" style="padding-right:10px;float:right;font-family:' + $kyu.dashboardFont + ";color:" + $kyu.fontColor + ";font-size:" + $kyu.fontSize + '"></div>&nbsp;'), $kyu.refreshEnabled || setTimeout($kyu.refreshTiles, 6E4), $kyu.refreshEnabled =
                    !0); d.push("</td></tr></tbody></table>"); d.push("</td></tr>"); b.description && d.push('<tr><td colspan="2" style="font-family:' + $kyu.dashboardFont + ";color:" + $kyu.fontColor + ";font-size:" + $kyu.fontSize + '">' + b.description + "</td></tr>"); d.push('<tr><td class="tileContent" style="margin-top:20px;height:100%;vertical-align:top"><div id="renderSurface' + $kyu.internalChartID + '" class="renderSurface" style="overflow: visible;"></div></div></td></tr></tbody></table>'); $("#" + a).html(d.join("")); d = $("#" + a).find(".kyubitTile");
    b.analysisId ? d.data("multivalueanalysisid", b.analysisId) : b.queryId ? d.data("multivaluequeryid", b.queryId) : b.kpiId && d.data("kpiid", b.kpiId); d.data("presentationtype", b.chartType); b.colorPallete && d.data("opt_colorpallete", b.colorPallete); b.description && d.data("tiledesc", b.description); b.refreshTime && (d.data("showlastrefresh", "1"), d.data("tilerefresh", b.refreshTime), d.data("afterrefresh", 1), d.data("tilerefreshin", new Number($(d).data("tilerefresh")))); b.clickURL && d.data("customurl", b.clickURL); b.minYOnChart &&
        d.data("opt_ymin", b.minYOnChart); b.maxYOnChart && d.data("opt_ymax", b.maxYOnChart); b.tableDataBar && d.data("opt_databar", b.tableDataBar); b.secondaryQueryAnalysisID && d.data("opt_secondaryqueryanalysisid", b.secondaryQueryAnalysisID); b.secondaryChart && d.data("opt_secondarychart", b.secondaryChart); b.separateAxis && d.data("opt_separateaxis", b.separateAxis); b.valueLabels && d.data("opt_displayvalues", b.valueLabels); b.valueLabelsFilterCategory && d.data("opt_displayvaluesfilternames", b.valueLabelsFilterCategory);
    b.valueLabelsFilterSeries && d.data("opt_displayvaluesfilterseries", b.valueLabelsFilterSeries); b.specificCategories && d.data("opt_specificcategories", b.specificCategories); b.specificSeries && d.data("opt_specificseries", b.specificSeries); b.legend && d.data("opt_legend", b.legend); b.pivotChart && d.data("opt_pivottile", b.pivotChart); b.averageLine && d.data("opt_averageline", b.averageLine); b.trendLine && d.data("opt_trendline", b.trendLine); b.miniChart && d.data("opt_minichart", b.miniChart); b.geoMap && d.data("geomap",
        b.geoMap); b.cacheMinutes && d.data("cacheminutes", b.cacheMinutes); b.cacheKey && d.data("cachekey", b.cacheKey); b.slicers && 0 < b.slicers.length && d.data("slicers", JSON.stringify(b.slicers)); b.sqlFilters && 0 < b.sqlFilters.length && d.data("sqlFilters", JSON.stringify(b.sqlFilters)); b.axisTitles && d.data("opt_axistitles", 1); b.gaugeColorMeter && d.data("opt_colormeter", "Show"); b.gaugeLastChange && d.data("opt_gaugelastchange", "Show"); b.gaugePointer && d.data("opt_gaugepointer", b.gaugePointer); b.categoryAggregate && d.data("opt_categoryaggregate",
            b.categoryAggregate); b.seriesAggregate && d.data("opt_seriesaggregate", b.seriesAggregate); b.geoMarkersAnalysisID && d.data("opt_markersqueryanalysisid", "#" + b.geoMarkersAnalysisID); b.geoMarkersQueryID && d.data("opt_markersqueryanalysisid", b.geoMarkersQueryID); b.geoMarkersMeasureColor && d.data("opt_markersmeasurecolor", b.geoMarkersMeasureColor); b.geoMarkersMeasureRadius && d.data("opt_markersmeasureradius", b.geoMarkersMeasureRadius); b.geoMarkersColor1 && d.data("opt_markerscolor1", b.geoMarkersColor1); b.geoMarkersColor2 &&
                d.data("opt_markerscolor2", b.geoMarkersColor2); b.geoMarkersRadius1 && d.data("opt_markersradius1", b.geoMarkersRadius1); b.geoMarkersRadius2 && d.data("opt_markersradius2", b.geoMarkersRadius2); b.geoDominantSeries && d.data("opt_dominantseries", b.geoDominantSeries); b.gaugePointer && d.data("opt_gaugepointer", b.gaugePointer); b.colorMeter && d.data("opt_colormeter", b.colorMeter); b.primarySetName && d.data("multivalueanalysisname", b.primarySetName); b.secondarySetName && d.data("opt_secondaryqueryanalysisname", b.secondarySetName);
    b.primaryChart && d.data("opt_primarychart", b.primaryChart); b.deltaChart && d.data("opt_deltachart", b.deltaChart); b.gridLines ? d.data("opt_grid", b.gridLines) : d.data("opt_grid", "F"); b.allowAnalytics ? d.data("opt_allowanalytics", b.allowAnalytics) : d.data("opt_allowanalytics", 2); e = $(d).find(".renderSurface"); b.width && $(e).width(d.width()); b.height && $(e).height(b.height); $(d).on("click", function () { $kyu.HideMenu() }); $(d).on("contextmenu", function () { return !1 }); return d[0]
};
$kyu.refreshTiles = function () {
    $(".kyubitTile").each(function (a, b) {
        var d = $(b).data("tilerefresh"); "1" == $(b).data("showlastrefresh") && (null != $(b).data("afterrefresh") ? $(b).data("afterrefresh", new Number($(b).data("afterrefresh") + 1)) : $(b).data("afterrefresh", 0)); d && ("" != d && "0" != d && 0 < d) && ($(b).data("tilerefreshin") ? 1 == $(b).data("tilerefreshin") ? ($(b).data("tilerefreshin", new Number($(b).data("tilerefresh"))), $kyu.renderTile(b), $(b).data("afterrefresh") && $(b).data("afterrefresh", 0)) : $(b).data("tilerefreshin",
            new Number($(b).data("tilerefreshin") - 1)) : $(b).data("tilerefreshin", new Number($(b).data("tilerefresh")))); if (null != $(b).data("afterrefresh")) { d = ""; if (0 == $(b).data("afterrefresh")) d = $kyu.lng("_now"); else { var e = 0, f = $(b).data("afterrefresh"); 59 < f && (e = Math.floor(f / 60), f -= 60 * e); 0 < e && (d = e + " hrs "); d += f + " mins" } $(b).find(".showLastRefresh").html(d) }
    }); setTimeout($kyu.refreshTiles, 6E4)
};
$kyu.addFullHTML = function () {
    if (0 == $("#CubeStructurePickerDiv").length) {
        var a = []; a.push('<div id="CubeStructurePickerDiv" style="height:550px;width:400px;display:none;z-index:203;font-family:' + $kyu.dashboardFont + ";color:" + $kyu.fontColor + ";font-size:" + $kyu.FontSize + '">'); a.push('<table style="height:550px;width:400px;border-spacing:0;box-shadow: 0px 0px 10px 4px rgba(119, 119, 119, 0.75);background-color:white" cellpadding="0" cellspacing="0" border="0">'); a.push("<tr>"); a.push('<td style="height:40px;padding-left:12px;border-radius:0px 0px;background-color:white" id="CubeStructurePickerTitle">' +
            $kyu.lng("_cubePicker") + "</td>"); a.push("</tr>"); a.push("<tr>"); a.push('<td style="vertical-align:top;background-color:white;" >'); a.push('<div style="overflow:auto;height:450px;width:390px;padding:5px 0px 0px 3px" id="cubeStructurePickerCell" ></div>'); a.push("</td>"); a.push("</tr>"); a.push("<tr>"); a.push('<td  style="padding:10px 12px 12px 10px;text-align:right" class="dialogBottom" >'); a.push('<div class="rbutton" style="float:right;"><a href="javascript:void(0)" onclick="hideCubeStructurePicker();">' +
                $kyu.lng("_close") + "</a></div>"); a.push("</td>"); a.push("</tr>"); a.push("</table>"); a.push("</div>"); a.push('<table id="GenericPopupDiv" style="position:fixed;height:820px;width:800px;z-index:202;display:none;font-family:' + $kyu.dashboardFont + ";color:" + $kyu.fontColor + ";font-size:" + $kyu.FontSize + '"cellpadding="0" cellspacing="0" border="0" >'); a.push("<tr>"); a.push('<td class="dialogTop DragHolder" style="height:40px;padding-left:12px;background-color:white;">'); a.push('<div id="GenericPopupHeader" style="vertical-align:middle;line-height:40px;font-size:' +
                    $kyu.FontSize + '">'); a.push("Generic Title"); a.push("</div>"); a.push("</td>"); a.push("</tr>"); a.push("<tr>"); a.push('<td style="padding-top:0px;padding-bottom:0px; background-color:white; vertical-align:top;" id="GenericPopupPanels">'); a.push('<div style="overflow:auto; width:800px; height:720px;padding-left:12px" id="GenericPopupContent">'); a.push("</div>"); a.push("</td>"); a.push("</tr>"); a.push("<tr>"); a.push('<td class="dialogBottom" style="background-color:white;padding-bottom:10px">'); a.push('<div class="rbutton" style="float:right;margin-right:15px;"><a href="javascript:void(0)"  style="text-decoration:none;"onclick="$kyu.hideGenericPopup()">' +
                        $kyu.lng("_close") + "</a></div>"); a.push('<div id="btnDecompDrillthroughExcel" class="rbutton" style="float:right;margin-right:15px;"><a href="javascript:void(0)" style="text-decoration:none;" onclick="DrillthroughToExcel();">' + $kyu.lng("_openInExcel") + "</a></div>"); a.push("</td>"); a.push("</tr>"); a.push("</table>"); a.push('<table id="LargeTileDiv" style="width:800px;height:840px;margin-top:0px;padding:15px;z-index:201;display:none" cellpadding="0" cellspacing="0" border="0" >'); a.push("<tr>"); a.push('<td style="padding-left:17px;height:50px;background-color:white;">');
        a.push('<div id="LargeTileHeader" style="padding-top:10px;vertical-align:middle;line-height:30px;font-family:' + $kyu.dashboardFont + ";font-size:" + $kyu.titleFontSize + ";color:" + $kyu.fontColor + '">Large Tile Title</div>'); a.push('<div id="LargeTileDesc" style="font-weight:100;padding:0px 10px 10px 0px;font-family:' + $kyu.dashboardFont + ";font-size:" + $kyu.fontSize + ";color:" + $kyu.fontColor + '"></div>'); a.push("</td>"); a.push("</tr>"); a.push("<tr>"); a.push('<td style="padding-top:0px;padding-bottom:0px; background-color:white; vertical-align:middle;" id="LargeTilePanels">');
        a.push('<table id="LargeChartTile" class="tile" data-opt_databar="1" border="0" style="border:0px;display:none;width: 100%;vertical-align:middle;text-align:center">'); a.push("<tr>"); a.push('<td class="tileContent" style="margin-top: 20px;text-align:center;vertical-align:top;">'); a.push('<div class="renderSurface" id="renderSurfaceLarge" style="padding-right:20px; margin-left:10px;width:800px;height:700px;text-align:center;" ></div>'); a.push("</td>"); a.push('<td style="min-width:300px;vertical-align:top;text-align:left;padding:5px;display:none" id="decompFiltersLarge">-</td>');
        a.push("</tr>"); a.push("</table>"); a.push("</td>"); a.push("</tr>"); a.push("<tr>"); a.push('<td class="dialogBottom no-print" style="background-color:white;padding:10px 20px 10px 10px; vertical-align:bottom">'); a.push('<div class="rbutton" style="float:right;margin:10px;font-family:' + $kyu.dashboardFont + ";font-size:" + $kyu.fontSize + ";color:" + $kyu.fontColor + '""><a href="javascript:hideLargeTile();" style="text-decoration:none;">' + $kyu.lng("_close") + "</a></div>"); a.push('<div id="btnExcelLargeTile" class="rbutton" style="float:right;margin:10px 10px 10px 10px;font-family:' +
            $kyu.dashboardFont + ";font-size:" + $kyu.fontSize + ";color:" + $kyu.fontColor + '"><a href="javascript:void(0)" style="text-decoration:none;" onclick="$kyu.HideMenu();openSpreedsheet()">' + $kyu.lng("__openInExcel") + "</a></div>"); a.push('<div id="btnContinueAnalysis" class="rbutton" style="float:right;margin:10px 10px 10px 10px;font-family:' + $kyu.dashboardFont + ";font-size:" + $kyu.fontSize + ";color:" + $kyu.fontColor + '""><a href="javascript:void(0)" style="text-decoration:none;" onclick="$kyu.continueAnalysis()">' +
                $kyu.lng("_openAnalysis") + "</a></div>"); a.push('<div id="undoAnalysisLargeTile" class="rbutton undoAdditional" style="float:right;margin:10px 10px 10px 0px;display:none;font-family:' + $kyu.dashboardFont + ";font-size:" + $kyu.fontSize + ";color:" + $kyu.fontColor + '""><a href="javascript:void(0)" style="text-decoration:none;" onclick="undoAdditionalAnalysis(\'LargeChartTile\')">Back</a></div>'); a.push("</td>"); a.push("</tr>"); a.push("</table>"); a.push('<form id="KyubitExportForm" action="' + $kyu.config.URL +
                    '/Forms/PDFExport.aspx" method="post">'); a.push('<input id="KyubitTitle" name="KyubitTitle" type="hidden" value="" />'); a.push('<input id="KyubitExportDescription" name="KyubitExportDescription" type="hidden" value="" />'); a.push('<input id="KyubitDataSourceName" name="KyubitDataSourceName" type="hidden" value="" />'); a.push('<input id="KyubitMeasureNames" name="KyubitMeasureNames" type="hidden" value="" />'); a.push('<input id="KyubitPresentationType" name="KyubitPresentationType" type="hidden" value="" />');
        a.push('<input id="KyubitCategoryName" name="KyubitCategoryName" type="hidden" value="" />'); a.push('<input id="KyubitSeriesName" name="KyubitSeriesName" type="hidden" value="" />'); a.push('<input id="KyubitFilters" name="KyubitFilters" type="hidden" value="" />'); a.push('<input id="KyubitDataValues" name="KyubitDataValues" type="hidden" value="" />'); a.push('<input id="KyubitNumericValues" name="KyubitNumericValues" type="hidden" value="" />'); a.push('<input id="KyubitImageData" name="KyubitImageData" type="hidden" value="" />');
        a.push("</form>"); a.push('<form id="ContinueAnalysisForm" action="' + $kyu.config.URL + '/Forms/Analysis.aspx?ContinueDecomposition=1&DataSourceID=" method="post" target="_blank">'); a.push('<input id="ContinueAdHocAnalysisDetails" name="ContinueAdHocAnalysisDetails" type="hidden" value="" />'); a.push('<input id="ContinueAdHocAnalysis" name="ContinueAdHocAnalysis" type="hidden" value="1" />'); a.push("</form>"); a.push('<div id="kyubitDialogShadow" style="display: none; position:fixed;background-color:#6c7582;opacity:0.5;left:0px;top:0px"></div>');
        a.push('<div id="mouseoverbox" class="mouseoverbox" style="z-index:205"></div>'); $(document.body).append(a.join("")); $("#cubeStructurePickerCell").data("datasourceid", ""); $("#kyubitDialogShadow").width($(window).width()); $("#kyubitDialogShadow").height($(window).height()); $("#LargeTileDiv").on("contextmenu", function () { return !1 }); $("#LargeTileDiv").bind("mousedown", function () { $kyu.HideMenu() })
    }
};
$kyu.renderTile = function (a, b, d) {
    var b = null, e = $(a).data("presentationtype"), f = $(a).find(".renderSurface"); $(f).empty(); $(f).css("margin-top", ""); $(f).css("overflow", "visible"); var g = $(a).find(".tileTitle").html(), i = "", h = ""; if ($(a).data("slicers") && 0 < $(a).data("slicers").length) { var j = JSON.parse($(a).data("slicers")); $.each(j, function (a, b) { i += "x!@!" + b.slicerID + "!@!" + b.slicerValue + "!@!0@@@" }) } $(a).data("sqlFilters") && 0 < $(a).data("sqlFilters").length && (j = JSON.parse($(a).data("sqlFilters")), $.each(j, function (a,
        b) { h += b.parameterName + "!@!!@!" + b.value + "!@!" + b.type + "@@@" })); if (!$(a).data("additionalcategory") && ("Sunburst" == e || "Table" == e && ("1" == $(a).data("opt_allowanalytics") || "2" == $(a).data("opt_allowanalytics")))) b = 1; j = "'cacheMinutes':0, 'cacheKey':null"; $(a).data("cacheminutes") && $(a).data("cachekey") && (j = "'cacheMinutes':" + $(a).data("cacheminutes") + ", 'cacheKey':'" + $(a).data("cachekey") + "'"); if (void 0 != $(a).data("kpiid") && "" != $(a).data("kpiid")) "Scorecard" == $(a).data("presentationtype") ? (executingData = "{'scorecardID':" +
            $(a).data("kpiid") + "," + j + ",'subcubeFilters':'" + i + "','testKPIIDs':" + $kyu.checkNull($(a).data("testKPIIDs")) + ",'token':" + $kyu.checkNull($kyu.token) + "}", executingURL = $kyu.config.URL + "/WebServices/Query.asmx/RunScorecardP") : (executingData = "{'kpiID':" + $(a).data("kpiid") + "," + j + ",'subcubeFilters':'" + i + "','token':" + $kyu.checkNull($kyu.token) + "}", executingURL = $kyu.config.URL + "/WebServices/Query.asmx/RunKPIDataP"); else if (void 0 != $(a).data("multivalueanalysisid") && "" != $(a).data("multivalueanalysisid")) {
                var l =
                    null; $(a).data("additionalcategory") && (l = $(a).data("additionalcategory").split("!,!").pop()); executingData = "{'analysisID':" + $(a).data("multivalueanalysisid") + "," + j + ",'additionalCategory':" + $kyu.checkNull(l) + ",'additionalFilter':" + $kyu.checkNull($(a).data("additionalfilter")) + ",'dashboardFilters':'" + i + "','columnAggregate':" + $kyu.checkNull($(a).data("opt_categoryaggregate")) + ",'rowAggregate':" + $kyu.checkNull($(a).data("opt_seriesaggregate")) + ",'formatting':null, 'loadLatLng':0,'treeAnalytics':" + $kyu.checkNull(b) +
                        ", 'presentation':" + checkNull(e) + ",'token':" + $kyu.checkNull($kyu.token) + "}"; executingURL = $kyu.config.URL + "/WebServices/Query.asmx/RunAnalysisDataP"
            } else executingData = "{'queryID':" + $(a).data("multivaluequeryid") + "," + j + ",'presentationType':" + $kyu.checkNull($(a).data("presentationtype")) + ",'sqlFilters':" + $kyu.checkNull(h) + ",'olapFilters':'" + i + "','columnAggregate':" + $kyu.checkNull($(a).data("opt_categoryaggregate")) + ",'rowAggregate':" + $kyu.checkNull($(a).data("opt_seriesaggregate")) + ",'formatting':null, 'loadLatLng':0,'token':" +
                $kyu.checkNull($kyu.token) + "}", executingURL = $kyu.config.URL + "/WebServices/Query.asmx/RunQueryDataP"; $(a).show(); $kyu.verbose("RENDER -> " + g + ", executingData=" + executingData); $kyu.showProgress($(f).attr("id"), "230px"); executingData = executingData.replace(/'/g, '"'); executingData = JSON.parse(executingData); $.ajax({
                    crossDomain: !0, type: "GET", contentType: "application/json; charset=utf-8", url: executingURL, data: executingData, dataType: "jsonp", success: function (b) {
                        $kyu.verbose(g + " -> SUCCESS"); $kyu.renderSurface(a,
                            b, f); d && d(b)
                    }, error: function (a, b, d) { $kyu.verbose(g + " -> AJAXERROR -> XMLHttpRequest: " + a + ", textStatus: " + b + ",errorThrown: " + d) }
                })
};
$kyu.getDataAndDo = function (a, b, d, e) {
    var f = $("#" + a.divID).closest(".tile"), g = "", i = ""; if (f.data("slicers") && 0 < f.data("slicers").length) { var h = JSON.parse(f.data("slicers")); $.each(h, function (a, b) { g += "x!@!" + b.slicerID + "!@!" + b.slicerValue + "!@!0@@@" }) } f.data("sqlFilters") && 0 < f.data("sqlFilters").length && (h = JSON.parse(f.data("sqlFilters")), $.each(h, function (a, b) { i += b.parameterName + "!@!!@!" + b.value + "!@!" + b.type + "@@@" })); f.data("opt_tilecache") && "0" != f.data("opt_tilecache") && (f.data("tileid"), f.data("opt_tilecache"));
    "undefined" != typeof packFiltersForSubcube && (g = jsonEscape(packFiltersForSubcube(f[0]))); i = ""; !f.data("opt_excludeforfiltering") && f.data("inputparameters") && "" != f.data("inputparameters") && "undefined" != typeof packFiltersForSQL && (i = packFiltersForSQL(f[0])); f = "0"; a.markersQueryAnalysisID && (f = "1"); b ? (executingData = "{'analysisID':" + d + ",'additionalCategory':" + checkNull(null) + ",'additionalFilter':null,'dashboardFilters':'" + g + "','rowAggregate':null,'columnAggregate':null,'formatting':null, 'loadLatLng':" + f +
        ", 'cacheKey':null, 'cacheMinutes':0, 'treeAnalytics':null, 'presentation':" + checkNull(a.presentationType) + ", 'token':" + $kyu.checkNull($kyu.token) + "}", executingURL = $kyu.config.URL + "/WebServices/Query.asmx/RunAnalysisDataP") : (executingData = "{'queryID':" + d + ",'presentationType':'Combo','sqlFilters':" + checkNull(i) + ",'olapFilters':'" + g + "','rowAggregate':null,'columnAggregate':null,'formatting':null,'loadLatLng':" + f + ", 'cacheKey':null, 'cacheMinutes':0,'token':" + $kyu.checkNull($kyu.token) + "}", executingURL =
            $kyu.config.URL + "../WebServices/Query.asmx/RunQueryDataP"); executingData = executingData.replace(/'/g, '"'); executingData = JSON.parse(executingData); $.ajax({ type: "GET", contentType: "application/json; charset=utf-8", url: executingURL, data: executingData, dataType: "jsonp", success: function (b) { if (diagnoseResponse(b.d)) { var d = $("#" + a.divID).closest(".tile"); $kyu.setSpecificCategoriesSeries(d, b); e(a, b) } }, error: function (a, b, d) { verbose(" -> AJAXERROR -> XMLHttpRequest: " + a + ", textStatus: " + b + ",errorThrown: " + d) } })
};
$kyu.renderAgain = function () { $(".kyubitTile").each(function (a, b) { var d = $(b).find(".renderSurface"), e = $kyu.getChartStage($(d).attr("id")).data; $(d).width(100); $(d).height(100); $kyu.removeOLDChartStage($(d).attr("id")); $(d).width($(b).width()); $(d).height($(b).height()); $kyu.renderSurface(b, e, d) }) }; $kyu.renderAgainSingle = function (a) { var b = $(a).find(".renderSurface"), d = $kyu.getChartStage($(b).attr("id")).data; $kyu.removeOLDChartStage($(b).attr("id")); $kyu.renderSurface(a, d, b) };
$kyu.renderSurface = function (a, b, d) {
    $kyu.hideProgress($(d).attr("id")); if ($kyu.isValidQueryData(b, d)) {
        if ("Column_Chart" == $(a).data("presentationtype")) return $kyu.drawColumnChart($(d).attr("id"), b); if ("Column_Stack" == $(a).data("presentationtype")) $kyu.drawColumnStackChart($(d).attr("id"), b); else if ("Column_100" == $(a).data("presentationtype")) $kyu.drawColumn100Chart($(d).attr("id"), b); else {
            if ("Line_Chart" == $(a).data("presentationtype")) return $kyu.drawLineChart($(d).attr("id"), b); if ("Bubble_Chart" ==
                $(a).data("presentationtype")) $kyu.drawBubbleChart($(d).attr("id"), b); else if ("Area_Chart" == $(a).data("presentationtype")) $kyu.drawAreaChart($(d).attr("id"), b); else if ("Area_Stack" == $(a).data("presentationtype")) $kyu.drawAreaStackChart($(d).attr("id"), b); else if ("Area_100" == $(a).data("presentationtype")) $kyu.drawArea100Chart($(d).attr("id"), b); else {
                    if ("Pie_Chart" == $(a).data("presentationtype")) return $kyu.drawPieChart($(d).attr("id"), b); if ("Doughnut_Chart" == $(a).data("presentationtype")) return $kyu.drawPieChart($(d).attr("id"),
                        b, !0); if ("KPI" == $(a).data("presentationtype")) $kyu.drawKPI($(d).attr("id"), b); else if ("Gauge_Meter" == $(a).data("presentationtype")) $kyu.drawGauge($(d).attr("id"), b); else if ("List" == $(a).data("presentationtype")) $kyu.drawDashTable($(d).attr("id"), b); else if ("Tree_Map" == $(a).data("presentationtype")) $kyu.drawTreeMap($(d).attr("id"), b); else if ("Geo_Map" == $(a).data("presentationtype")) $kyu.drawGeoMap($(d).attr("id"), b, $(a).data("geomap")); else if ("Card" == $(a).data("presentationtype")) $kyu.drawCard($(d).attr("id"),
                            b); else if ("CardSmall" == $(a).data("presentationtype")) $kyu.drawCard($(d).attr("id"), b, !0); else {
                                if ("Table" == $(a).data("presentationtype")) return $kyu.drawTable($(d).attr("id"), b, "width:100%;font-family:" + $kyu.dashboardFont + ";font-size:" + $kyu.dashboardFontSize + "px;color:" + $kyu.fontColor, null, $kyu.globalConfig.URL); if ("Scorecard" == $(a).data("presentationtype")) $kyu.drawScorecard($(d).attr("id"), b); else if ("Combo" == $(a).data("presentationtype")) $kyu.initComboChart($(d).attr("id"), b); else if ("Goal_Meter" ==
                                    $(a).data("presentationtype")) $kyu.drawGoalMeter($(d).attr("id"), b); else if ("TreeMap" == $(a).data("presentationtype")) $kyu.drawTreeMap($(d).attr("id"), b); else {
                                        if ("Spline_Chart" == $(a).data("presentationtype")) return $kyu.drawLineChart($(d).attr("id"), b, $(a).data("opt_tension") ? $(a).data("opt_tension") : 0.5); if ("HeatMap" == $(a).data("presentationtype")) return $kyu.drawHeatMap($(d).attr("id"), b); "Sunburst" == $(a).data("presentationtype") ? $kyu.drawSunburst($(d).attr("id"), b) : "Bar_Chart" == $(a).data("presentationtype") ?
                                            $kyu.drawBarChart($(d).attr("id"), b) : "Bar_Stack" == $(a).data("presentationtype") ? $kyu.drawBarChart($(d).attr("id"), b, "stack") : "Bar_100" == $(a).data("presentationtype") && $kyu.drawBarChart($(d).attr("id"), b, "100")
                                    }
                            }
                }
        }
    }
};
$kyu.isValidQueryData = function (a, b) { return a.ErrorMessage ? ($(b).html("<span style='color:gray'>" + $kyu.unescapeJsonChars(a.ErrorMessage) + "</span>"), !1) : a.KPIProblem ? ($(b).html("<span style='color:gray'>" + $kyu.unescapeJsonChars(a.KPIProblem) + "</span>"), !1) : void 0 == a.kpis && void 0 == a.successModel && (!a.points || 0 == a.points.length) && !Array.isArray(a) ? ($(b).html("<span style='color:gray' class='NODATA'>" + $kyu.lng("__noDataDisplay") + "</span>"), !1) : !0 }; $kyu.verbose = function () { };
$kyu.showProgress = function (a, b) { var d = "100%"; null != b && (d = b); if (!$kyu.globalConfig.hideProgess) { var e = $kyu.globalConfig.progressIcon ? $kyu.globalConfig.progressIcon : $kyu.globalConfig.URL + "/Images/Loading.gif"; $("#" + a).html("<table style='width:100%;height:" + d + "'><tr><td style='vertical-align:middle;text-align:center'><img src='" + e + "' border='0' align='middle'/></td></tr></table>") } }; $kyu.hideProgress = function (a) { $("#" + a).empty() }; $kyu.diagnoseResponse = function () { return !0 };
function diagnoseResponse() { return !0 } $kyu.checkNull = function (a) { return null == a ? null : isNaN(a) ? "'" + $kyu.jsonEscape(a) + "'" : "'" + a + "'" }; function checkNull(a) { return null == a ? null : isNaN(a) ? "'" + $kyu.jsonEscape(a) + "'" : "'" + a + "'" } function verbose() { } function AjaxBegin() { } function AjaxEnd() { } function getLocaleString(a) { return null == a ? "" : 0 < window.navigator.userAgent.indexOf("MSIE ") || -1 < navigator.userAgent.indexOf("Trident") ? a.toLocaleString() : format("#,###.##", a) }
window.format = function (a, b) {
    if (!a || isNaN(+b)) return b; var b = "-" == a.charAt(0) ? -b : +b, d = 0 > b ? b = -b : 0, e = a.match(/[^\d\-\+#]/g), f = e && e[e.length - 1] || ".", e = e && e[1] && e[0] || ",", a = a.split(f), b = b.toFixed(a[1] && a[1].length), b = +b + "", g = a[1] && a[1].lastIndexOf("0"), i = b.split("."); if (!i[1] || i[1] && i[1].length <= g) b = (+b).toFixed(g + 1); g = a[0].split(e); a[0] = g.join(""); var h = a[0] && a[0].indexOf("0"); if (-1 < h) for (; i[0].length < a[0].length - h;)i[0] = "0" + i[0]; else 0 == +i[0] && (i[0] = ""); b = b.split("."); b[0] = i[0]; if (i = g[1] && g[g.length -
        1].length) { for (var g = b[0], h = "", j = g.length % i, l = 0, k = g.length; l < k; l++)h += g.charAt(l), !((l - j + 1) % i) && l < k - i && (h += e); b[0] = h } b[1] = a[1] && b[1] ? f + b[1] : ""; return (d ? "-" : "") + b[0] + b[1]
}; function CutString2(a, b) { return (new String(a)).length > b ? (new String(a)).substr(0, b) + "..." : a } function extractHierarchy(a) { a = a.split("."); return 1 == a.length ? a[0] : a[0] + "." + a[1] }
$kyu.jsonEscape = function (a) { return a.replace(/[\\]/g, "\\\\").replace(/[\"]/g, "__Q").replace(/[\']/g, "@@AP").replace(/[\b]/g, "\\b").replace(/[\f]/g, "\\f").replace(/[\n]/g, "\\n").replace(/[\r]/g, "\\r").replace(/[\t]/g, "\\t") }; function jsonEscape(a) { return a.replace(/[\\]/g, "\\\\").replace(/[\"]/g, "__Q").replace(/[\']/g, "@@AP").replace(/[\b]/g, "\\b").replace(/[\f]/g, "\\f").replace(/[\n]/g, "\\n").replace(/[\r]/g, "\\r").replace(/[\t]/g, "\\t") }
$kyu.unescapeJsonChars = function (a) { return null == a ? null : a.replace(/\\\\/g, "\\").replace(/__Q/g, '"').replace(/__q/g, "'").replace(/\\b/g, "\b").replace(/\\f/g, "\f").replace(/\\n/g, "\n").replace(/\\r/g, "\r").replace(/\\t/g, "\t").replace(/@@AP/g, "'") }; $kyu.lng = function (a) { var b = null; $.each($kyu.langauge, function (d, e) { if (e.key == a) return b = e.txt, !1 }); return b ? b : a }; function lng(a) { return $kyu.lng(a) }
$kyu.ShowCenterFixed = function (a, b, d) { a = document.getElementById(a); a.style.display = ""; var e = a.offsetWidth, f = a.offsetHeight, g = new Number($(window).width()), i = new Number($(window).height()); a.style.position = IS_MOBILE ? "absolute" : "fixed"; a.style.left = (b ? b : g / 2 - e / 2) + "px"; a.style.top = (d ? d : i / 2 - f / 2) + "px"; $(a).css("margin", "0px") }; $kyu.openNewTab = function (a) { window.open(a, "_blank").focus() }; function openNewTab(a) { window.open(a, "_blank").focus() }
$kyu.forceJSNum = function (a) { var a = new String(a), b = a.indexOf(","), d = a.indexOf("."), e = a; -1 < b && -1 < d && d < b ? (e = a.replace(/\./g, ""), e = e.replace(/,/g, ".")) : -1 == b && -1 < d ? e = a : -1 < b && -1 == d && (e = a.replace(/,/g, ".")); return new Number(e) }; function isChrome() { return $.browser.chrome } function isNamedSet(a) { return 2 == a.split("[").length ? !0 : !1 } var chartStages = [];
$kyu.initChart = function (a, b, d) {
    b || (b = 3); $("#" + a).hasClass("tileHeader") && (b = 9); var e = $("#" + a).data("surfacewidth") ? $("#" + a).data("surfacewidth") : $("#" + a).width(), f; $kyu.freePositioning && "renderSurfaceTestChart" != a && "renderSurfaceLarge" != a && "renderSurfaceTestKPIGauge" != a && "renderSurfaceQuickExplore" != a ? (f = $("#" + a).parent().height() - 5, e = $("#" + a).parent().width(), 50 > f && (f = 50), 1 < $kyu.mplier && (f = $("#" + a).closest(".tile"), e = "Scorecard" == f.data("presentationtype") ? 2 * $("#" + a).closest(".tile").data("opt_width") :
        f.data("opt_width") * $kyu.mplier, f = (f.data("opt_height") - 5) * $kyu.mplier)) : "renderSurfaceHome1" == a || "renderSurfaceHome2" == a ? (f = $("#" + a).height(), e = $("#" + a).width()) : 9 == b ? (e = 250, f = 150) : 3 == b ? (f = 260 > $("#" + a).height() ? 265 : $("#" + a).height(), 1 < $kyu.mplier ? (e = 1146, f = 795) : "Scorecard" != $("#" + a).data("presentationtype") && ("List" != $("#" + a).data("presentationtype") && "Table" != $("#" + a).data("presentationtype")) && "Dashboard" == globalMode && (f = 800 < e ? 694 : 700 < e ? 482 : 600 < e ? 460 : 500 < e ? 375 : 265, largeTileMode && ("undefined" ==
            typeof delay && "renderSurfaceQuickExplore" != a) && (f = $("#" + a).height()))) : 2 == b ? (f = 265 > $("#" + a).height() ? 159 : $("#" + a).height() - 100, 200 > f && "undefined" != typeof initSlideShow && (f = 600), 1 < $kyu.mplier && (e = 1146, f = 471)) : 1 == b && (f = 50 > $("#" + a).height() ? 50 : 200, 200 > f && "undefined" != typeof initSlideShow && (f = 200), 1 < $kyu.mplier && (e = 1146, f = 150)); "renderSurfaceTestChart" == a && (f = 215); var g = new Kinetic.Stage({ container: a, width: e, height: f }); addStageEvents(g); e = new Kinetic.Layer; g.add(e); g.divID = a; g.trimValues = !1; g.largeView =
                "renderSurfaceLarge" == a || -1 < a.indexOf("renderSurfaceSlide") ? !0 : !1; g.lwx = $kyu.mplier; g.largeView && (g.lwx = 1.5); g.fontSize = g.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize; 9 == b && (g.isHeader = !0); a = $("#" + g.divID).closest(".tile"); a.data("opt_legend") && (g.legend = a.data("opt_legend")); $kyu.initColorPallete(a, g); $kyu.setSpecificCategoriesSeries(a, d); g.data = d; g.tileID = a.attr("id"); d && d.SegmentSelectionMode && a.data("opt_displayvalues", "Top10Short"); g.isDrilled = a.data("additionalcategory") ? !0 :
                    !1; "1" == a.data("opt_pivottile") && $kyu.pivotData(d); a.data("opt_displayvalues") && "None" != a.data("opt_displayvalues") && (g.displayValues = a.data("opt_displayvalues")); a.data("opt_displayvaluesfilternames") && (g.displayValuesFilterNames = a.data("opt_displayvaluesfilternames")); a.data("opt_averageline") && (g.averageLineSeries = a.data("opt_averageline")); a.data("opt_trendline") && (g.trendSeries = a.data("opt_trendline")); a.data("opt_colormeter") && (g.colorMeter = a.data("opt_colormeter")); a.data("opt_gaugelastchange") &&
                        (g.gaugeLastChange = a.data("opt_gaugelastchange")); a.data("opt_gaugekpi") && (g.gaugeKPI = a.data("opt_gaugekpi")); a.data("opt_gaugepointer") && (g.gaugePointer = a.data("opt_gaugepointer")); a.data("opt_animlast") && (g.animateLastPoint = a.data("opt_animlast")); a.data("opt_linewidth") && "None" != a.data("opt_linewidth") && (g.lineWidth = a.data("opt_linewidth")); a.data("useasslicer") && (g.data.SegmentSelectionMode = 1); a.data("opt_axistitles") && 1 == a.data("opt_axistitles") && (g.AxisTitles = 1); null != a.data("sortcolumn") &&
                            $kyu.sortColumns(g.data, a.data("sortcolumn"), a.data("sortorder")); a.data("top") && $kyu.takeTop(g, a.data("top")); a.data("opt_peekcat") && (g.peekCategory = a.data("opt_peekcat"), g.peekCategoryTitle = a.data("opt_peekcattitle")); a.data("opt_hidefill") && (g.hideFill = !0); a.data("customurl") && (g.customURL = a.data("customurl")); a.data("opt_colorpalletecompare") && (g.colorPalleteCompare = a.data("opt_colorpalletecompare")); $kyu.setSingleColorDetails(a, g); if (!MOBILE_APP) g.on("click", function (a) {
                                0 == a.button ? HideMenu() :
                                    $kyu.showWidgetMenu(a, g)
                            }); chartStages.push(g); return g
};
$kyu.setSingleColorDetails = function (a, b) {
    if (0 == (new String(a.data("opt_colorpallete"))).indexOf("$")) {
        b.singleColor = a.data("opt_colorpallete").replace("$", ""); b.fontColor = "White"; b.colorPallete = -1; b.singleColorPallete = []; var d = new Color("#ffffff"), e = new Color(b.singleColor); if (b.data) {
            var f = "Pie_Chart" == a.data("presentationtype") || "Doughnut_Chart" == a.data("presentationtype") || "Bubble_Chart" == a.data("presentationtype") || "Sunburst" == a.data("presentationtype") ? Array.isArray(b.data) ? b.data[0].points.length :
                b.data.points.length : Array.isArray(b.data) ? b.data[0].series.length : b.data.series.length; if (5 > f) for (var g = 2; 10 > g; g++) { var i = LinearColorInterpolator.findColorBetween(d, e, 10 * g - 10).asRgbCss(); b.singleColorPallete.push(i); g++ } else for (var h = 80 / f, g = 0; g < f; g++)i = LinearColorInterpolator.findColorBetween(d, e, 10 + g * h).asRgbCss(), b.singleColorPallete.push(i)
        } else i = LinearColorInterpolator.findColorBetween(d, e, 20).asRgbCss(), b.singleColorPallete.push(i), i = LinearColorInterpolator.findColorBetween(d, e, 40).asRgbCss(),
            b.singleColorPallete.push(i), i = LinearColorInterpolator.findColorBetween(d, e, 60).asRgbCss(), b.singleColorPallete.push(i); b.children && $kyu.drawRect(b.children[0], 0, 0, b.getWidth(), b.getHeight(), b.singleColor, b.singleColor, 1)
    } else b.fontColor = $kyu.dashboardFontColor, b.singleColor = null
};
$kyu.setSpecificCategoriesSeries = function (a, b) {
    if (!Array.isArray(b) && !a.data("additionalcategory")) {
        if (a.data("opt_specificcategories") && "" != a.data("opt_specificcategories")) for (var d = new String(a.data("opt_specificcategories")), d = unescapeJsonChars(d).split(";"), e = 0; e < b.points.length; e++)-1 == $.inArray(b.points[e].pointName, d) && (b.points.splice(e, 1), e--); if (a.data("opt_specificseries")) {
            d = (new String(a.data("opt_specificseries"))).split(";"); for (e = 0; e < b.series.length; e++)-1 == $.inArray(b.series[e].seriaTitle,
                d) && (b.series.splice(e, 1), $.each(b.points, function (a, b) { b.pointVal.splice(e, 1); b.pTxt.splice(e, 1) }), e--); if (b.OLAP && b.OLAP.HasOnlyMeasures) { b.measureNames = ""; for (e = 0; e < b.series.length; e++)b.measureNames += b.series[e].seriaTitle + ";"; b.measureNames = b.measureNames.substring(0, b.measureNames.length - 1) }
        }
    }
};
$kyu.initColorPallete = function (a, b) { b.colorPallete = a.data("opt_colorpallete") ? -1 == a.data("opt_colorpallete") ? $("#KyubitDashboardTable").data("colorpallete") ? new Number($("#KyubitDashboardTable").data("colorpallete")) : 0 : new Number(a.data("opt_colorpallete")) : $("#KyubitDashboardTable").data("colorpallete") ? new Number($("#KyubitDashboardTable").data("colorpallete")) : 0 };
$kyu.getChartStage = function (a) { for (var b = 0; b < chartStages.length; b++)if (chartStages[b].divID == a) return chartStages[b]; if ("undefined" != typeof _geoMapStages) for (b = 0; b < _geoMapStages.length; b++)if (_geoMapStages[b].divID == a) return _geoMapStages[b]; if ("undefined" != typeof _treeMapStages) for (b = 0; b < _treeMapStages.length; b++)if (_treeMapStages[b].divID == a) return _treeMapStages[b] };
$kyu.removeOLDChartStage = function (a) { for (var b = 0; b < chartStages.length; b++)chartStages[b].divID == a && ("undefined" != typeof chartStages[b].remove && (chartStages[b].remove(), chartStages[b].destroy()), chartStages.splice(b, 1)) };
$kyu.findMinMaxStackValues = function (a) { for (var b = a.data, d = a.data.points, e = null, f = null, g = 0; g < d.length; g++) { for (var i = 0, h = 0, j = !1, l = !1, k = 0; k < b.series.length; k++)0 > d[g].pointVal[k] ? (l = !0, h += d[g].pointVal[k]) : (j = !0, i += d[g].pointVal[k]); j && i > f && (f = i); j && i < e && (e = i); l && h > f && (f = h); l && h < e && (e = h) } a.minValue = e; a.maxValue = f };
$kyu.findMinMax100Values = function (a) { for (var b = a.data, d = a.data.points, e = null, f = null, g = 0; g < d.length; g++) { for (var i = !1, h = !1, j = 0; j < b.series.length; j++)0 > d[g].pointVal[j] ? h = !0 : i = !0; i && !h && (f = 99.5, e = 0); i && h && (f = 99.5, e = -99.5); !i && h && (f = 0, e = -99.5) } a.minValue = e; a.maxValue = f };
$kyu.drawChartYText = function (a) {
    $kyu.drawText(a.children[0], $kyu.lineChartOffset, $kyu.lineChartOffset + $kyu.titleHeight - 5.5 * $kyu.mplier, $kyu.dashboardFont, $kyu.dashboardFontSize, $kyu.dashboardFontColor, $kyu.getShortValue(a.chartMaxValue) + "%"); 0 > a.chartMinValue && 0 < a.chartMaxValue ? $kyu.drawText(a.children[0], $kyu.lineChartOffset, a.attrs.height - $kyu.lineChartOffset - a.columnLabelHeight + a.pointVerticalDistance * a.chartMinValue - 5.5 * $kyu.mplier, $kyu.dashboardFont, a.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize,
        $kyu.dashboardFontColor, "0") : $kyu.drawText(a.children[0], $kyu.lineChartOffset, a.attrs.height - $kyu.lineChartOffset - a.columnLabelHeight - a.pointVerticalDistance * (a.chartHalfValue - a.chartMinValue) - 5.5 * $kyu.mplier, $kyu.dashboardFont, a.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize, $kyu.dashboardFontColor, $kyu.getShortValue(a.chartHalfValue) + "%")
};
$kyu.prepareAnyTileImageData = function (a, b, d, e) { "Geo_Map" == d ? $kyu.prepareGeoMapImageData(a, b, $kyu.prepareImageSetGUID, 0, 0, "", e) : "TreeMap" == d ? $kyu.prepareTreeMapImageData(a, b, $kyu.prepareImageSetGUID, 0, 0, "", e) : "Table" != d ? $kyu.prepareChartImageData(a, b, $kyu.prepareImageSetGUID, 0, 0, "", e) : $kyu.prepareChartImageData(a, b, $kyu.prepareImageSetGUID, 0, 0, "", e, !0) };
$kyu.prepareChartImageData = function (a, b, d, e, f, g, i, h) {
    var d = 0, j = null; if ($("#" + a).data("multivaluedrillthroughid")) { if (b = $("#" + b).find("Table")) j = $kyu.CreateDataValuesFromHTMLTable(b), d = 1, $kyu.sendImageData(a, $kyu.prepareImageSetGUID, e, f, g, null, null, j) } else {
        for (var l = 0; l < chartStages.length; l++)if (chartStages[l].divID == b) {
            var d = 1, k = chartStages[l], m; Array.isArray(k.data) ? m = $kyu.consolidateTreeData(k.data) : k.data2 ? (m = JSON.parse(JSON.stringify(k.data)), m = $kyu.consolidateComboData(m, k.data2)) : m = k.data; m.points &&
                (j = m.measureNames + "@@@" + m.categoryName + "@@@" + JSON.stringify(m.series) + "@@@" + JSON.stringify(m.points) + "@@@" + (Array.isArray(k.data) ? "1" : "0")); if (h) { i(null); return } chartStages[l].toDataURL({ callback: function (b) { i ? i(b) : $kyu.sendImageData(a, $kyu.prepareImageSetGUID, e, f, g, b, null, j) } }); break
        } 0 == d && -1 < $("#" + b).html().indexOf("NODATA") && (i ? i("NODATA") : $kyu.sendImageData($kyu.prepareImageSetGUID, e, f, g, "NODATA"), d = 1); return d
    }
};
$kyu.sendImageData = function (a, b, d, e, f, g, i, h, j) {
    $.ajax({
        type: "POST", crossDomain: !0, contentType: "application/json; charset=utf-8", url: $kyu.config.URL + "/WebServices/DashboardPDFService.asmx/SaveTileImageData", data: "{'imageDataSetGUID':'" + b + "','dashboardColumnIndex':" + d + ",'dashboardTileIndex':" + e + ",'tileTitle':" + checkNull(f) + ",'imageData':'" + g + "','tileSpecifics':" + checkNull(i) + ",'dataValues':" + checkNull(h) + "}", dataType: "json", success: function () {
            $("#" + a).data("imagesubmited", !0); verbose("SUBMITEDSUCCESS -> " +
                f); j && j()
        }
    })
}; $kyu.consolidateTreeData = function (a) { var b = JSON.parse(JSON.stringify(a[0])), d = []; $.each(b.points, function (b, f) { d.push(f); var g = $kyu.consolidateTreeDataFindChildren(f.unique, null, null, a, 1); g && $.each(g, function (a, b) { if ("SUM" == b.unique || "AVG" == b.unique || "(Sum)" == b.unique || "(Avg)" == b.unique || "TOTAL" == b.unique) return !1; b.pointName = "*" + b.pointName; d.push(b) }) }); b.points = d; return b };
$kyu.consolidateTreeDataFindChildren = function (a, b, d, e, f) {
    var g = null; $.each(e, function (e, f) { if (f.expand1 == a && f.expand2 == b && f.expand3 == d) return g = JSON.parse(JSON.stringify(f)), !1 }); var i = null; g && (i = [], $.each(g.points, function (g, j) {
        i.push(j); if (1 == f) b = j.unique; else if (2 == f) d = j.unique; else return !0; var l = $kyu.consolidateTreeDataFindChildren(a, b, d, e, f + 1); l && $.each(l, function (a, b) {
            if ("SUM" == b.unique || "AVG" == b.unique || "(Sum)" == b.unique || "(Avg)" == b.unique || "TOTAL" == b.unique) return !1; b.pointName = "*" + b.pointName;
            i.push(b)
        })
    })); return i
};
$kyu.consolidateComboData = function (a, b) {
    if (a.OLAP && a.OLAP.HasOnlyMeasures && !a.OLAP.ModelID) { var d = b.measureNames.split(";"); $.each(d, function (b, d) { a.measureNames += ";" + (new String(lng("__compare"))).toUpperCase() + " " + d }) } $.each(b.series, function (b, d) { a.series.push(JSON.parse(JSON.stringify(d))); a.series[a.series.length - 1].seriaTitle = (new String(lng("__compare"))).toUpperCase() + " " + d.seriaTitle }); $.each(b.points, function (b, d) { var g = a.points[b]; $.each(d.pTxt, function (a, b) { g.pTxt.push(b); g.pointVal.push(d.pointVal[a]) }) });
    return a
};
$kyu.drawLegend = function (a, b, d, e) {
    var f = 0, g = 0, i = 0, h = [], j, l = e && 1 == e.series.length && 1 == b.series.length ? !0 : !1; if ("Hide" == a.legend || b.SegmentSelectionMode) a.legendHeight = 5, a.legendWidth = 0; else {
        d ? l ? (h.push({ seriaTitle: a.primarySetName }), a.secondarySetName ? h.push({ seriaTitle: a.secondarySetName }) : h.push({ seriaTitle: a.primarySetName })) : (h = b.series, j = b.seriesName) : (h = b.points, j = b.categoryName); a.isDrilled && !b.OLAP.ModelID && (h = b.OLAP.HasOnlyMeasures ? b.measureNames.split(";") : b.measureNames.split(";").splice(0, 1));
        var k = 0; a.largeView && (k = 2); var m = 0; MOBILE_APP && (m = 1); if ((!a.legend || "Top" == a.legend) && h) {
            a.AxisTitles && j && (j = $kyu.drawText(a.children[0], $kyu.lineChartOffset + f, $kyu.lineChartOffset + g - k, $kyu.dashboardFont, a.fontSize, a.fontColor, j, 100), f = j.getWidth() + 20 * $kyu.mplier); for (j = 0; j < h.length; j++) {
                var p = 1, n = $kyu.getStageSeriaColor(a, j); -1 < a.colorPallete && (b.SegmentSelectionMode || (n = $kyu.getMemberColor(h[j].seriaTitle ? h[j].seriaTitle : h[j].pointName, n)), null != e && (n = $kyu.getMemberColor(a.data.measureNames, n)));
                var s, r, t = 14.5, w = 0; isChrome() && (w = 1.3 * a.lwx); if (l) {
                    var t = 10, w = -1, q = 0, u = !1, y = 10, p = 1; if (0 == j && "Line_Chart" == a.primaryChart || 1 == j && "Line_Chart" == a.secondaryChart) w = 4, t = 2; 1 == j && (n = $kyu.getStageSeriaColor(a, 1), !a.singleColor && a.colorPalleteCompare && (n = $kyu.getSeriaColor(0, a.colorPalleteCompare), p = 1), "Line_Chart" == a.secondaryChart && (u = !0, q = 0, y = 3)); s = $kyu.drawRect(a.children[0], $kyu.lineChartOffset + f + q, $kyu.lineChartOffset + g + w, y * $kyu.mplier, t * $kyu.mplier, n, n, p); u && (q = 6, r = $kyu.drawRect(a.children[0], $kyu.lineChartOffset +
                        f + q, $kyu.lineChartOffset + g + w, y * $kyu.mplier, t * $kyu.mplier, n, n, p)); t = 15.5; w = -0
                } else s = $kyu.drawCircle(a.children[0], $kyu.lineChartOffset + f + 5 * $kyu.mplier, $kyu.lineChartOffset + g + 5.5 * $kyu.mplier + m, 5 * $kyu.mplier, n, p); n = a.isDrilled && !b.OLAP.ModelID ? h[j] : d ? h[j].seriaTitle : h[j].pointName; n = $kyu.drawText(a.children[0], $kyu.lineChartOffset + f + t * $kyu.mplier + k / 2, $kyu.lineChartOffset + g - k + w * $kyu.mplier, $kyu.dashboardFont, a.fontSize, a.fontColor, n, 100); if (f + n.getWidth() + 30 * $kyu.mplier >= a.attrs.width - 2 * $kyu.lineChartOffset) {
                    i++;
                    if (2 < i) { s.setOpacity(0); n.setOpacity(0); break } f = 0; l ? s.setX($kyu.lineChartOffset + f) : s.setX($kyu.lineChartOffset + f + 5 * $kyu.mplier); r && r.setX($kyu.lineChartOffset + f + 5 * $kyu.mplier); n.setX($kyu.lineChartOffset + f + t * $kyu.mplier + k / 2); g += 15 * $kyu.mplier + 2 * k; n.setY($kyu.lineChartOffset + g - k); l ? s.setY($kyu.lineChartOffset + g) : s.setY($kyu.lineChartOffset + g + 6 * $kyu.mplier)
                } f += n.getWidth() + 30 * $kyu.mplier + k / 2; if (f >= a.attrs.width - 2 * $kyu.lineChartOffset) { i++; if (2 < i) break; f = 0; g += 15 * $kyu.mplier } h[j].seriaUnique && (n.seriaUnique =
                    h[j].seriaUnique); n.seriaIndex = j; !e && !MOBILE_APP && (n.on("click", function () { $kyu.showLegendMenu(a, this) }), n.on("mouseover", function () { $("#" + a.divID).css("cursor", "pointer"); this.setFill($kyu.getStageSeriaColor(a, 0)); a.draw() }), n.on("mouseout", function () { $("#" + a.divID).css("cursor", "default"); a.singleColor ? this.setFill("white") : this.setFill("black"); a.draw() }))
            } a.legendHeight = 15 * $kyu.mplier + g + 2 * $kyu.lineChartOffset + 4 * k; a.legendWidth = 0
        } else {
            e = 0.35 * (a.attrs.width - 2 * $kyu.lineChartOffset); i = 0; f = a.attrs.width -
                $kyu.lineChartOffset - e; g = (a.attrs.height - 6 * $kyu.lineChartOffset - 1.5 * a.fontSize * h.length) / 2; g < $kyu.lineChartOffset && (g = $kyu.lineChartOffset); l = 17.5 * $kyu.mplier + k / 2; a.AxisTitles && b.seriesName && (j = $kyu.drawText(a.children[0], $kyu.lineChartOffset + f + l, g - k, $kyu.dashboardFont, a.fontSize, "Gray", b.seriesName, 100), g += 1.5 * a.fontSize); for (j = 0; j < h.length && !(n = $kyu.getSeriaColor(j, a.colorPallete), $kyu.drawCircle(a.children[0], $kyu.lineChartOffset + f + 10 * $kyu.mplier, g + 6.5 * $kyu.mplier, 5 * $kyu.mplier, n), n = a.isDrilled &&
                    !b.OLAP.ModelID ? h[j] : d ? h[j].seriaTitle : h[j].pointName, n = $kyu.drawText(a.children[0], $kyu.lineChartOffset + f + l, g - k, $kyu.dashboardFont, a.fontSize, $kyu.dashboardFontColor, n, 100), n.setWrap("char"), n.setHeight(a.fontSize), m = n.getWidth(), m > i && (i = m + l + $kyu.lineChartOffset), n.getX() + n.getWidth() > a.attrs.width && (n.setWidth(e - (l + $kyu.lineChartOffset + 12)), $kyu.drawText(a.children[0], n.getX() + n.getWidth() - 5, g - k, $kyu.dashboardFont, a.FontSize, $kyu.dashboardFontColor, "...", 100)), g += 1.5 * a.fontSize, g + 1.5 * a.fontSize >
                    a.attrs.height); j++); if (i < e) { var v = e - i; $.each(a.children[0].children, function (a, b) { b.setX(b.getX() + v) }); a.legendWidth = e - v } else a.legendWidth = e; a.legendHeight = 0
        } return a
    }
};
$kyu.calcPointHorizonal = function (a, b) {
    var d = !1; if ("Column_Chart" == a.presentationType || "Column_100" == a.presentationType || "Column_Stack" == a.presentationType || "HeatMap" == a.presentationType || "Combo" == a.presentationType && ("Column_Chart" == a.primaryChart || "Column_Chart" == a.secondaryChart)) d = !0; var e = a.attrs.width - 2 * $kyu.lineChartOffset - $kyu.horizValOffsetLeft - $kyu.horizValOffsetRight - a.legendWidth; "HeatMap" == a.presentationType && (e += $kyu.horizValOffsetRight); a.axisYLabelWidth && (e -= a.axisYLabelWidth); if ("Show" ==
        a.animateLastPoint && ("Line_Chart" == a.presentationType || "Spline_Chart" == a.presentationType)) e -= $kyu.animPointOffset * $kyu.mplier; "HeatMap" == a.presentationType && (g = 0, f = e / b.points.length); "Bubble_Chart" == a.presentationType && (e = e + $kyu.horizValOffsetRight + $kyu.horizValOffsetRight); var f, g; d && (g = e / b.points.length, f = 4 * g / 5, g /= 10); a.separateAxis && (e -= 20 * $kyu.mplier); a.valueAreaWidth = e; a.isColumnBased = d; a.pointHorizontalDistance = d ? e / b.points.length : e / (b.points.length - 1); a.pointHorizontalStart = $kyu.lineChartOffset +
            $kyu.horizValOffsetLeft; d && (a.pointHorizontalStart += g + f / 2); a.axisYLabelWidth && (a.pointHorizontalStart += a.axisYLabelWidth)
};
$kyu.calcPointVertical = function (a) { a.valueAreaHeight = a.attrs.height - 2 * $kyu.lineChartOffset - a.pointLabelHeight - a.legendHeight; a.comboDelta && 0 < a.comboDelta && (a.comboDeltaMax = 0.23 * a.valueAreaHeight / 2, a.comboDeltaY = a.comboDeltaMax + $kyu.lineChartOffset + a.legendHeight, a.valueAreaHeight *= 0.6); a.pointVerticalDistance = a.valueAreaHeight / Math.abs(a.chartMaxValue - a.chartMinValue); a.separateAxis && (a.pointVerticalDistance2 = a.valueAreaHeight / Math.abs(a.chartMaxValue2 - a.chartMinValue2)); return a };
$kyu.findMinMaxValue = function (a, b, d) {
    if (b.points) {
        for (var e, f, g = 0; g < b.series.length; g++) { for (var i = 0; i < b.points.length; i++)if (null != b.points[i].pointVal[g]) { f = b.points[i].pointVal[g]; break } if (f) break } e = a.minValue ? a.minValue : f; f = a.maxValue ? a.maxValue : f; var h = b.points.length; d && (h = d < b.points.length ? d : b.points.length); if (b.series) for (g = 0; g < b.series.length; g++)for (i = 0; i < h; i++)null != b.points[i].pointVal[g] && (b.points[i].pointVal[g] > f && (f = b.points[i].pointVal[g]), b.points[i].pointVal[g] < e && (e = b.points[i].pointVal[g]));
        else for (i = 0; i < h; i++)null != b.points[i].pointVal[0] && (b.points[i].pointVal[0] > f && (f = b.points[i].pointVal[0]), b.points[i].pointVal[0] < e && (e = b.points[i].pointVal[0])); a.minValue = e; a.maxValue = f; return a
    }
};
$kyu.findChartMinMaxValue = function (a, b) {
    var d = 0, e = 0, e = $("#" + a.divID).closest(".tile"); if (("Line_Chart" == e.data("presentationtype") || "Spline_Chart" == e.data("presentationtype") || "Column_Chart" == e.data("presentationtype")) && null != e.data("opt_ymin") && "" != e.data("opt_ymin") && null != e.data("opt_ymax") && "" != e.data("opt_ymax")) return -1 < (new String(e.data("opt_ymin"))).indexOf("%") ? (d = new Number(e.data("opt_ymin").replace("%", "")), d = a.minValue * d / 100) : d = forceJSNum(e.data("opt_ymin")), -1 < (new String(e.data("opt_ymax"))).indexOf("%") ?
        (e = new Number(e.data("opt_ymax").replace("%", "")), e = a.maxValue * e / 100) : e = forceJSNum(e.data("opt_ymax")), a.customYMinMax = !0, chartHalfValue = 1 < e - d ? Math.round(e - (e - d) / 2) : Math.round(100 * (e - (e - d) / 2)) / 100, b ? (a.chartMinValue2 = d, a.chartHalfValue2 = chartHalfValue, a.chartMaxValue2 = e) : (a.chartMinValue = d, a.chartHalfValue = chartHalfValue, a.chartMaxValue = e), a; var f; a.trimValues || 0 < a.maxValue && 0 > a.minValue ? (f = a.maxValue - a.minValue, e = Math.ceil(a.maxValue + 0 * f), d = Math.floor(a.minValue - 0 * f)) : 0 <= a.maxValue && 0 <= a.minValue ?
            (f = a.maxValue, e = Math.ceil(a.maxValue + 0 * f), d = 0) : (f = a.minValue, e = 0, d = Math.floor(a.minValue + 0 * f)); var g = (new String(Math.round(f))).length; 0 > f && g--; f = []; f.push("1"); for (var i = 0; i < g - 1; i++)f.push("0"); g = new Number(f.join("")); 0 <= a.maxValue && 0 <= a.minValue ? (f = Math.round(e / g) * g, e = f > a.maxValue ? f : f + 0.5 * g) : (f = Math.round(d / g) * g, d = f > a.maxValue ? f : f - 0.5 * g); if (a.trimValues || 0 < a.maxValue && 0 > a.minValue) f = Math.round(d / g) * g, d = f < a.minValue ? f : f - 0.5 * g; chartHalfValue = 1 < e - d ? Math.round(e - (e - d) / 2) : Math.round(100 * (e - (e - d) / 2)) /
                100; b ? (a.chartMinValue2 = d, a.chartHalfValue2 = chartHalfValue, a.chartMaxValue2 = e) : (a.chartMinValue = d, a.chartHalfValue = chartHalfValue, a.chartMaxValue = e); return a
};
$kyu.testHorizontalPoints = function (a) {
    var b = a.attrs.height; $kyu.drawLine(a.children[0], 0, 20, 0, b, "green", 1); $kyu.drawLine(a.children[0], $kyu.lineChartOffset, 20, $kyu.lineChartOffset, b, "yellow", 1); $kyu.drawLine(a.children[0], $kyu.horizValOffsetLeft, 20, $kyu.horizValOffsetLeft, b, "yellow", 1); $kyu.drawLine(a.children[0], a.pointHorizontalStart, 20, a.pointHorizontalStart, b, "red", 1); var d = a.pointHorizontalStart + a.pointHorizontalDistance; $.each(a.data.points, function () {
        $kyu.drawLine(a.children[0], d, 20, d, b, "red",
            1); d += a.pointHorizontalDistance
    })
};
$kyu.drawPointLabels = function (a, b) {
    var d = 0; a.largeView && (d = 2); if (a.customYMinMax || a.trendSeries) $kyu.drawRect(a.children[0], 0, a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight + 1, a.attrs.width - $kyu.lineChartOffset - a.legendWidth, a.pointLabelHeight + $kyu.lineChartOffset, "white", "white"), $kyu.drawText(a.children[0], $kyu.lineChartOffset, a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - 5.5 * $kyu.mplier - d, $kyu.dashboardFont, a.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize, $kyu.dashboardFontColor,
        $kyu.getShortValue(a.chartMinValue), 100); var e, d = 0; a.AxisTitles && b.categoryName && (d = $kyu.drawText(a.children[0], $kyu.lineChartOffset + $kyu.horizValOffsetLeft + (a.attrs.width - 4 * $kyu.lineChartOffset - $kyu.horizValOffsetLeft - $kyu.horizValOffsetRight - a.legendWidth) / 2, a.attrs.height - $kyu.lineChartOffset - (a.largeView ? 12 : 7 * $kyu.mplier), $kyu.dashboardFont, a.fontSize, a.fontColor, b.categoryName, 100), $kyu.centerText(d), d = 1.5 * a.fontSize); if (5 < b.points.length) {
            var f = 0.35 * a.attrs.height - d, g = a.largeView ? $kyu.dashboardLargeFontSize :
                $kyu.dashboardFontSize; e = a.valueAreaWidth / g; e = b.points.length / e; for (var i = a.pointHorizontalStart, i = i - g / 2, h = a.attrs.height - $kyu.lineChartOffset - 0.5 - d + 3, j = 0, l = e, k = 0, m = 0; m < b.points.length; m++) {
                    if (l >= e) {
                        var l = b.points[m].pointName, l = $kyu.drawText(a.children[0], i + m * a.pointHorizontalDistance, h, $kyu.dashboardFont, g, a.fontColor, l, 100), p = l.getWidth(); if (p > f) {
                            l.setHeight(1 * g); l.setWrap("char"); l.setWidth(f); var n = $kyu.drawText(a.children[0], i + m * a.pointHorizontalDistance, h - f + 1, $kyu.dashboardFont, g, a.fontColor,
                                "...", 100); n.rotateDeg(-90); k || (k = n.getWidth())
                        } l.rotateDeg(-90); p > j && (j = p); l = 0
                    } l++
                } a.pointLabelHeight = j > f ? f : j; a.pointLabelHeight += k; a.pointLabelHeight += 5
        } else {
        a.pointLabelHeight = a.largeView ? 40 : 30 * $kyu.mplier; f = 2 < b.points.length ? !0 : !1; g = !0; i = a.pointHorizontalStart; h = a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - 0.5; i += $kyu.lineChartOffset; e = a.attrs.width > 550 * $kyu.mplier ? 7 < b.points.length ? 7 : b.points.length : a.attrs.width > 450 * $kyu.mplier ? 6 < b.points.length ? 6 : b.points.length : a.attrs.width > 350 *
            $kyu.mplier ? 5 < b.points.length ? 5 : b.points.length : 3 < b.points.length ? 3 : b.points.length; j = 0; k = b.points.length / (e - 1); 1 == b.points.length && (k = 0, i = a.valueAreaWidth / 2); for (m = 0; m < b.points.length && j != e; m++)m >= j * k - 1 && (l = 21 > b.points[m].pointName.length ? b.points[m].pointName : b.points[m].pointName.substring(0, 20) + ".", l = $kyu.drawText(a.children[0], i, g ? h + 20.5 * $kyu.mplier - d : h + 5.5 * $kyu.mplier - d, $kyu.dashboardFont, a.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize, a.fontColor, l, 100), p = l.getWidth(), 1 == b.points.length ?
                l.setX(a.attrs.width / 2 - p / 2) : 0 == j && "HeatMap" != a.presentationType ? i - p / 2 < $kyu.lineChartOffset ? l.setX($kyu.lineChartOffset) : l.setX(i - p / 2) : j == e - 1 && "HeatMap" != a.presentationType ? i + p / 2 > a.attrs.width - $kyu.lineChartOffset ? l.setX(a.attrs.width - $kyu.lineChartOffset - p) : l.setX(i - p / 2) : l.setX(i - p / 2), j++, f && (g = !g)), i += a.pointHorizontalDistance
    } a.pointLabelHeight += d
};
$kyu.displayValuesStandard = function (a, b, d, e, f, g) {
    var f = f ? f : [], i = $("#" + a.divID).closest(".tile"), h = i.data("opt_displayvalues"); if (!h || "None" == h) return f; var j = null; i.data("opt_displayvaluesfilternames") && (j = (new String(i.data("opt_displayvaluesfilternames"))).split(";")); var l = null; i.data("opt_displayvaluesfilterseries") && (l = (new String(i.data("opt_displayvaluesfilterseries"))).split(";")); var k = a.data, m = 0 == h.indexOf("Top") ? !0 : !1, p = 0 == h.indexOf("Last") ? !0 : !1, n = 0 < h.indexOf("Short") ? !0 : !1, s = a.pointVerticalDistance;
    g && a.separateAxis && (s = a.pointVerticalDistance2); var r = 0, t = 0, w = 0, r = a.valueAreaWidth; a.separateAxis && (r -= 20 * $kyu.mplier); i = i.data("presentationtype"); if ("Column_Chart" == i || "Combo" == i && ("Column_Chart" == a.primaryChart || "Column_Chart" == a.secondaryChart)) t = r / k.points.length, t = 4 * t / 5, w = t / k.series.length; else if ("Column_Stack" == i || "Column_100" == i) t = r / k.points.length, w = t = 4 * t / 5; r = a.chartMinValue; a.separateAxis && (r = a.chartMinValue2); var q = a.pointHorizontalStart, r = a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight +
        r * s - 0.5, q = []; if (m) for (var u = 0; u < k.points.length; u++) { for (var y = 0, v = 0; v < k.series.length; v++)if (m && !y || k.points[u].pointVal[v] > y) y = k.points[u].pointVal[v]; m && q.push([k.points[u].pointName, new Number(y)]) } p && (E = [], E.push([k.points[k.points.length - 1].pointName, k.points[k.points.length - 1].pointVal])); if (m) { var E = q.sort(function (a, b) { return a[1] - b[1] }); new Number(h.replace("Top", "").replace("Short", "")) < E.length && (E = E.slice(E.length - new Number(h.replace("Top", "").replace("Short", "")), E.length)) } y = w; if (d ||
            e) y = 0.75 * w; q = a.pointHorizontalStart; d && (q += 0.25 * t); for (u = 0; u < a.data.points.length; u++) {
                d = null; if (m || p) for (v = 0; v < E.length; v++) { if (E[v][0] == k.points[u].pointName) { d = k.points[u]; break } } else d = k.points[u]; if (d) {
                    var H = 0, I = 0; if ("100" == b) for (v = 0; v < k.series.length; v++)I += Math.abs(k.points[u].pointVal[v]); for (v = 0; v < k.series.length; v++) {
                        var A = !0; j && -1 == $.inArray(k.points[u].pointName, j) && (A = !1); A && (l && -1 == $.inArray(k.series[v].seriaTitle, l)) && (A = !1); var G; G = "100" == b ? 100 * s * (k.points[u].pointVal[v] / I) : s * d.pointVal[v];
                        if (A && d.pTxt[v]) {
                            var A = a.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize, x = null, z = null, F = d.pTxt[v], B, C; b ? "Stack" == b ? (B = q, C = r - H - G / 2 - A / 2 + 1.5) : "100" == b && (B = q, C = r - H - G / 2 - A / 2 + 1.5) : (B = q - t / 2 + v * y + y / 2 + 2 * $kyu.mplier, C = r - G - 1.5 * A + 1.5); n && (F = $kyu.getShortValue(d.pointVal[v])); var D = !1; if ((D = $kyu.checkIsOveralapping(B, C, f)) && "All" != h) { var J = $kyu.findAlternativePosition(B, C, f); 0 != J && (D = !1, C = J) } if (!D) {
                                D = $kyu.getStageSeriaColor(a, v); if ((e || g) && !a.singleColor && a.colorPalleteCompare) D = $kyu.getSeriaColor(v,
                                    a.colorPalleteCompare); if (b) if ("Stack" == b) { if (a.singleColor || (x = $kyu.drawText(a.children[0], B, C, $kyu.dashboardFont, A, "white", F, 100)), "Column_Stack" == i && (!x || x.getWidth() > w) || "Area_Stack" == i && v == k.series.length - 1) a.singleColor && (D = a.singleColor), z = $kyu.drawText(a.children[0], B - 1, C - 1, $kyu.dashboardFont, A, D, F, 100) } else {
                                        if ("100" == b && (a.singleColor || (x = $kyu.drawText(a.children[0], B, C, $kyu.dashboardFont, A, "white", F, 100)), a.singleColor || (!x || x.getWidth() > w) && "Area_Stack" != i && "Area_100" != i)) a.singleColor &&
                                            (D = a.singleColor), z = $kyu.drawText(a.children[0], B - 1, C - 1, $kyu.dashboardFont, A, D, F, 100)
                                    } else a.singleColor || (x = $kyu.drawText(a.children[0], B, C, $kyu.dashboardFont, A, "white", F, 100)), z = $kyu.drawText(a.children[0], B - 1, C - 1, $kyu.dashboardFont, A, D, F, 100); if ("Column_Chart" == i || "Column_Stack" == i || "Column_100" == i || "Combo" == i && ("Column_Chart" == a.primaryChart || "Column_Chart" == a.secondaryChart)) z && $kyu.centerText(z), x && $kyu.centerText(x); else if ("Spline_Chart" == i || "Line_Chart" == i || "Area_Chart" == i || "Bubble_Chart" ==
                                        i || "Area_Stack" == i || "Area_100" == i || "Combo" == i) u == k.points.length - 1 ? (z && $kyu.alignRight(z, 0), x && $kyu.alignRight(x, 0)) : 0 < u ? (z && $kyu.centerText(z), x && $kyu.centerText(x)) : z && (B += z.getWidth() / 2); x && (0 == u && f.push({ x: x.getWidth() / 2, y: C, width: x.getWidth(), height: x.getHeight() }), f.push({ x: B, y: C, width: x.getWidth(), height: x.getHeight() })); z && (0 > z.getY() && z.setY(0), z.setListening(!1)); x && 0 > x.getY() && x.setY(0); x && x.setListening(!1)
                            }
                        } H += G
                    }
                } q += a.pointHorizontalDistance
            } return f
};
$kyu.findAlternativePosition = function (a, b, d) { var e = b - $kyu.dashboardFontSize - 2; if (!$kyu.checkIsOveralapping(a, e, d)) return e; b = b + $kyu.dashboardFontSize + 2; return !$kyu.checkIsOveralapping(a, b, d) ? b : 0 };
$kyu.checkIsOveralapping = function (a, b, d, e, f) { var g = !1; e || (e = $kyu.dashboardFontSize); $.each(d, function (d, h) { if (f) { if (a + 1 >= h.x && a - 1 <= h.x + h.width || a + 1 + f >= h.x && a - 1 + f <= h.x + h.width || h.x + 1 >= a && h.x - 1 <= a + f || h.x + h.width + 1 >= a && h.x + h.width - 1 <= a + f) if (b + 1 >= h.y && b - 1 <= h.y + h.height || b + 1 + e >= h.y && b - 1 + e <= h.y + h.height || h.y + 1 >= b && h.y - 1 <= b + e || h.y + h.height + 1 >= b && h.y + h.height - 1 <= b + e) g = !0 } else if (a + 1 >= h.x && a - 1 <= h.x + h.width && (b + 1 >= h.y && b - 1 <= h.y + h.height || b + 1 + e >= h.y && b - 1 + e <= h.y + h.height)) g = !0 }); return g };
$kyu.displayValuesPie = function (a, b, d) {
    for (var e = 0, f = a.data, g = 0; g < a.data.points.length; g++)e += a.data.points[g].pointVal[0]; var e = 360 / e, i = -90, h = [], g = [], j = [], l = [], k = 0 < b.indexOf("Short") ? !0 : !1; d && (j = d.split(";")); if (0 == b.indexOf("Top")) {
        for (g = 0; g < a.data.points.length; g++)h.push([f.points[g].pointName, a.data.points[g].pointVal[0]]); g = h.sort(function (a, b) { return a[1] - b[1] }); new Number(b.replace("Top", "").replace("Short", "")) < g.length && (g = g.slice(g.length - new Number(b.replace("Top", "").replace("Short", "")),
            g.length))
    } for (b = 0; b < a.data.points.length; b++) {
        var d = f.points[b], m = d.pointVal[0] * e, h = $kyu.getStageSeriaColor(a, b), i = i + m; if (!(1 > m)) {
            if (0 < g.length) { for (var p = !1, n = 0; n < g.length; n++)if (g[n][0] == d.pointName) { p = !0; break } if (!p) continue } if (!(0 < j.length && -1 == $.inArray(d.pointName, j))) {
                var p = (i - m / 2) * Math.PI / 180, m = 1.05 * Math.cos(p) * a.pieRadius, m = m + a.pieCenterLeft, p = 1.05 * Math.sin(p) * a.pieRadius, p = p + a.pieCenterTop, s = 0.05 * a.pieRadius, r = 0.15 * a.pieRadius, t, w = d.pTxt[0]; k && (w = $kyu.getShortValue(d.pointVal[0])); t = p <
                    a.pieCenterTop ? p - s : p + s; var p = $kyu.drawLine(a.children[0], m, p, m, t, h, 1), q = a.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize, u; m > a.pieCenterLeft ? (n = $kyu.drawLine(a.children[0], m, t, m + r, t, h, 1), u = $kyu.drawText(a.children[0], m + r + s + 1, t - q / 2 + 1, $kyu.dashboardFont, q, "white", d.pointName + "\r\n" + w, 100), d = $kyu.drawText(a.children[0], m + r + s, t - q / 2, $kyu.dashboardFont, q, h, d.pointName + "\r\n" + w, 100)) : (n = $kyu.drawLine(a.children[0], m, t, m - r, t, h, 1), u = $kyu.drawText(a.children[0], m - r - s + 1, t - q / 2 + 1, $kyu.dashboardFont,
                        q, "white", d.pointName + "\r\n" + w, 100), d = $kyu.drawText(a.children[0], m - r - s, t - q / 2, $kyu.dashboardFont, q, h, d.pointName + "\r\n" + w, 100), $kyu.alignRight(d, 0), $kyu.alignRight(u, 0)); h = !1; d.getX() + d.getWidth() > a.attrs.width - a.legendWidth && (d.setX(a.attrs.width - a.legendWidth - d.getWidth()), u.setX(a.attrs.width - u.getWidth() - a.legendWidth + 1), h = !0); 0 > d.getX() && (d.setX(0), u.setX(1), h = !0); h && (d.setY(d.getY() + q), u.setY(u.getY() + q)); d.getY() + d.getHeight() > a.attrs.height && (u.setY(a.attrs.height - u.getHeight()), d.setY(a.attrs.height -
                            d.getHeight())); 0 > d.getY() && (d.setY(0), u.setY(1)); $kyu.checkIsOveralapping(d.getX(), d.getY(), l, 2 * q, d.getWidth()) ? (p.hide(), n.hide(), d.hide(), u.hide()) : l.push({ x: d.getX(), y: d.getY(), width: d.getWidth(), height: d.getHeight() }); a.singleColor && d.hide()
            }
        }
    }
};
$kyu.drawAverageLines = function (a) {
    if (a.averageLineSeries) {
        var b = (new String(a.averageLineSeries)).split(";"); $.each(b, function (b, e) {
            var f = -1; $.each(a.data.series, function (a, b) { if (b.seriaTitle == e) return f = a, !1 }); if (-1 < f) {
                var g = 0; $.each(a.data.points, function (a, b) { if (b.pointVal[f] || 0 == b.pointVal[f]) g += b.pointVal[f] }); var i = a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - (g / a.data.points.length - a.chartMinValue) * a.pointVerticalDistance + 0.5, h = []; h.push($kyu.lineChartOffset + $kyu.horizValOffsetLeft +
                    0.5); h.push(i + 0.5); h.push(a.attrs.width - $kyu.lineChartOffset); h.push(i + 0.5); var j = $kyu.getSeriaColor(f, a.colorPallete); $kyu.drawText(a.children[0], $kyu.lineChartOffset + $kyu.horizValOffsetLeft, i - a.fontSize + 2, $kyu.dashboardFont, a.fontSize - 3, j, "Avg"); $kyu.drawDashedLines(a.children[0], h, j, 2, 1, [2, 2])
            }
        })
    }
};
$kyu.drawTrendLines = function (a) {
    var b = (a.attrs.width - a.legendWidth - 20 * $kyu.mplier - 2 * $kyu.lineChartOffset - ($kyu.horizValOffsetLeft + $kyu.horizValOffsetRight)) / (a.data.points.length - 1); if (a.trendSeries) {
        var d = (new String(a.trendSeries)).split(";"); $.each(d, function (d, f) {
            var g = -1; $.each(a.data.series, function (a, b) { if (b.seriaTitle == f) return g = a, !1 }); if (-1 < g) {
                var i = 0, h = 0, j = 0, l = 0, k = 0, m = 0, p = 0; $.each(a.data.points, function (a, b) {
                    if (b.pointVal[g] || 0 == b.pointVal[g]) i++, h += (a + 1) * b.pointVal[g], j += a + 1, l += b.pointVal[g],
                        m += Math.pow(a + 1, 2), p += a + 1
                }); for (var h = i * h, k = j * l, m = i * m, n = p, p = Math.pow(p, 2), k = (h - k) / (m - p), s = (l - k * n) / i, n = [], r = 0, t = 0; 2 > r;) { t++; if (5 < t) break; 1 == r && (r = a.valueAreaWidth / b); var w = a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - (k * (r + 1) + s - a.chartMinValue) * a.pointVerticalDistance + 0.5; n.push(r * b + $kyu.lineChartOffset + $kyu.horizValOffsetLeft + 0.5); n.push(w + 0.5); r++ } k = $kyu.getSeriaColor(g, a.colorPallete); w = $kyu.drawText(a.children[0], $kyu.lineChartOffset, w - a.fontSize + 2.5, $kyu.dashboardFont, a.fontSize - 3, k,
                    "Trend"); $kyu.alignRight(w, a.attrs.width - $kyu.lineChartOffset); $kyu.drawDashedLines(a.children[0], n, k, 2)
            }
        })
    }
}; $kyu.twoAxisChartBeforeDraw = function (a) { if ((a.customYMinMax || a.trendSeries) && "Right" != a.legend) $kyu.drawRect(a.children[0], 0, 0, a.attrs.width, a.legendHeight - 10 * a.lwx, "white", "white"), $kyu.drawLegend(a, a.data, !0), $kyu.drawPointLabels(a, a.data) };
$kyu.pivotData = function (a) {
    var b = [], d = []; $.each(a.points, function (d, e) { b.push({ seriaTitle: e.pointName, seriaUnique: e.unique, seriaMeasureUnits: null }); 0 == d && (b[0].seriaMeasureUnits = a.series[0].seriaMeasureUnits) }); $.each(a.series, function (b, e) { var f = [], j = []; $.each(a.points, function (a, d) { f.push(d.pointVal[b]); j.push(d.pTxt[b]) }); d.push({ pointName: e.seriaTitle, unique: e.seriaUnique, pointVal: f, pTxt: j }) }); var e = a.seriesName, f = a.categoryName; a.series = b; a.points = d; a.seriesName = f; a.categoryName = e; a.isPivot =
        !0; return a
};
$kyu.setColumnSorting = function (a, b, d, e, f) {
    e || (e = $("#" + a).closest(".tile"), d ? (e.data("sortcolumn", b), e.data("sortorder", d)) : null == e.data("sortcolumn") ? (e.data("sortcolumn", b), e.data("sortorder", "DESC"), d = "DESC") : e.data("sortcolumn") == b ? (e.data("sortcolumn", b), "ASC" == e.data("sortorder") ? (e.data("sortorder", "DESC"), d = "DESC") : (e.data("sortorder", "ASC"), d = "ASC")) : (e.data("sortcolumn", b), e.data("sortorder", "DESC")), f ? (f = this.getChartStage(a), e = $("#" + a).closest(".tile"), $kyu.sortColumnsDataSet(f, b, d), "Table" ==
        e.data("presentationtype") && ($kyu.renderTableHTML(f, e), $("#" + a).prepend("<div class='analyticBar showHide' style='margin-top:5px;height:20px'></div>"), $kyu.renderAnalyticBar(f))) : $kyu.renderTile(e))
};
$kyu.setSeriesSorting = function (a, b, d, e) { e || (a = $("#" + a).closest(".tile"), null == a.data("sortseries") ? (a.data("sortseries", b), a.data("sortseriesorder", "DESC")) : d ? (a.data("sortseries", b), a.data("sortseriesorder", d)) : a.data("sortseries") == b ? (a.data("sortseries", b), "ASC" == a.data("sortseriesorder") ? a.data("sortseriesorder", "DESC") : a.data("sortseriesorder", "ASC")) : (a.data("sortseries", b), a.data("sortseriesorder", "DESC")), $kyu.renderTile(a)) };
$kyu.sortColumnsDataSet = function (a, b, d) { $.each(a.data, function (a, f) { $kyu.sortColumns(f, b, d) }) };
$kyu.sortColumns = function (a, b, d) { var e = a.points[a.points.length - 1]; ("SUM" == e.unique || "AVG" == e.unique || "(Sum)" == e.unique || "(Avg)" == e.unique) && a.points.splice(a.points.length - 1, 1); var f = -1 < b ? a.points.sort(function (a, d) { return a.pointVal[b] < d.pointVal[b] ? -1 : a.pointVal[b] > d.pointVal[b] ? 1 : 0 }) : a.points.sort(function (a, b) { return a.pointName < b.pointName ? -1 : a.pointName > b.pointName ? 1 : 0 }); "DESC" == d && f.reverse(); a.points = f; ("SUM" == e.unique || "AVG" == e.unique || "(Sum)" == e.unique || "(Avg)" == e.unique) && a.points.push(e) };
$kyu.sortSeries = function (a, b, d) {
    for (var e = [], f = 0; f < a.data.points.length; f++)e.push([a.data.points[f].pointVal[g], a.data.points[f]]); for (var e = [], b = a.data.points[b], e = [], g = 0; g < b.pointVal.length; g++)e.push({ val: b.pointVal[g], oldOrder: g }); e = e.sort(function (a, b) { return a.val - b.val }); e.reverse(); "DESC" == d && e.reverse(); d = []; for (g = 0; g < e.length; g++)d.push(a.data.series[e[g].oldOrder]); b = []; for (f = 0; f < a.data.points.length; f++) {
        for (var i = a.data.points[f], h = [], j = [], g = 0; g < e.length; g++)h.push(i.pointVal[e[g].oldOrder]),
            j.push(i.pTxt[e[g].oldOrder]); i.pointVal = h; i.pTxt = j; b.push(i)
    } a.data.series = d; a.data.points = b
}; $kyu.setTop = function (a, b, d) { a = $("#" + a).closest(".tile"); a.data("sortcolumn", b); a.data("sortorder", "DESC"); a.data("top", d); $kyu.renderTile(a) }; $kyu.takeTop = function (a, b) { for (var d = [], e = 0; e < b && !(a.data.points.length <= e); e++)d.push(a.data.points[e]); a.data.points = d };
$kyu.CreateDataValuesFromHTMLTable = function (a) { var a = $(a).find("TR"), b = [], d = [], e; $.each(a, function (a, g) { var i = $(g).find("TD"), h, j = []; $.each(i, function (d, g) { 0 == a ? 0 == d ? e = $(g).text() : b.push({ seriaTitle: $(g).text() }) : 0 == d ? h = $(g).text() : j.push($(g).text()) }); 0 < a && d.push({ pointName: h, pTxt: j }) }); return "@@@" + e + "@@@" + JSON.stringify(b) + "@@@" + JSON.stringify(d) };
$kyu.addShapeEvents = function (a, b, d, e, f, g, i) {
    var h, j; h = d.groupNo ? b.Groups[d.groupNo].Points[e] : b.points[e]; j = b.series[f]; d.pointNo = e; d.seriaNo = f; d.seriaTitle = j.seriaTitle; d.seriaUnique = j.seriaUnique; d.displayVal = h.pTxt[f]; d.categoryUnique = h.unique; d.pointName = h.pointName; d.tileID = a.tileID; d.isSecondary = i ? !0 : !1; if (a.data.OLAP && (b.measureNames || b.OLAP.Measure) && !b.OLAP.HasOnlyMeasures) d.measureCaption = b.OLAP.ModelID ? b.OLAP.Measure : b.measureNames.split(";")[0]; a.lineWidth || a.lineStrokeThickness < 4 * $kyu.mplier &&
        "Rect" != d.className ? (d.setOpacity(0), a.initialyHadPoints = !1) : a.initialyHadPoints = !0; d.on("mouseover", function () { $kyu.showPoint(this, a, g); $("#" + a.divID).css("cursor", "pointer") }); d.on("mouseout", function () { $kyu.hidePoint(this, a); $("#" + a.divID).css("cursor", "default") }); d.on("click", function (e) {
            $kyu.designMode || (e.cancelBubble = !0, b.SegmentSelectionMode && 2 != e.button ? this.selected ? (this.selected = !1, a.draw(), chartSegmentDeselected(this, a, e)) : (this.selected = !0, a.draw(), chartSegmentSelected(this, a, e)) : 2 ==
                e.button ? $kyu.showDrillMenu(this, a, e) : a.customURL ? openCustomURL(a, h, d, a.customURL, e) : a.peekCategory ? (Array.isArray(a.data) ? (a.data[0].OLAP.ModelID ? _operatingMemberUnique = a.data[0].categoryUnique + "@@$$" + h.unique : (_operatingMemberUnique = "", h.expand1 && (_operatingMemberUnique = h.expand1 + "!,!"), h.expand2 && (_operatingMemberUnique += h.expand2 + "!,!"), h.expand3 && (_operatingMemberUnique += h.expand3 + "!,!"), _operatingMemberUnique += h.unique), _operatingSeriaUnique = this && (this.seriaUnique || this.seriaTitle) ? a.data[0].OLAP.ModelID &&
                    a.data[0].seriesUnique ? a.data[0].seriesUnique + "@@$$" + this.seriaTitle : this.seriaUnique : null) : (_operatingMemberUnique = a.data.OLAP && a.data.OLAP.ModelID ? a.data.categoryUnique + "@@$$" + h.unique : h.unique, _operatingSeriaUnique = this && (this.seriaUnique || this.seriaTitle) ? a.data.OLAP.ModelID && a.data.seriesUnique ? a.data.seriesUnique + "@@$$" + this.seriaTitle : this.seriaUnique : null), showQuickExploreTile(e, a, h, null, this.isSecondary)) : $kyu.showPoint(this, a))
        }); if (MOBILE_APP) d.on("touchstart", function (d) {
            _touchMoved = !1;
            if (300 > (new Date).getTime() - lastTouchTime) { var e = this; setTimeout(function () { b.SegmentSelectionMode ? e.selected ? (e.selected = !1, a.draw(), chartSegmentDeselected(e, a, d)) : (e.selected = !0, a.draw(), chartSegmentSelected(e, a, d)) : a.data.SegmentSelectionMode || $kyu.showDrillMenu(e, a, d) }, 300) } lastTouchTime = (new Date).getTime()
        })
}; $kyu.tileDraw = function (a) { a.draw() }; $kyu.smooth = function (a) { return Math.round(a) };
$kyu.getMemberColor = function (a, b) { if (0 == $kyu.memberColors.length) return b; var d = null; $.each($kyu.memberColors, function (b, f) { if (f.Name == a) return d = f.Color, !1 }); return null != d ? d : b }; $kyu.getFontColor = function (a) { return a.singleColor ? "white" : $kyu.dashboardFontColor };
$kyu.getStageSeriaColor = function (a, b) {
    if (a.data.SegmentSelectionMode) return -1 == a.colorPallete ? "white" : $kyu.getSeriaColor(1, a.colorPallete); if (-1 == a.colorPallete) return b >= a.singleColorPallete.length ? a.singleColorPallete[a.singleColorPallete.length - 1] : a.singleColorPallete[b]; var d = $kyu.getSeriaColor(b, a.colorPallete); if (0 < $kyu.memberColors.length && "List" != a.presentationType && "HeatMap" != a.presentationType && "Tree_Map" != a.presentationType && ("Geo_Map" != a.presentationType || a.dominantSeries)) "Pie_Chart" ==
        a.presentationType || "Doughnut_Chart" == a.presentationType ? a.data.points.length > b && (d = $kyu.getMemberColor(a.data.points[b].pointName, d)) : a.data.series.length > b && (d = $kyu.getMemberColor(a.data.series[b].seriaTitle, d)); return d
}; var _touchMoved = !1; $kyu.explicitSelectionHighlight = !1; function addStageEvents(a) { a.on("touchstart", null); a.on("touchmove", null) } $kyu.drawLine = function (a, b, d, e, f, g, i) { b = new Kinetic.Line({ points: [b + 0.5, d + 0.5, e + 0.5, f + 0.5], stroke: g, strokeWidth: i, lineJoin: "round" }); a.add(b); return b };
$kyu.drawLines = function (a, b, d, e, f, g, i) { for (var h = [], j = [], l = 0; l < b.length; l += 2)b[l] && b[l + 1] ? (j.push(b[l]), j.push(b[l + 1])) : 0 < j.length && (h.push(j), j = []); 0 < j.length && h.push(j); for (b = 0; b < h.length; b++)j = g ? new Kinetic.Line({ points: h[b], stroke: d, strokeWidth: e, lineJoin: "round", opacity: f, dashArray: [10, 10] }) : i ? new Kinetic.Spline({ points: h[b], stroke: d, strokeWidth: e, lineJoin: "round", opacity: f, tension: i }) : new Kinetic.Line({ points: h[b], stroke: d, strokeWidth: e, lineJoin: "round", opacity: f }), a.add(j) };
$kyu.drawDashedLines = function (a, b, d, e, f, g) { b = new Kinetic.Line({ points: b, stroke: d, strokeWidth: e, lineJoin: "round", opacity: f, dashArray: g ? g : [10, 10] }); a.add(b); return b }; $kyu.drawPolygon = function (a, b, d, e, f, g) { b = new Kinetic.Polygon({ points: b, fill: d, stroke: e, strokeWidth: f, lineJoin: "round", opacity: g }); a.add(b); return b }; $kyu.drawCircle = function (a, b, d, e, f, g, i, h) { b = new Kinetic.Circle({ x: b + 0.5, y: d + 0.5, radius: e, fill: f, opacity: g, strokeWidth: i ? i : 0, stroke: h }); a.add(b); return b };
$kyu.drawWedge = function (a, b, d, e, f, g, i, h, j) { b = new Kinetic.Wedge({ x: b + 0.5, y: d + 0.5, radius: e, angleDeg: h, fill: f, strokeWidth: g, stroke: i, rotationDeg: j }); a.add(b); return b }; $kyu.drawText = function (a, b, d, e, f, g, i, h) { b = new Kinetic.Text({ x: b, y: d, text: i, fontSize: f, fontFamily: e, fill: g, fontStyle: h ? h : "normal" }); a.add(b); return b }; $kyu.drawRect = function (a, b, d, e, f, g, i, h) { null == h && (h = 1); b = new Kinetic.Rect({ x: b, y: d, width: e, height: f, fill: g, stroke: i, strokeWidth: 0, opacity: h }); a.add(b); return b };
$kyu.createLayer = function (a, b, d, e, f) { b = new Kinetic.Layer({ x: d, y: d, width: e, height: f }); a.add(b); return b }; $kyu.rotatePoints = function (a, b, d, e) { for (var f = 0; f < e.length; f++) { var g = -1 * (b - e[f].x), i = d - e[f].y, h; h = 0 == g ? 0 < i ? 90 * Math.PI / 180 : 270 * Math.PI / 180 : 0 == i ? 0 < g ? 0 : 180 * Math.PI / 180 : Math.atan(i / g); var j = 1; 0 > g && 0 < i ? j = 2 : 0 > g && 0 > i ? j = 3 : 0 < g && 0 > i && (j = 4); h = 180 * h / Math.PI + a; 2 == j ? h += 180 : 3 == j ? h += 180 : 3 == j && (h += 360); g = Math.sqrt(g * g + i * i); e[f].x = b + g * Math.cos(h * Math.PI / 180); e[f].y = d - g * Math.sin(h * Math.PI / 180) } return e };
$kyu.centerText = function (a, b, d) { if (b && d) { var e = a.getWidth(), f = a.getX(); a.setX(b - e / 2); b = a.getHeight(); a.getY(); a.setY(d - b / 2) } else e = a.getWidth(), f = a.getX(), a.setX(f - e / 2) }; $kyu.alignRight = function (a, b) { var d = a.getWidth(), e = a.getX(); a.setX(e + (b - d)) }; $kyu.generateRandomArray = function (a, b, d, e) { for (var f = [], g = 0; g < a; g++) { var i = new point; i.pointName = "Random point " + g; for (var h = 0; h < e; h++)i.pointVal.push(Math.floor(Math.random() * d) + b); f.push(i) } return f };
function point() { this.pointName = ""; this.pointVal = [] } $kyu.getSeriaColor = function (a, b) { if (isNaN(b)) { var d = b.replace("$", ""), e = new Color("#ffffff"), d = new Color(d); return 0 == a ? LinearColorInterpolator.findColorBetween(e, d, 10).asRgbCss() : LinearColorInterpolator.findColorBetween(e, d, 20).asRgbCss() } e = $kyu.getColorPalette(b); return a < e.Colors.length ? e.Colors[a] : e.Colors[a - Math.floor((a + 1) / e.Colors.length) * e.Colors.length] };
$kyu.getColorPalette = function (a) { var b = null; $.each($kyu.colorPalletes, function (d, e) { if (e.ID == a) return b = e, !1 }); b || (b = $kyu.colorPalletes[0]); return b }; $kyu.ColorLuminance = function (a, b) { a = String(a).replace(/[^0-9a-f]/gi, ""); 6 > a.length && (a = a[0] + a[0] + a[1] + a[1] + a[2] + a[2]); var b = b || 0, d = "#", e, f; for (f = 0; 3 > f; f++)e = parseInt(a.substr(2 * f, 2), 16), e = Math.round(Math.min(Math.max(0, e + e * b), 255)).toString(16), d += ("00" + e).substr(e.length); return d };
$kyu.getRandomColor = function () { for (var a = "", b = 26; 50 > b; b++)a += "if (seriaNo == " + b + ' ) return "#' + (16777216 + 16777215 * Math.random()).toString(16).substr(1, 6) + '";\r\n' };
$kyu.getShortValue = function (a) {
    if (null == a) return ""; if (0 == a) return 0; var b = null; if (1E9 <= Math.abs(a)) { b = getLocaleString(new Number((new Number(a / 1E9)).toFixed(1))); if (".00" == b.substring(b.length - 3, b.length) || ",00" == b.substring(b.length - 3, b.length)) b = b.substring(0, b.length - 3); return b + "B" } if (1E6 <= Math.abs(a)) { b = getLocaleString(new Number((new Number(a / 1E6)).toFixed(1))); if (".00" == b.substring(b.length - 3, b.length) || ",00" == b.substring(b.length - 3, b.length)) b = b.substring(0, b.length - 3); return b + "M" } if (1E3 <=
        Math.abs(a)) { b = getLocaleString(new Number((new Number(a / 1E3)).toFixed(1))); if (".0" == b.substring(b.length - 3, b.length) || ",0" == b.substring(b.length - 3, b.length)) b = b.substring(0, b.length - 3); return b + "k" } return b = (new Number(a)).toFixed(0)
};
$kyu.drawTextBox = function (a, b, d, e, f, g, i, h, j) { if (a.length <= g) $kyu.drawText(b.children[0], d, e + 0 * b.lwX + f / 4, i, h, j, a, 100); else { var a = a.split(" "), l = "", k = "", m = !1; $.each(a, function (a, b) { l.length + 1 + b.length <= g ? l += b + " " : k.length + 1 + b.length <= g ? k += b + " " : m || (k += "...", m = !0) }); $kyu.drawText(b.children[0], d, e + 2 * b.lwX, i, h, j, l, 100); $kyu.drawText(b.children[0], d, e - 2 * b.lwX + f / 2, $kyu.dashboardFont, b.textSize, j, k, 100) } };
Color = function (a) { a = a instanceof Object ? a : LinearColorInterpolator.convertHexToRgb(a); this.r = a.r; this.g = a.g; this.b = a.b }; Color.prototype.asRgbCss = function () { return "rgb(" + this.r + ", " + this.g + ", " + this.b + ")" };
var LinearColorInterpolator = { convertHexToRgb: function (a) { match = a.replace(/#/, "").match(/.{1,2}/g); return new Color({ r: parseInt(match[0], 16), g: parseInt(match[1], 16), b: parseInt(match[2], 16) }) }, findColorBetween: function (a, b, d) { newColor = {}; components = ["r", "g", "b"]; for (var e = 0; e < components.length; e++)c = components[e], newColor[c] = Math.round(a[c] + (b[c] - a[c]) * d / 100); return new Color(newColor) } };
function lightOrDark(a) { var b, d; a.match(/^rgb/) ? (a = a.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/), b = a[1], d = a[2], a = a[3]) : (a = +("0x" + a.slice(1).replace(5 > a.length && /./g, "$&$&")), b = a >> 16, d = a >> 8 & 255, a &= 255); return 200 < Math.sqrt(0.299 * b * b + 0.587 * d * d + 0.114 * a * a) ? "light" : "dark" } $kyu.lineChartOffset = 5; $kyu.horizValOffsetLeft = 30; $kyu.horizValOffsetRight = 5; $kyu.titleHeight = 30; $kyu.pointLabelHeight = 15; $kyu.mplier = 1; $kyu.animPointOffset = 10; $kyu.comboLinePallete = -1;
$kyu.drawLineChart = function (a, b, d) {
    $kyu.removeOLDChartStage(a); stage = $kyu.initChart(a, null, b); d ? (stage.tension = d, stage.presentationType = "Spline_Chart") : stage.presentationType = "Line_Chart"; stage.labelHeightMode = "Transform"; $kyu.drawLegend(stage, b, !0); $kyu.calcPointHorizonal(stage, b); $kyu.drawPointLabels(stage, b); $kyu.findMinMaxValue(stage, b); $kyu.findChartMinMaxValue(stage); $kyu.calcPointVertical(stage); $kyu.drawLineChartYText(stage); $kyu.drawLineChartYLines(stage); $kyu.drawLineChartValues(stage, b);
    $kyu.drawAverageLines(stage); $kyu.drawTrendLines(stage); $kyu.displayValuesStandard(stage); $kyu.twoAxisChartBeforeDraw(stage); $kyu.tileDraw(stage); "Show" == stage.animateLastPoint && $kyu.animPoint(stage); return stage
};
$kyu.drawLineChartYLines = function (a) {
    var b = a.children[0], d = a.separateAxis ? (a.largeView ? 50 : 30) * $kyu.mplier : 0, e = a.attrs.width - $kyu.lineChartOffset - d - a.legendWidth, e = Math.floor(e), f = a.singleColor ? 0.2 : 0.5; $kyu.drawLine(b, 2 * $kyu.lineChartOffset + a.topText.getWidth(), $kyu.lineChartOffset + a.legendHeight, e, $kyu.lineChartOffset + a.legendHeight, "#efefef", f); if (0 > a.chartMinValue && 0 < a.chartMaxValue) {
        var g = Math.ceil(a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight); $kyu.drawLine(b, 2 * $kyu.lineChartOffset + a.baseText.getWidth(),
            g, e, g, a.fontColor, f); d = Math.ceil(a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight + a.pointVerticalDistance * a.chartMinValue)
    } else g = Math.ceil(a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight), $kyu.drawLine(b, 2 * $kyu.lineChartOffset + a.baseText.getWidth() - d, g, e, g, a.fontColor, f), d = a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - a.pointVerticalDistance * (a.chartHalfValue - a.chartMinValue), d = $kyu.smooth(d); $kyu.drawLine(b, 2 * $kyu.lineChartOffset + a.halfText.getWidth(), d, e, d, "#efefef", f)
};
$kyu.drawLineChartYText = function (a, b) {
    var d = 0; a.largeView && (d = 2); b || (b = 0 < a.data.series.length && -1 < a.data.series[0].seriaMeasureUnits.indexOf("%") ? "%" : ""); a.topText = $kyu.drawText(a.children[0], $kyu.lineChartOffset, $kyu.lineChartOffset + a.legendHeight - 5.5 * $kyu.mplier - d, $kyu.dashboardFont, a.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize, a.fontColor, $kyu.getShortValue(a.chartMaxValue) + b, 100); a.baseText = $kyu.drawText(a.children[0], $kyu.lineChartOffset, a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight -
        5.5 * $kyu.mplier - d, $kyu.dashboardFont, a.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize, a.fontColor, isNaN(a.chartMinValue) ? "" : $kyu.getShortValue(a.chartMinValue) + b, 100); a.customYMinMax && 0 != a.chartMinValue && a.baseText.setOpacity(0); a.halfText = 0 > a.chartMinValue && 0 < a.chartMaxValue ? $kyu.drawText(a.children[0], $kyu.lineChartOffset, a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight + a.pointVerticalDistance * a.chartMinValue - 5.5 * $kyu.mplier - d, $kyu.dashboardFont, a.largeView ? $kyu.dashboardLargeFontSize :
            $kyu.dashboardFontSize, a.fontColor, 0 + b, 100) : $kyu.drawText(a.children[0], $kyu.lineChartOffset, a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - a.pointVerticalDistance * (a.chartHalfValue - a.chartMinValue) - 5.5 * $kyu.mplier - d, $kyu.dashboardFont, a.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize, a.fontColor, isNaN(a.chartHalfValue) ? "" : $kyu.getShortValue(a.chartHalfValue) + b, 100)
};
$kyu.drawSecondAxisYText = function (a, b) {
    var d = 0; a.largeView && (d = 2); var e = 20 * $kyu.mplier, f = a.attrs.width - 0.5 * $kyu.lineChartOffset - e - a.legendWidth, g = a.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize, b = b ? b : "", i = $kyu.drawText(a.children[0], f, a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - a.pointVerticalDistance * (a.chartMaxValue - a.chartMinValue) - 0.5 * g, $kyu.dashboardFont, g, a.fontColor, $kyu.getShortValue(a.chartMaxValue2) + b, 100); $kyu.alignRight(i, e); i = $kyu.drawText(a.children[0], f, a.attrs.height -
        2 * $kyu.lineChartOffset - a.pointLabelHeight - 1 * $kyu.mplier - d, $kyu.dashboardFont, g, a.fontColor, $kyu.getShortValue(a.chartMinValue2) + b, 100); $kyu.alignRight(i, e); 0 > a.chartMinValue2 && 0 < a.chartMaxValue2 ? (i = a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight + a.pointVerticalDistance2 * a.chartMinValue2, f = $kyu.drawText(a.children[0], f, i - 5.5 * $kyu.mplier - d, $kyu.dashboardFont, g, a.fontColor, 0 + b, 100), $kyu.drawLine(a.children[0], 8 * $kyu.lineChartOffset + d, i, a.attrs.width - $kyu.lineChartOffset - a.legendWidth - e, i, "#efefef",
            1)) : f = $kyu.drawText(a.children[0], f, a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - a.pointVerticalDistance2 * (a.chartHalfValue2 - a.chartMinValue2) - 5.5 * $kyu.mplier - d, $kyu.dashboardFont, g, a.fontColor, $kyu.getShortValue(a.chartHalfValue2), 100); $kyu.alignRight(f, e)
};
$kyu.drawLineChartValues = function (a, b, d) {
    var e = a.children[0], f = b.points, g = a.pointHorizontalDistance, i = a.pointVerticalDistance; d && a.separateAxis && (i = a.pointVerticalDistance2); var h = f.length / (a.getWidth() / (100 * $kyu.mplier)); a.lineStrokeThickness = 20 < h ? 1 * $kyu.mplier : 10 < h ? 2 * $kyu.mplier : 3 < h ? 3 * $kyu.mplier : 4 * $kyu.mplier; a.lineWidth && (a.lineStrokeThickness = a.lineWidth.replace("px", "")); for (h = 0; h < b.series.length; h++) {
        var j = $kyu.getStageSeriaColor(a, h), l = 0.7; d && (!a.singleColor && a.colorPalleteCompare) && (j = $kyu.getSeriaColor(h,
            a.colorPalleteCompare), l = 1); -1 < $kyu.comboLinePallete && ("Combo" == a.presentationType && d) && (j = $kyu.getSeriaColor(h, $kyu.comboLinePallete), l = 1); for (var k = [], m = a.attrs.height, p = !1, n = 0; n < f.length; n++)if (Infinity == g ? k.push(a.attrs.width / 2) : k.push(n * g + a.pointHorizontalStart + 0.5), null != f[n].pointVal[h]) { var s = a.chartMinValue; a.separateAxis && (s = a.chartMinValue2); k.push(m - $kyu.lineChartOffset - a.pointLabelHeight - (f[n].pointVal[h] - s) * i + 0.5) } else k[k.length - 1] = null, k.push(null), p = !0; 0 == h && Infinity != g && !a.secondaryQueryAnalysisID ?
                b.SegmentSelectionMode ? $kyu.drawLines(e, k, $kyu.getStageSeriaColor(a, 1), a.lineStrokeThickness, 1, !1, a.tension) : ($kyu.drawLines(e, k, j, a.lineStrokeThickness, 1, !1, a.tension), n = 0, "Show" == a.animateLastPoint && (n = $kyu.animPointOffset * $kyu.mplier), k.push(a.attrs.width - a.legendWidth - $kyu.lineChartOffset - $kyu.horizValOffsetRight + 0.5 - n), k.push(a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight + 0.5), k.push($kyu.lineChartOffset + $kyu.horizValOffsetLeft + 0.5), k.push(a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight +
                    0.5), !p && (!a.hideFill && !a.tension) && $kyu.drawPolygon(e, k, $kyu.getStageSeriaColor(a, 0), "Transparent", a.lineStrokeThickness, d ? 0.08 : 0.15)) : 0 < k.length && (d ? $kyu.drawLines(e, k, j, a.lineStrokeThickness, l, "Line_Chart" == a.primaryChart ? !0 : !1, a.tension) : b.SegmentSelectionMode ? $kyu.drawLines(e, k, $kyu.getStageSeriaColor(a, 1), a.lineStrokeThickness, 1, !1, a.tension) : $kyu.drawLines(e, k, j, a.lineStrokeThickness, 1, !1, a.tension)); for (n = 0; n < f.length; n++)k = n * g + a.pointHorizontalStart, Infinity == g && (k = a.attrs.width / 2), s = a.chartMinValue,
                        a.separateAxis && (s = a.chartMinValue2), a.lastLeft = k, a.lastTop = m - $kyu.lineChartOffset - a.pointLabelHeight - (f[n].pointVal[h] - s) * i, null != f[n].pointVal[h] && f[n].pTxt[h] && (p = 5, 25 < f.length ? p = 3 : 10 < f.length && (p = 4), k = $kyu.drawCircle(e, k, a.lastTop, p * $kyu.mplier, j, d ? l : 1), $kyu.addShapeEvents(a, b, k, n, h, null, d))
    }
};
$kyu.animPoint = function (a) {
    if (!(void 0 == a.lastLeft || void 0 == a.lastTop) && !$kyu.prepareImageSetGUID) {
        if (a.data.successModel) { if ("Line_Chart" != a.data.miniChart) return } else if (a.miniChart) { if ("Column_Chart" == a.miniChart) return } else if (1 < a.data.series.length) return; var b = a.singleColor ? "white" : $kyu.getStageSeriaColor(a, 0), d = new Kinetic.Layer; a.add(d); var e = new Kinetic.Circle({ x: a.lastLeft + 0.5, y: a.lastTop + 0.5, radius: 5, fill: "transparent", opacity: 0.33, strokeWidth: 1, stroke: b }); d.add(e); e.setListening(!1); var f =
            new Kinetic.Circle({ x: a.lastLeft + 0.5, y: a.lastTop + 0.5, radius: 0, fill: "transparent", opacity: 0.33, strokeWidth: 1, stroke: b }); d.add(f); f.setListening(!1); var g = 7.5, i = 0, h = 15, j = 200, l = 1; if (a.largeView) g = 10, h = 20, j = 100, l = 3; else if (a.data.successModel || a.miniChart) g = 5, h = 10, l = 1, j = 300; (new Kinetic.Animation(function (a) { g += a.timeDiff / j; g > h && (g = 0); var b = 1 - g / h, d = 1 + b * l; e.setRadius(g); e.setOpacity(b); e.setStrokeWidth(d); i += a.timeDiff / j; i > h && (i = 0); 0 == g && 0 == i && (i = h / 2); a = 1 - i / h; b = 1 + a * l; f.setRadius(i); f.setOpacity(a); f.setStrokeWidth(b) },
                d)).start()
    }
};
$kyu.showPoint = function (a, b, d) {
    if (!("Geo_Map" == b.presentationType || "Table" == b.presentationType || "Tree_Map" == b.presentationType)) if (b.pointLabel && b.pointLabel.displayed) $kyu.hidePoint(a, b, !0); else if ("Bubble_Chart" != b.presentationType && a.setOpacity(1), "Circle" == a.className && (a.setShadowColor("black"), a.setShadowBlur(3), a.setShadowOffset(0), a.setShadowOpacity(1)), b.data && b.data.points) {
        var e = b.data.points[a.pointNo], f = a.seriaTitle ? a.seriaTitle : ""; b.pointLabel || (b.pointLabel = $kyu.drawRect(b.children[0], 20,
            20, 200, 40 + (b.ranges ? 18 * (b.ranges.length - 1) : 0), "white", "#cccccc"), b.pointLabel.setShadowColor("#cccccc"), b.pointLabel.setShadowBlur(3), b.pointLabel.setShadowOffset(1), b.pointLabel.setShadowOpacity(1), b.pointLabelText = $kyu.drawText(b.children[0], 25, 25, $kyu.dashboardFont, $kyu.dashboardFontSize, $kyu.dashboardFontColor, e.pointName), b.pointLableRect = $kyu.drawRect(b.children[0], 25, 43, 5, 5, a.getFill(), a.getFill()), b.pointSeriaText = $kyu.drawText(b.children[0], 35, 40, $kyu.dashboardFont, $kyu.dashboardFontSize,
                $kyu.dashboardFontColor, f), b.pointLabelValue = $kyu.drawText(b.children[0], 25 + b.pointSeriaText.getWidth() + 5, 40, $kyu.dashboardFont, $kyu.dashboardFontSize, $kyu.dashboardFontColor, e.pTxt[0], "bold"), b.ranges && 1 < b.ranges.length && (b.pointLableRect2 = $kyu.drawRect(b.children[0], 25, 66, 5, 5, "#058dc7", "#058dc7"), b.pointMeasureText2 = $kyu.drawText(b.children[0], 35, 60, $kyu.dashboardFont, $kyu.dashboardFontSize, $kyu.dashboardFontColor, b.ranges[1].MeasureName), b.pointLabelValue2 = $kyu.drawText(b.children[0], 25 + b.pointMeasureText2.getWidth() +
                    5, 40, $kyu.dashboardFont, $kyu.dashboardFontSize, $kyu.dashboardFontColor, e.pTxt[1], "bold")), b.ranges && 2 < b.ranges.length && (b.pointLableRect3 = $kyu.drawRect(b.children[0], 25, 66, 5, 5, "#058dc7", "#058dc7"), b.pointMeasureText3 = $kyu.drawText(b.children[0], 35, 60, $kyu.dashboardFont, $kyu.dashboardFontSize, b.fontColor, b.ranges[2].MeasureName), b.pointLabelValue3 = $kyu.drawText(b.children[0], 25 + b.pointMeasureText3.getWidth() + 5, 40, $kyu.dashboardFont, $kyu.dashboardFontSize, $kyu.dashboardFontColor, e.pTxt[2], "bold")));
        b.data.OLAP && !a.measureCaption ? (b.pointLabelText.setText(e.pointName), b.pointSeriaText && b.pointSeriaText.setText(f + ":")) : b.data.OLAP && a.measureCaption ? (b.pointLabelText.setText(e.pointName + (f ? " - " + f : "")), f = b.data.OLAP.Measure, b.data.OLAP.ModelID || (f = b.data.measureNames.split(",")[0]), a.measureCaption && (f = a.measureCaption), b.pointSeriaText.setText(f + ":")) : (b.pointLabelText.setText(e.pointName), b.pointSeriaText.setText(f)); b.pointLableRect.setFill(a.getFill()); b.pointLableRect.setStroke(a.getFill());
        b.pointLabelValue.setText(a.displayVal); b.ranges && 1 < b.ranges.length && (b.pointMeasureText2.setText(b.ranges[1].MeasureName + ":"), b.data.OLAP && !b.data.OLAP.HasOnlyMeasures ? b.pointLabelValue2.setText(e.pTxt[1 * b.data.series.length + a.seriaNo]) : b.pointLabelValue2.setText(e.pTxt[1]), b.pointLableRect2.setFill(a.getFill()), b.pointLableRect2.setStroke(a.getFill())); b.ranges && 2 < b.ranges.length && (b.pointMeasureText3.setText(b.ranges[2].MeasureName + ":"), b.data.OLAP && !b.data.OLAP.HasOnlyMeasures ? b.pointLabelValue3.setText(e.pTxt[2 *
            b.data.series.length + a.seriaNo]) : b.pointLabelValue3.setText(e.pTxt[2]), b.pointLableRect3.setFill(a.getFill()), b.pointLableRect3.setStroke(a.getFill())); var e = b.pointLabelText.getWidth() + 15, g = 30 + b.pointSeriaText.getWidth() + b.pointLabelValue.getWidth(), f = b.pointMeasureText2 ? 30 + b.pointMeasureText2.getWidth() + b.pointLabelValue2.getWidth() : 0, i = b.pointMeasureText3 ? 30 + b.pointMeasureText3.getWidth() + b.pointLabelValue3.getWidth() : 0, e = e > g ? e : g, e = f > e ? f : e, e = i > e ? i : e; b.pointLabel.setWidth(e); f = a.getX(); a = a.getY();
        d = d ? -20 : a < b.getHeight() / 2 ? a : a - 70; a = f < b.getWidth() / 2 ? f : f - e - 20; a + e + 20 > b.getWidth() && (a = b.getWidth() - e - 20); 0 > a && (a = 0); b.pointLabel.setX(20 + a); b.pointLabelText.setX(25 + a); b.pointSeriaText.setX(36 + a); b.pointLableRect.setX(26 + a); b.pointLabelValue.setX(26 + b.pointSeriaText.getWidth() + 15 + a); b.pointMeasureText2 && (b.pointMeasureText2.setX(36 + a), b.pointLableRect2.setX(26 + a), b.pointLabelValue2.setX(26 + b.pointMeasureText2.getWidth() + 15 + a)); b.pointMeasureText3 && (b.pointMeasureText3.setX(36 + a), b.pointLableRect3.setX(26 +
            a), b.pointLabelValue3.setX(26 + b.pointMeasureText3.getWidth() + 15 + a)); b.pointLabel.setY(20 + d); b.pointLabelText.setY(25 + d); b.pointSeriaText.setY(43 + d); b.pointLableRect.setY(47 + d); b.pointLabelValue.setY(43 + d); b.pointMeasureText2 && (b.pointMeasureText2.setY(61 + d), b.pointLableRect2.setY(65 + d), b.pointLabelValue2.setY(61 + d), b.pointMeasureText2.show(), b.pointLableRect2.show(), b.pointLabelValue2.show()); b.pointMeasureText3 && (b.pointMeasureText3.setY(79 + d), b.pointLableRect3.setY(83 + d), b.pointLabelValue3.setY(79 +
                d), b.pointMeasureText3.show(), b.pointLableRect3.show(), b.pointLabelValue3.show()); b.pointLabel.show(); b.pointLabelText.show(); b.pointSeriaText.show(); b.pointLabelValue.show(); b.pointLableRect.show(); b.pointLabel.displayed = !0; b.draw()
    }
};
$kyu.hidePoint = function (a, b, d) {
    b.pointLabel && (b.pointLabel.displayed = !1, a.setShadowOpacity(0.01), a.originalOpacity && a.setOpacity(a.originalOpacity), 4 > b.lineStrokeThickness && (!d && !b.initialyHadPoints && "Rect" != a.className) && a.setOpacity(0), b.pointLabel && (b.pointLabel.hide(), b.pointLabelText.hide(), b.pointSeriaText.hide(), b.pointLabelValue.hide(), b.pointLableRect.hide()), b.pointMeasureText2 && (b.pointMeasureText2.hide(), b.pointLableRect2.hide(), b.pointLabelValue2.hide()), b.pointMeasureText3 && (b.pointMeasureText3.hide(),
        b.pointLableRect3.hide(), b.pointLabelValue3.hide()), b.draw())
}; $kyu.calcMiniLineChartPointDistance = function (a, b, d, e) { b.points && (a.pointHorizontalDistance = a.largeView ? (d - 15) / (b.points.length - 1) : d / (b.points.length - 1), a.pointVerticalDistance = e / Math.abs(a.maxValue - a.minValue)); return a };
$kyu.drawMiniChartLines = function (a, b, d, e, f, g) {
    a.lineStrokeThickness = f ? f : 1.5; f = g ? g : a.singleColor ? "white" : $kyu.getStageSeriaColor(a, 1); if (b.points) {
        var i = d, d = [], h = e; "Show" == a.animateLastPoint && (h -= 3, a.largeView && (h -= 10)); for (var j, l = 0, e = 0; e < b.points.length; e++)null != b.points[e].pointVal[0] && (l && null == j && (j = b.points[e]), d.push(i + e * a.pointHorizontalDistance + 0.5), d.push(h - (b.points[e].pointVal[0] - a.chartMinValue) * a.pointVerticalDistance)); l && $kyu.drawLine(a.children[0], i + 0.5, h - (j.pointVal[0] - a.chartMinValue) *
            a.pointVerticalDistance, i + (d.length - 1) * a.pointHorizontalDistance + 0.5, h - (j.pointVal[0] - a.chartMinValue) * a.pointVerticalDistance, "#f5f4f4", 1); $kyu.drawLines(a.children[0], d, f, a.lineStrokeThickness)
    } j = a.children[0]; d = b.points; f = $kyu.getStageSeriaColor(a, 0); if (b.points) for (e = 0; e < d.length; e++)if (null != d[e].pointVal[0]) {
        var g = i + e * a.pointHorizontalDistance + 0.5, k = h - (b.points[e].pointVal[0] - a.chartMinValue) * a.pointVerticalDistance; e == d.length - 1 && (a.lastLeft = g, a.lastTop = k); var m = d.length - 1 == e ? 1.5 : 3; l && 0 == e &&
            (m = 2, $kyu.drawText(a.children[0], g + 5, h / 2 > k ? k + 5 : k - 10, $kyu.dashboardFont, 9, f, d[e].pTxt[0])); g = $kyu.drawCircle(j, g, k, m, f); g.pointNo = e; g.seriaNo = 0; g.displayVal = d[e].pTxt[0]; l ? d.length - 1 > e && 0 != e && g.setOpacity(0) : d.length - 1 > e ? g.setOpacity(0) : (g.setShadowColor("black"), g.setShadowBlur(3), g.setShadowOffset(0), g.setShadowOpacity(1), g.setOpacity(1)); g.on("mouseover", function () { $kyu.showPoint(this, a, !0) }); g.on("mouseout", function () { this.pointNo < b.points.length - 1 && $kyu.hidePoint(this, a) })
    }
};
$kyu.columnChartOffset = 10;
$kyu.drawColumnChart = function (a, b) {
    $kyu.removeOLDChartStage(a); stage = $kyu.initChart(a, null, b); stage.presentationType = "Column_Chart"; stage.data = b; var d = b.points; $kyu.drawLegend(stage, b, !0); $kyu.calcPointHorizonal(stage, b); $kyu.drawPointLabels(stage, b); for (var e = d[0].pointVal[0], f = d[0].pointVal[0], g = 0; g < b.series.length; g++)for (var i = 0; i < d.length; i++)d[i].pointVal[g] > f && (f = d[i].pointVal[g]), d[i].pointVal[g] < e && (e = d[i].pointVal[g]); stage.minValue = e; stage.maxValue = f; $kyu.findChartMinMaxValue(stage); $kyu.calcPointVertical(stage);
    $kyu.drawColumnChartYLines(stage); $kyu.drawColumnChartValues(stage, b); $kyu.drawAverageLines(stage); $kyu.drawTrendLines(stage); $kyu.displayValuesStandard(stage); $kyu.drawColumnChartYText(stage); $kyu.drawBaseDetails(stage); $kyu.twoAxisChartBeforeDraw(stage); $kyu.tileDraw(stage); return stage
};
$kyu.drawColumnChartYLines = function (a) {
    var b = 0; a.largeView && (b = 16); var d = a.children[0], e = a.attrs.width - $kyu.lineChartOffset - a.legendWidth - (a.separateAxis ? (a.largeView ? 50 : 30) * $kyu.mplier : 0), f = a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - a.pointVerticalDistance * (a.chartMaxValue - a.chartMinValue), f = Math.floor(f), g = a.singleColor ? 0.2 : 0.5; $kyu.drawLine(d, 8 * $kyu.lineChartOffset + b, f, e, f, "#efefef", g); 0 > a.chartMinValue && 0 < a.chartMaxValue ? (a = a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight + a.pointVerticalDistance *
        a.chartMinValue, a = $kyu.smooth(a), $kyu.drawLine(d, 5 * $kyu.lineChartOffset + b, a, e, a, "#efefef", g)) : (a = a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - a.pointVerticalDistance * (a.chartHalfValue - a.chartMinValue), a = $kyu.smooth(a), $kyu.drawLine(d, 8 * $kyu.lineChartOffset + b, a, e, a, "#efefef", g))
};
$kyu.drawColumnChartYText = function (a) {
    var b = 0; a.largeView && (b = 2); var d = ""; 0 < a.data.series.length && -1 < a.data.series[0].seriaMeasureUnits.indexOf("%") && (d = "%"); $kyu.drawText(a.children[0], $kyu.lineChartOffset, a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - a.pointVerticalDistance * (a.chartMaxValue - a.chartMinValue) - 5.5 * $kyu.mplier - b, $kyu.dashboardFont, a.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize, a.fontColor, $kyu.getShortValue(a.chartMaxValue) + d, 100); 0 > a.chartMinValue && 0 < a.chartMaxValue ?
        $kyu.drawText(a.children[0], $kyu.lineChartOffset, a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight + a.pointVerticalDistance * a.chartMinValue - 5.5 * $kyu.mplier - b, $kyu.dashboardFont, a.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize, a.fontColor, 0, 100) : $kyu.drawText(a.children[0], $kyu.lineChartOffset, a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - a.pointVerticalDistance * (a.chartHalfValue - a.chartMinValue) - 5.5 * $kyu.mplier - b, $kyu.dashboardFont, a.largeView ? $kyu.dashboardLargeFontSize :
            $kyu.dashboardFontSize, a.fontColor, $kyu.getShortValue(a.chartHalfValue) + d, 100)
};
$kyu.drawBaseDetails = function (a) {
    var b = 0; a.largeView && (b = 2); var d = Math.ceil(a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight), e = 0; a.separateAxis && (e = a.separateAxis ? (a.largeView ? 50 : 30) * $kyu.mplier : 0); $kyu.drawLine(a.children[0], 5 * $kyu.lineChartOffset, d, a.attrs.width - $kyu.lineChartOffset - a.legendWidth - e, d, a.fontColor, 1); $kyu.drawText(a.children[0], $kyu.lineChartOffset, a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - 5.5 * $kyu.mplier - b, $kyu.dashboardFont, a.largeView ? $kyu.dashboardLargeFontSize :
        $kyu.dashboardFontSize, a.fontColor, $kyu.getShortValue(a.chartMinValue), 100)
};
$kyu.drawColumnChartValues = function (a, b, d, e, f) {
    var g = 20 > b.points.length ? !0 : !1, i = a.pointVerticalDistance; f && a.separateAxis && (i = a.pointVerticalDistance2); var h = a.valueAreaWidth / b.points.length, j = 4 * h / 5, l = 0.25 * j; if (e || d) j *= 0.75; var k = h / 10, m = a.chartMinValue; a.separateAxis && (m = a.chartMinValue2); var h = a.pointHorizontalStart - h / 2 + k, m = a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight + m * i - 0.5, j = j / b.series.length, p = j + 2, n = 1; a.primaryChart && (!d && !e) && (n = 0.7); for (var s = 0; s < b.points.length; s++) {
        e && (h += l); for (var r =
            0; r < b.series.length; r++) {
            var t = b.points[s], w = b.series[r], q = i * t.pointVal[r]; isNaN(q) && (q = 0); var u = $kyu.getStageSeriaColor(a, r); if (d || f) n = 0.3, !a.singleColor && a.colorPalleteCompare && (u = $kyu.getSeriaColor(r, a.colorPalleteCompare), n = 1); var y = 1, v; g ? (v = $kyu.smooth(h), v < h && (v++, y = 2)) : v = h; q = $kyu.drawRect(a.children[0], v, Math.ceil(m - q), Math.floor(p) - y, $kyu.smooth(q), u, null, n); q.pointNo = s; q.seriaNo = r; q.seriaUnique = w.seriaUnique; q.seriaTitle = w.seriaTitle; q.displayVal = t.pTxt[r]; q.categoryUnique = t.unique; q.pointName =
                t.pointName; q.tileID = a.tileID; 1 != q.getOpacity() && (q.originalOpacity = q.getOpacity()); if (a.data.OLAP && (b.measureNames || b.OLAP.Measure) && !b.OLAP.HasOnlyMeasures) q.measureCaption = b.OLAP.ModelID ? b.OLAP.Measure : b.measureNames.split(";")[0]; $kyu.addShapeEvents(a, b, q, s, r, null, f ? !0 : !1); h += j
        } d && (h += l); h += 2 * k
    }
};
$kyu.showColumnDetails = function (a, b, d) {
    a.setShadowColor("black"); a.setShadowBlur(5); a.setShadowOffset(0); a.setShadowOpacity(1); var e; e = a.groupNo ? b.data.Groups[a.groupNo].Points[a.pointNo] : b.data.points[a.pointNo]; var f = b.data.series[a.seriaNo].seriaTitle, g = b.data.series[a.seriaNo].seriaMeasureUnits, i = $kyu.getStageSeriaColor(b, a.seriaNo); b.pointLabel || (b.pointLabel = $kyu.drawRect(b.children[0], 20, 20, 200, 37, "white", "#cccccc"), b.pointLabel.setShadowColor("#cccccc"), b.pointLabel.setShadowBlur(3), b.pointLabel.setShadowOffset(1),
        b.pointLabel.setShadowOpacity(1), b.pointLabelText = $kyu.drawText(b.children[0], 25, 25, $kyu.dashboardFont, $kyu.dashboardFontSize, $kyu.dashboardFontColor, e.pointName), b.pointLableRect = $kyu.drawRect(b.children[0], 25, 43, 5, 5, i, i), b.pointSeriaText = $kyu.drawText(b.children[0], 35, 40, $kyu.dashboardFont, $kyu.dashboardFontSize, $kyu.dashboardFontColor, f), b.pointLabelValue = $kyu.drawText(b.children[0], 25 + b.pointSeriaText.getWidth() + 5, 40, $kyu.dashboardFont, $kyu.dashboardFontSize, $kyu.dashboardFontColor, getLocaleString(e.pointVal[a.seriaNo]) +
            " " + g, "bold")); b.pointLabelText.setText(e.pointName); b.pointSeriaText.setText(f + ":"); b.pointLabelValue.setText(a.displayVal); b.pointLableRect.setFill(i); b.pointLableRect.setStroke(i); e = b.pointLabelText.getWidth() + 15; f = 30 + b.pointSeriaText.getWidth() + b.pointLabelValue.getWidth(); e = e > f ? e : f; b.pointLabel.setWidth(e); f = a.getX(); a = a.getY(); d = d ? -20 : a < b.getHeight() / 2 ? a : a - 70; a = f < b.getWidth() / 2 ? f : f - e - 20; b.pointLabel.setX(20 + a); b.pointLabelText.setX(25 + a); b.pointSeriaText.setX(35 + a); b.pointLableRect.setX(25 +
                a); b.pointLabelValue.setX(25 + b.pointSeriaText.getWidth() + 15 + a); b.pointLabel.setY(20 + d); b.pointLabelText.setY(25 + d); b.pointSeriaText.setY(40 + d); b.pointLableRect.setY(43 + d); b.pointLabelValue.setY(40 + d); b.pointLabel.show(); b.pointLabelText.show(); b.pointSeriaText.show(); b.pointLabelValue.show(); b.pointLableRect.show(); b.draw()
};
$kyu.hideColumnDetails = function (a, b) { a.setShadowOpacity(0.01); b.pointLabel && (b.pointLabel.hide(), b.pointLabelText.hide(), b.pointSeriaText.hide(), b.pointLabelValue.hide(), b.pointLableRect.hide()); b.draw() };
$kyu.drawColumnPointLabels = function (a, b) {
    var d = 3 < b.points.length ? !0 : !1, e = !0, f = 3 * (a.attrs.width - 2 * $kyu.lineChartOffset - ($kyu.horizValOffsetLeft + 5) - $kyu.horizValOffsetRight) / 5 / b.points.length, f = f + 2 * (f / 3), g = $kyu.lineChartOffset + ($kyu.horizValOffsetLeft + 5), i = a.attrs.height - $kyu.lineChartOffset - a.pointLabelHeight - 0.5, g = g + f / 2, h; h = a.attrs.width > 550 * $kyu.mplier ? 7 < b.points.length ? 7 : b.points.length : a.attrs.width > 450 * $kyu.mplier ? 6 < b.points.length ? 6 : b.points.length : a.attrs.width > 350 * $kyu.mplier ? 5 < b.points.length ?
        5 : b.points.length : 3 < b.points.length ? 3 : b.points.length; var j = 0, l = b.points.length / (h - 1); d || (i -= 15); for (var k = 0; k < b.points.length && j != h; k++) {
            if (k >= j * l - 1) {
                var m = 21 > b.points[k].pointName.length ? b.points[k].pointName : b.points[k].pointName.substring(0, 20) + ".", m = $kyu.drawText(a.children[0], g, e ? i + 20.5 * $kyu.mplier : i + 5.5 * $kyu.mplier, $kyu.dashboardFont, a.largeView ? $kyu.dashboardLargeFontSize : $kyu.dashboardFontSize, a.fontColor, m, 100), p = m.getWidth(); 0 == j ? g - p / 2 < $kyu.lineChartOffset ? m.setX($kyu.lineChartOffset) :
                    m.setX(g - p / 2) : j == h - 1 ? g + p / 2 > a.attrs.width - $kyu.lineChartOffset ? m.setX(a.attrs.width - $kyu.lineChartOffset - p) : m.setX(g - p / 2) : m.setX(g - p / 2); j++; d && (e = !e)
            } g += f
        }
};
$kyu.drawMiniColumnChartValues = function (a, b, d, e, f, g) {
    a.valueAreaHeight = e; a.pointVerticalDistance = a.valueAreaHeight / Math.abs(a.chartMaxValue - 0); a.valueAreaWidth = d; 4 < d / b.points.length ? (d = (d - 2 * b.points.length) / b.points.length, e = 2) : 2 < d / b.points.length ? (d = (d - b.points.length) / b.points.length, e = 1) : (d /= b.points.length, e = 0); for (var i = a.singleColor ? "#ffffff" : $kyu.getStageSeriaColor(a, 0), h = i = $kyu.ColorLuminance(i, 0.15), j = 0; j < b.points.length; j++) {
        var f = f + e, l = a.pointVerticalDistance * b.points[j].pointVal[0], k =
            i; j == b.points.length - 1 && (k = h); $kyu.smooth(f); l = $kyu.drawRect(a.children[0], f, g - l, d - 1, l, k, k, 1); $kyu.addShapeEvents(a, b, l, j, 0, !0); f += d
    }
}; $kyu.continueAnalysis = function (a) { a ? window.open($kyu.config.URL + "/Forms/Analysis.aspx?AnalysisId=" + a) : window.open($kyu.config.URL + "/Forms/Analysis.aspx?AnalysisId=" + $("#LargeChartTile").data("multivalueanalysisid")) }; var _operatingTile = null, _operatingMemberUnique = null, _operatingSeriaUnique = null, _drillMenu = null, _drillthroughMenu = null, _chartsMenu = null, _simpleMenu = null;
$kyu.showSimpleMenu = function (a) {
    $kyu.HideMenu(); _operatingTile = $("#" + a + " .tile"); $(".contextMenuDiv").is(":visible") || (null == _simpleMenu ? (_simpleMenu = new ContextMenu, _simpleMenu.Title = "Simple", item = new MenuItem, item.Title = $kyu.lng("_selectChartType"), item.SubMenu = "menuManager.ShowMenu(_chartsMenu, _simpleMenu, null, event);setTimeout( continueMenuHiding, 200 );", _simpleMenu.Items.add(item), menuManager.CreateMenu(_simpleMenu, 232), menuManager.ShowMenu(_simpleMenu, null, null, $kyu.lastEvent), $kyu.createChartsMenu(),
        setTimeout(continueMenuHiding, 230)) : menuManager.ShowMenu(_simpleMenu, null, null, $kyu.lastEvent))
};
$kyu.createChartsMenu = function () {
    if (null == _chartsMenu) {
        _chartsMenu = new ContextMenu; _chartsMenu.Title = "Charts"; var a = new MenuItem; a.Title = $kyu.lng("__columnChart"); a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Column_Chart")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__columnStack"); a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Column_Stack")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__columnChart") + " 100%"; a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Column_100")';
        _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__lineChart"); a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Line_Chart")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__splineChart"); a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Spline_Chart")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__barChart"); a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Bar_Chart")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__areaChart");
        a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Area_Chart")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__areaStackChart"); a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Area_Stack")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__areaChart") + " 100%"; a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Area_100")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__pieChart"); a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Pie_Chart")';
        _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__doughnutChart"); a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Doughnut_Chart")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__list"); a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("List")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__bubbleChart"); a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Bubble_Chart")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__table");
        a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Table")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__combo"); a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Combo")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__heatMap"); a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("HeatMap")'; _chartsMenu.Items.add(a); a = new MenuItem; a.Title = $kyu.lng("__sunburst"); a.ActionURL = 'javascript:$kyu.HideMenu(); changeTileChartType("Sunburst")'; _chartsMenu.Items.add(a);
        menuManager.CreateMenu(_chartsMenu, 232)
    }
};
$kyu.showDrillMenu = function (a, b, d) {
    if (a && !("SUM" == a.categoryUnique || "AVG" == a.categoryUnique) && "undefined" != typeof MenuManager) if ($kyu.HideMenu(), !$kyu.designMode) {
        var e; if (a) { if (a.seriaTitle && 0 == a.seriaTitle.indexOf("[")) return; e = Array.isArray(b.data) ? a : b.data.points[a.pointNo] } else e = b.data.points.pop(); (d.button || 0 == d.button) && 2 != d.button && !IS_MOBILE ? b.peekCategory ? (Array.isArray(b.data) ? (b.data[0].OLAP.ModelID ? _operatingMemberUnique = b.data[0].categoryUnique + "@@$$" + e.unique : (_operatingMemberUnique =
            "", e.expand1 && (_operatingMemberUnique = e.expand1 + "!,!"), e.expand2 && (_operatingMemberUnique += e.expand2 + "!,!"), e.expand3 && (_operatingMemberUnique += e.expand3 + "!,!"), _operatingMemberUnique += e.unique), _operatingSeriaUnique = a && (a.seriaUnique || a.seriaTitle) ? b.data[0].OLAP.ModelID && b.data[0].seriesUnique ? b.data[0].seriesUnique + "@@$$" + a.seriaTitle : a.seriaUnique : null) : (_operatingMemberUnique = b.data.OLAP.ModelID ? b.data.categoryUnique + "@@$$" + e.unique : e.unique, _operatingSeriaUnique = a && (a.seriaUnique || a.seriaTitle) ?
                b.data.OLAP.ModelID && b.data.seriesUnique ? b.data.seriesUnique + "@@$$" + a.seriaTitle : a.seriaUnique : null, $kyu.showPoint(a, b)), showQuickExploreTile(d, b, e, !1)) : b.customURL && openCustomURL(b, e, a, b.customURL, d) : b.data.OLAP ? (ANALYSIS_TYPE = b.data.OLAP.ModelID ? 100 : 1, defineDrillContextMenu(b, e, a, d)) : Array.isArray(b.data) && b.data[0].OLAP && (ANALYSIS_TYPE = b.data[0].OLAP.ModelID ? 100 : 1, defineDrillContextMenu(b, e, a, d)); return !1
    }
};
$kyu.openCustomURL = function (a, b) { _operatingTile = $("#" + a.divID).parents(".tile")[0]; var d = $(_operatingTile).data("customurl"), e = "pointName=" + encodeURIComponent(b.pointName); b.unique && (e += "&pointUnique=" + encodeURIComponent(b.unique)); d && "" != d && (d = -1 < d.indexOf("?") ? d + "&" + e : d + "?" + e, window.open(d, "_blank").focus()) };
function defineDrillContextMenu(a, b, d, e) {
    dashContextAction = 1; var f = Array.isArray(a.data), g, i, h; _operatingTile = $("#" + a.divID).parents(".tile")[0]; f ? (_operatingStage = a, _operatingWedge = d, g = d.categoryUnique, i = a.data[0].OLAP.DataSourceID, extractHierarchy(g), h = a.data[0].OLAP.Measure, _operatingMemberUnique = 100 == ANALYSIS_TYPE ? a.levels[d.levelNumber].levelUnique + "@@$$" + g : g) : (g = b.unique, i = a.data.OLAP.DataSourceID, extractHierarchy(g), h = a.data.OLAP.Measure, _operatingMemberUnique = 100 == ANALYSIS_TYPE ? a.data.categoryUnique +
        "@@$$" + b.unique : b.unique); _operatingSeriaUnique = d && (d.seriaUnique || d.seriaTitle) ? 100 == ANALYSIS_TYPE ? "undefined" == typeof a.data.seriesUnique ? null : a.data.seriesUnique + "@@$$" + d.seriaTitle : d.seriaUnique : null; a = _operatingMemberUnique; _operatingMemberUnique.indexOf("!,!") && (a = _operatingMemberUnique.split("!,!")[0]); null != _drillMenu && _drillMenu.OperatingMember == _operatingMemberUnique ? (menuManager.ShowMenu(_drillMenu, null, null, e), setTimeout(continueMenuHiding, 230)) : (_drillMenu = null, $kyu.HideMenu(), h = "{'dataSourceID':" +
            i + ",'measureUnique':" + $kyu.checkNull(h) + ",'memberUnique':" + $kyu.checkNull(a) + ",'token':" + $kyu.checkNull($kyu.token) + "}", h = h.replace(/'/g, '"'), h = JSON.parse(h), $.ajax({
                crossDomain: !0, type: "GET", contentType: "application/json; charset=utf-8", url: $kyu.config.URL + "/WebServices/DataService.asmx/GetDrillthroughDrilldownOptionsP", data: h, dataType: "jsonp", success: function (a) {
                    if ($kyu.diagnoseResponse(a)) {
                        menuManager.HideAllMenus(); menuManager.RemoveAllMenus(); _drillMenu = new ContextMenu; _drillMenu.Title = "DrillMenu";
                        _drillMenu.OperatingMember = _operatingMemberUnique; var b = a.split("_##_"), g = b[0], h = b[1]; h && "" != h && (b = new MenuItem, b.Title = $kyu.lng("__drillDown"), b.ActionURL = f ? 'javascript:$kyu.HideMenu(); $kyu.addNewDrillLevel(_operatingStage, _operatingWedge, "' + h + '")' : 'javascript:$kyu.HideMenu(); tileDrillBy("' + h + '","' + (null == d.countryCode ? "" : d.countryCode) + '")', _drillMenu.Items.add(b)); b = new MenuItem; b.Title = $kyu.lng("__drillBy"); b.ActionURL = "javascript:$kyu.HideMenu();getCubeTreePicker(" + i + "," + (f && "Sunburst" ==
                            $(_operatingTile).data("presentationtype") ? '"drillAnalyticTree"' : '"Drill"') + ',"' + $kyu.lng("__selDimHier") + '");'; _drillMenu.Items.add(b); if ("" != g) {
                                b = new MenuItem; b.Title = $kyu.lng("__drillthrough"); b.SubMenu = "menuManager.ShowMenu(_drillthroughMenu, _drillMenu, null, event);setTimeout( continueMenuHiding, 200 );"; _drillMenu.Items.add(b); _drillthroughMenu = new ContextMenu; _drillthroughMenu.Title = $kyu.lng("__drillthrough"); a = a.split(";"); null == _operatingSeriaUnique && (_operatingSeriaUnique = ""); for (g = 0; g <
                                    a.length - 1; g++)-1 < a[g].indexOf("#") && (h = a[g].split("#"), b = new MenuItem, b.Title = h[0], "0" == h[1] ? (b.Icon = $kyu.config.URL + "/images/drillthroughCube16.png", b.ActionURL = 'javascript:$kyu.HideMenu(); execDrillthrough("' + h[0] + '","0","' + _operatingMemberUnique + '","' + _operatingSeriaUnique + '")') : (b.Icon = $kyu.config.URL + "/images/drillthrough16.png", b.ActionURL = 'javascript:$kyu.HideMenu(); execDrillthrough("' + h[0] + '","' + h[1] + '","' + _operatingMemberUnique + '","' + _operatingSeriaUnique + '")'), _drillthroughMenu.Items.add(b));
                                menuManager.CreateMenu(_drillthroughMenu, 232)
                            } else b = new MenuItem, b.Title = $kyu.lng("__drillthrough"), b.Enabled = !1, _drillMenu.Items.add(b); f || (b = new MenuItem, b.Separator = !0, _drillMenu.Items.add(b), b = new MenuItem, b.Title = $kyu.lng("_selectChartType"), b.SubMenu = "menuManager.ShowMenu(_chartsMenu, _drillMenu, null, event);setTimeout( continueMenuHiding, 200 );", _drillMenu.Items.add(b)); menuManager.CreateMenu(_drillMenu, 218); menuManager.ShowMenu(_drillMenu, null, null, e); setTimeout(continueMenuHiding, 230);
                        $kyu.createChartsMenu()
                    }
                }
            }))
} var dashContextAction = 1, dimensionsMenu = null;
function EnsureDimensions(a, b, d) {
    d = d || window.event; clickedElement = null; d && (clickedElement = d.target || d.srcElement); menuManager.RemoveMenu("Dimensions"); dimensionsMenu = null; b = "{'dataSourceID':" + a + ",'measure':" + $kyu.checkNull(b) + ",'token':" + $kyu.checkNull($kyu.token) + "}"; b = b.replace(/'/g, '"'); b = JSON.parse(b); $.ajax({
        crossDomain: !0, type: "GET", contentType: "application/json; charset=utf-8", url: $kyu.config.URL + "/WebServices/DataService.asmx/GetDimensionsByMeasureAtomicP", data: b, dataType: "jsonp", success: function (b) {
            $kyu.diagnoseResponse(b.d) &&
                defineDimensionMenu(b.d, a, d)
        }
    })
}
function defineDimensionMenu(a, b, d) {
    dimensionsMenu = new ContextMenu; dimensionsMenu.Title = "Dimensions"; dimensionsMenu.OperatingMember = _operatingMemberUnique; for (var e = a.split(";"), f = 0; f < e.length - 1; f++)if (-1 < e[f].indexOf("#")) { var g = e[f].split("#"), a = new MenuItem; a.Title = g[0]; a.Icon = $kyu.config.URL + "/images/dimension16.gif"; a.SubMenu = "EnsureHierarchyMenu(event, " + b + ",'" + g[1] + "');"; dimensionsMenu.Items.add(a) } dimensionsContainer = menuManager.CreateMenu(dimensionsMenu, 225); 1 == dashContextAction ? menuManager.ShowMenu(dimensionsMenu,
        _drillMenu, null, d) : menuManager.ShowMenu(dimensionsMenu, OLAPDataSourcesMenu, null, d); setTimeout(continueMenuHiding, 230)
}
function EnsureHierarchyMenu(a, b, d) {
    var a = a || window.event, e = a.target || a.srcElement; clickedElement = null; clickedElement = e; e = menuManager.GetMenuByTitle(d + "Menu"); null == e ? (hierarchyMenuTitle = d + "Menu", d = "{'dataSourceID':" + b + ",'dimensionUnique':" + $kyu.checkNull(d) + "}", d = d.replace(/'/g, '"'), d = JSON.parse(d), $.ajax({
        crossDomain: !0, type: "GET", contentType: "application/json; charset=utf-8", url: $kyu.config.URL + "/WebServices/DataService.asmx/GetDimensionHierarchiesAtomicP", data: d, dataType: "jsonp", success: function (d) {
            $kyu.diagnoseResponse(d) &&
                defineHierarchyMenu(d, b, a)
        }
    })) : (menuManager.ShowMenu(e, dimensionsMenu, clickedElement), setTimeout(continueMenuHiding, 230))
} var hierarchyMenuTitle;
function defineHierarchyMenu(a, b) {
    var d = new ContextMenu; d.Title = hierarchyMenuTitle; for (var e, f = a.split(";"), g = 0; g < f.length - 1; g++) {
        if (-1 < f[g].indexOf("#")) {
            var i = f[g].split("#"); e = new MenuItem; e.Title = i[0]; e.Icon = "1" == i[2] ? $kyu.config.URL + "/images/userHierarchy.gif" : $kyu.config.URL + "/images/hierarchy.gif"; e.ActionURL = 1 == dashContextAction ? 'javascript:$kyu.HideMenu();tileDrillBy("' + i[1] + '.children")' : "javascript:$kyu.HideMenu();addOLAPDashFilter(" + b + ',"' + i[0] + '","' + i[1] + '");ShowMembersSelection(' + b +
                ',"' + i[1] + '")'
        } else e = new MenuItem, e.Separator = !0; d.Items.add(e)
    } menuManager.CreateMenu(d, 240); menuManager.ShowMenu(d, dimensionsMenu, clickedElement); setTimeout(continueMenuHiding, 230)
}
function tileDrillBy(a, b) {
    var b = $kyu.unescapeJsonChars(b), d = $(_operatingTile).data("additionalfilter"), e = $(_operatingTile).data("opt_pivottile"), f = null, g = null; d ? $(_operatingTile).data("additionalfilter", d + "!,!" + _operatingMemberUnique) : ($(_operatingTile).data("additionalfilter", _operatingMemberUnique + (_operatingSeriaUnique && 0 != _operatingSeriaUnique.indexOf("[Measures]") ? "!,!" + _operatingSeriaUnique : "")), g = $(_operatingTile).data("presentationtype")); if ("Geo_Map" == $(_operatingTile).data("presentationtype")) {
        $(_operatingTile).find(".renderSurface").css("margin-top",
            "0px"); var f = $(_operatingTile).data("geomap"), i = $kyu.getAvailableDrillDownMapName(b, f); i ? $(_operatingTile).data("geomap", i) : $(_operatingTile).data("presentationtype", "Pie_Chart")
    } _operatingSeriaUnique = null; (i = $(_operatingTile).data("additionalcategory")) ? $(_operatingTile).data("additionalcategory", i + "!,!" + a) : $(_operatingTile).data("additionalcategory", a); 1 == $(_operatingTile).data("opt_pivottile") && $(_operatingTile).data("opt_pivottile", "2"); $kyu.renderTile(_operatingTile); $(_operatingTile).find(".undoAdditional").show();
    $("#undoAnalysisLargeTile").show(); 0 == $(_operatingTile).find(".undoAdditional").length && $(_operatingTile).find(".tileToolbar").append("<a class='undoAdditional' style='float:right;padding-right:10px' href='javascript:undoAdditionalAnalysis(\"" + $(_operatingTile).attr("id") + "\")'><img class='iconAnalysis' src='" + $kyu.config.URL + "/images/undo-16.png' border='0' style='align:top' title='" + $kyu.lng("__undoAnalysisAction") + "'/></a>"); var h = []; $(_operatingTile).data("steps") && (h = JSON.parse($(_operatingTile).data("steps")));
    h.push({ category: i ? i : null, filters: d ? d : null, geoMap: f, pivot: e, presentationType: g }); $(_operatingTile).data("steps", JSON.stringify(h))
} function changeTileChartType(a) { $(_operatingTile).data("presentationtype", a); a = { chartType: a }; $kyu.loadScript($(_operatingTile).parent().attr("id"), a, $kyu.changeChartTypeLoaded) } $kyu.changeChartTypeLoaded = function () { $kyu.renderAgainSingle(_operatingTile) };
function undoAdditionalAnalysis(a) { var a = $("#" + a), b = a.data("steps"); if (b) { b = JSON.parse(b); if (0 < b.length) { var d = b.pop(); a.data("additionalfilter", d.filters); a.data("additionalcategory", d.category); a.data("opt_pivottile", d.pivot); d.presentationType && a.data("presentationtype", d.presentationType); d.geoMap && a.data("geomap", d.geoMap); $kyu.renderTile(a[0]); a.data("steps", JSON.stringify(b)) } 0 == b.length && (a.find(".undoAdditional").hide(), $("#undoAnalysisLargeTile").hide()) } }
function execDrillthrough(a, b, d, e) {
    var f = $(_operatingTile).data("additionalfilter"); "" == _operatingSeriaUnique && (_operatingSeriaUnique = null); f = f ? f + "!,!" + _operatingMemberUnique : _operatingMemberUnique + (null != _operatingSeriaUnique ? "!,!" + _operatingSeriaUnique : ""); _operatingSeriaUnique = null; $("#GenericPopupHeader").html($kyu.lng("__drilltResults") + "..."); $("#btnDecompDrillthroughExcel").data("drillthroughName", a); $("#btnDecompDrillthroughExcel").data("drillthroughID", b); $("#btnDecompDrillthroughExcel").data("memberUnique",
        d); $("#btnDecompDrillthroughExcel").data("seriaUnique", e); $("#btnDecompDrillthroughExcel").show(); $kyu.renderDrillthrough(); -1 < d.indexOf("@@") || $("#btnDecompDrillthroughExcel").show(); $kyu.showProgress("GenericPopupContent"); a = "{'analysisID':" + $kyu.checkNull($(_operatingTile).data("multivalueanalysisid")) + ",'drillthroughName':'" + a + "','drillthroughID':'" + b + "','additionalFilter':" + $kyu.checkNull(f) + ",'token':" + $kyu.checkNull($kyu.token) + "}"; a = a.replace(/'/g, '"'); a = JSON.parse(a); $.ajax({
            crossDomain: !0,
            type: "GET", contentType: "application/json; charset=utf-8", url: $kyu.config.URL + "/WebServices/Query.asmx/ExecuteDrillthroughP", data: a, dataType: "jsonp", success: function (a) { $kyu.hideProgress("GenericPopupContent"); $kyu.diagnoseResponse(a) && ($("#GenericPopupContent").html(a), $("#GenericPopupContent").append("<br/></br><span style='padding-left:10px'>" + $kyu.lng("__resultsCount") + ": " + ($("#GenericPopupContent").find("TR").length - 1) + "</span>"), $("#kyubitDialogShadow").show()) }
        })
}
$kyu.renderDrillthrough = function () { $("#kyubitDialogShadow").width($(window).width()); $("#kyubitDialogShadow").height($(window).height()); $("#kyubitDialogShadow").show(); var a = $(window).height() - 100; $("#GenericPopupContent").height(a - 100); $("#GenericPopupDiv").height(a); $kyu.ShowCenterFixed("GenericPopupDiv") }; $kyu.hideGenericPopup = function () { $("#GenericPopupDiv").hide(); $("#kyubitDialogShadow").hide() };
function DrillthroughToExcel() {
    var a = $("#btnDecompDrillthroughExcel").data("drillthroughName"), b = $("#btnDecompDrillthroughExcel").data("drillthroughID"), d = $(_operatingTile).data("additionalfilter"); "" == _operatingSeriaUnique && (_operatingSeriaUnique = null); d = d ? d + "!,!" + _operatingMemberUnique : _operatingMemberUnique + (null != _operatingSeriaUnique ? "!,!" + _operatingSeriaUnique : ""); a = "?FromDashboard=1&analysisID=" + $(_operatingTile).data("multivalueanalysisid") + "&drillthroughName=" + encodeURIComponent(a) + "&drillthroughID=" +
        b + "&additionalFilter=" + encodeURIComponent(d); window.location.href = $kyu.config.URL + "/Forms/ExecuteDrillthrough.aspx" + a
} $kyu.showLargeTile = function (a) { a = $(a).closest(".tile"); $kyu.renderLargeTile(a) };
$kyu.renderLargeTile = function (a, b) {
    $kyu.HideMenu(); $("#kyubitDialogShadow").width($(window).width()); $("#kyubitDialogShadow").height($(window).height()); var d = $(window).width() - 400, e = $(window).height() - 200, d = 400 > d ? 400 : d, e = 265 > e ? 265 : e; $("#LargeTileDiv").width(d); $("#LargeTileDiv").height(e); $("#renderSurfaceLarge").empty(); $("#renderSurfaceLarge").css("overflow", "hidden"); $("#renderSurfaceLarge").width(d - 40); a && ("KPI" == a.data("presentationtype") || "CardSmall" == a.data("presentationtype") ? $("#renderSurfaceLarge").height(200) :
        $("#renderSurfaceLarge").height(e - 50), "KPI" == a.data("presentationtype") || "CardSmall" == a.data("presentationtype") || "Card" == a.data("presentationtype") || "Scorecard" == a.data("presentationtype") || "Gauge" == a.data("presentationtype") ? $("#btnExcelLargeTile").hide() : $("#btnExcelLargeTile").show(), "Table" == a.data("presentationtype") ? ($("#chkExportExcelChart").attr("checked", !1), $("#trIncludeChartExcel").hide()) : $("#trIncludeChartExcel").show(), $("#LargeTileHeader").html($(a).find(".tileTitle").html()), $(a).data("tiledesc") &&
            "" != $(a).data("tiledesc") ? ($("#LargeTileDesc").html($(a).data("tiledesc")), $("#LargeTileDesc").show()) : $("#LargeTileDesc").hide()); $kyu.ShowCenterFixed("LargeTileDiv"); $("#kyubitDialogShadow").show(); largeTileMode = !0; b ? $kyu.renderAgainSingle($("#LargeChartTile")[0]) : ($kyu.showProgress("renderSurfaceLarge"), $("#undoAnalysisLargeTile").hide(), $("#LargeChartTile").show(), $("#LargeChartTile").data("tileid", ""), $("#LargeChartTile").data("multivalueanalysisid", ""), $("#LargeChartTile").data("multivaluequeryid",
                ""), $("#LargeChartTile").data("multivalueanalysisname", ""), $("#LargeChartTile").data("multivaluequeryname", ""), $("#LargeChartTile").data("multivaluedrillthroughid", ""), $("#LargeChartTile").data("presentationtype", ""), $("#LargeChartTile").data("geomap", ""), $("#LargeChartTile").data("kpiid", ""), $("#LargeChartTile").data("customurl", ""), $("#LargeChartTile").data("tilerefresh", ""), $("#LargeChartTile").data("showlastrefresh", ""), $("#LargeChartTile").data("additionalfilter", ""), $("#LargeChartTile").data("additionalcategory",
                    ""), $("#LargeChartTile").data("originalpresentationtype", ""), $("#LargeChartTile").data("inputparameters", ""), $("#LargeChartTile").data("specificmeasureunique", ""), $("#LargeChartTile").data("analysistype", ""), $("#LargeChartTile").data("opt_ymin", ""), $("#LargeChartTile").data("opt_ymax", ""), $("#LargeChartTile").data("opt_excludeforfiltering", ""), $("#LargeChartTile").data("opt_databar", ""), $("#LargeChartTile").data("opt_colwidth", ""), $("#LargeChartTile").data("opt_rowheight", ""), $("#LargeChartTile").data("opt_fontsize",
                        ""), $("#LargeChartTile").data("opt_grid", ""), $("#LargeChartTile").data("opt_allowanalytics", "0"), $("#LargeChartTile").data("opt_secondaryqueryanalysisid", ""), $("#LargeChartTile").data("opt_secondaryqueryanalysisname", ""), $("#LargeChartTile").data("opt_markersqueryanalysisid", ""), $("#LargeChartTile").data("opt_markersmeasurecolor", ""), $("#LargeChartTile").data("opt_markersmeasureradius", ""), $("#LargeChartTile").data("opt_markerscolor1", ""), $("#LargeChartTile").data("opt_markerscolor2", ""), $("#LargeChartTile").data("opt_markersradius1",
                            ""), $("#LargeChartTile").data("opt_markersradius2", ""), $("#LargeChartTile").data("opt_legendcolors", ""), $("#LargeChartTile").data("opt_legendradius", ""), $("#LargeChartTile").data("opt_primarychart", ""), $("#LargeChartTile").data("opt_secondarychart", ""), $("#LargeChartTile").data("opt_deltachart", "0"), $("#LargeChartTile").data("opt_separateaxis", ""), $("#LargeChartTile").data("opt_displayvalues", ""), $("#LargeChartTile").data("opt_displayvaluesfilternames", ""), $("#LargeChartTile").data("opt_displayvaluesfilterseries",
                                ""), $("#LargeChartTile").data("opt_specificcategories", ""), $("#LargeChartTile").data("opt_specificseries", ""), $("#LargeChartTile").data("opt_legend", "Top"), $("#LargeChartTile").data("opt_colorpallete", 0), $("#LargeChartTile").data("opt_pivottile", 0), $("#LargeChartTile").data("opt_hidefill", 0), $("#LargeChartTile").data("opt_averageline", ""), $("#LargeChartTile").data("opt_trendline", ""), $("#LargeChartTile").data("opt_minichart", "None"), $("#LargeChartTile").data("opt_categoryaggregate", "None"), $("#LargeChartTile").data("opt_seriesaggregate",
                                    "None"), $("#LargeChartTile").data("opt_colormeter", null), $("#LargeChartTile").data("opt_gaugelastchange", null), $("#LargeChartTile").data("opt_gaugekpi", null), $("#LargeChartTile").data("opt_gaugepointer", null), $("#LargeChartTile").data("opt_animlast", null), $("#LargeChartTile").data("opt_usesecondseries", null), $("#LargeChartTile").data("opt_color1", null), $("#LargeChartTile").data("opt_color2", null), $("#LargeChartTile").data("opt_formatting", null), $("#LargeChartTile").data("sortcolumn", null), $("#LargeChartTile").data("sortorder",
                                        null), $("#LargeChartTile").data("sortseries", null), $("#LargeChartTile").data("sortseriesorder", null), $("#LargeChartTile").data("top", null), $("#LargeChartTile").data("opt_axistitles", 0), $("#LargeChartTile").data("opt_dominantseries", 0), $("#LargeChartTile").data("datasourceid", null), $("#LargeChartTile").data("opt_filterconfig", null), $("#LargeChartTile").data("opt_peekcat", null), $("#LargeChartTile").data("opt_peekcattitle", null), $("#LargeChartTile").data("opt_peekchart", null), $("#LargeChartTile").data("opt_selectcolumns",
                                            0), $("#LargeChartTile").data("opt_target", 0), $("#LargeChartTile").data("opt_product", null), $("#LargeChartTile").data("opt_targetperc", 0), $("#LargeChartTile").data("opt_trend", 0), $("#LargeChartTile").data("opt_kpivs", 0), $("#LargeChartTile").data("opt_tilecache", null), $("#LargeChartTile").data("opt_tension", null), $("#LargeChartTile").data("opt_rangecolors", null), $("#LargeChartTile").data("tileid", a.data("tileid")), $("#LargeChartTile").data("multivalueanalysisid", a.data("multivalueanalysisid")), $("#LargeChartTile").data("multivalueanalysisname",
                                                a.data("multivalueanalysisname")), $("#LargeChartTile").data("multivaluequeryid", a.data("multivaluequeryid")), $("#LargeChartTile").data("multivaluequeryname", a.data("multivaluequeryname")), $("#LargeChartTile").data("multivaluedrillthroughid", a.data("multivaluedrillthroughid")), $("#LargeChartTile").data("presentationtype", a.data("presentationtype")), $("#LargeChartTile").data("geomap", a.data("geomap")), $("#LargeChartTile").data("kpiid", a.data("kpiid")), $("#LargeChartTile").data("customurl", a.data("customurl")),
                $("#LargeChartTile").data("tilerefresh", a.data("tilerefresh")), $("#LargeChartTile").data("showlastrefresh", a.data("showlastrefresh")), $("#LargeChartTile").data("additionalfilter", a.data("additionalfilter")), $("#LargeChartTile").data("additionalcategory", a.data("additionalcategory")), $("#LargeChartTile").data("inputparameters", a.data("inputparameters")), $("#LargeChartTile").data("specificmeasureunique", a.data("specificmeasureunique")), $("#LargeChartTile").data("analysistype", a.data("analysistype")),
                $("#LargeChartTile").data("opt_ymin", a.data("opt_ymin")), $("#LargeChartTile").data("opt_ymax", a.data("opt_ymax")), $("#LargeChartTile").data("opt_excludeforfiltering", a.data("opt_excludeforfiltering")), $("#LargeChartTile").data("opt_databar", a.data("opt_databar")), $("#LargeChartTile").data("opt_colwidth", a.data("opt_colwidth")), $("#LargeChartTile").data("opt_rowheight", a.data("opt_rowheight")), $("#LargeChartTile").data("opt_fontsize", a.data("opt_fontsize")), $("#LargeChartTile").data("opt_grid", a.data("opt_grid")),
                $("#LargeChartTile").data("opt_allowanalytics", a.data("opt_allowanalytics")), $("#LargeChartTile").data("opt_secondaryqueryanalysisid", a.data("opt_secondaryqueryanalysisid")), $("#LargeChartTile").data("opt_secondaryqueryanalysisname", a.data("opt_secondaryqueryanalysisname")), $("#LargeChartTile").data("additionalfiltercompare", a.data("additionalfiltercompare")), $("#LargeChartTile").data("opt_markersqueryanalysisid", a.data("opt_markersqueryanalysisid")), $("#LargeChartTile").data("opt_markersmeasurecolor",
                    a.data("opt_markersmeasurecolor")), $("#LargeChartTile").data("opt_markersmeasureradius", a.data("opt_markersmeasureradius")), $("#LargeChartTile").data("opt_markerscolor1", a.data("opt_markerscolor1")), $("#LargeChartTile").data("opt_markerscolor2", a.data("opt_markerscolor2")), $("#LargeChartTile").data("opt_markersradius1", a.data("opt_markersradius1")), $("#LargeChartTile").data("opt_markersradius2", a.data("opt_markersradius2")), $("#LargeChartTile").data("opt_legendcolors", a.data("opt_legendcolors")),
                $("#LargeChartTile").data("opt_legendradius", a.data("opt_legendradius")), $("#LargeChartTile").data("opt_primarychart", a.data("opt_primarychart")), $("#LargeChartTile").data("opt_secondarychart", a.data("opt_secondarychart")), $("#LargeChartTile").data("opt_deltachart", a.data("opt_deltachart")), $("#LargeChartTile").data("opt_separateaxis", a.data("opt_separateaxis")), $("#LargeChartTile").data("opt_displayvalues", a.data("opt_displayvalues")), $("#LargeChartTile").data("opt_displayvaluesfilternames", a.data("opt_displayvaluesfilternames")),
                $("#LargeChartTile").data("opt_displayvaluesfilterseries", a.data("opt_displayvaluesfilterseries")), $("#LargeChartTile").data("opt_specificcategories", a.data("opt_specificcategories")), $("#LargeChartTile").data("opt_specificseries", a.data("opt_specificseries")), $("#LargeChartTile").data("opt_legend", a.data("opt_legend")), $("#LargeChartTile").data("opt_colorpallete", a.data("opt_colorpallete")), $("#LargeChartTile").data("opt_pivottile", a.data("opt_pivottile")), $("#LargeChartTile").data("opt_axistitles",
                    a.data("opt_axistitles")), $("#LargeChartTile").data("opt_dominantseries", a.data("opt_dominantseries")), $("#LargeChartTile").data("opt_averageline", a.data("opt_averageline")), $("#LargeChartTile").data("opt_trendline", a.data("opt_trendline")), $("#LargeChartTile").data("opt_minichart", a.data("opt_minichart")), $("#LargeChartTile").data("opt_categoryaggregate", a.data("opt_categoryaggregate")), $("#LargeChartTile").data("opt_seriesaggregate", a.data("opt_seriesaggregate")), $("#LargeChartTile").data("opt_colormeter",
                        a.data("opt_colormeter")), $("#LargeChartTile").data("opt_gaugelastchange", a.data("opt_gaugelastchange")), $("#LargeChartTile").data("opt_gaugekpi", a.data("opt_gaugekpi")), $("#LargeChartTile").data("opt_gaugepointer", a.data("opt_gaugepointer")), $("#LargeChartTile").data("opt_usesecondseries", a.data("opt_usesecondseries")), $("#LargeChartTile").data("opt_animlast", a.data("opt_animlast")), $("#LargeChartTile").data("opt_color1", a.data("opt_color1")), $("#LargeChartTile").data("opt_color2", a.data("opt_color2")),
                $("#LargeChartTile").data("sortcolumn", a.data("sortcolumn")), $("#LargeChartTile").data("sortorder", a.data("sortorder")), $("#LargeChartTile").data("sortseries", a.data("sortseries")), $("#LargeChartTile").data("sortseriesorder", a.data("sortseriesorder")), $("#LargeChartTile").data("top", a.data("top")), $("#LargeChartTile").data("opt_formatting", a.data("opt_formatting")), $("#LargeChartTile").data("datasourceid", a.data("datasourceid")), $("#LargeChartTile").data("opt_filterconfig", a.data("opt_filterconfig")),
                $("#LargeChartTile").data("opt_peekcat", a.data("opt_peekcat")), $("#LargeChartTile").data("opt_peekcattitle", a.data("opt_peekcattitle")), $("#LargeChartTile").data("opt_peekchart", a.data("opt_peekchart")), $("#LargeChartTile").data("opt_hidefill", a.data("opt_hidefill")), $("#LargeChartTile").data("opt_selectcolumns", a.data("opt_selectcolumns")), $("#LargeChartTile").data("opt_target", a.data("opt_target")), $("#LargeChartTile").data("opt_product", a.data("opt_product")), $("#LargeChartTile").data("opt_targetperc",
                    a.data("opt_targetperc")), $("#LargeChartTile").data("opt_trend", a.data("opt_trend")), $("#LargeChartTile").data("opt_kpivs", a.data("opt_kpivs")), $("#LargeChartTile").data("opt_tilecache", a.data("opt_tilecache")), $("#LargeChartTile").data("opt_tension", a.data("opt_tension")), $("#LargeChartTile").data("opt_rangecolors", a.data("opt_rangecolors")), null != $("#LargeChartTile").data("multivalueanalysisid") && "" != $("#LargeChartTile").data("multivalueanalysisid") ? $("#btnContinueAnalysis").show() : $("#btnContinueAnalysis").hide(),
                !1 == $kyu.globalConfig.continueAnalysis && $("#btnContinueAnalysis").hide(), !1 == $kyu.globalConfig.excelExport && $("#btnExcelLargeTile").hide(), $kyu.renderTile($("#LargeChartTile")[0], null, $kyu.afterLargeTileRender), $("#KyubitDashboardTable").addClass("no-print"), $("#dashFilterPanel").addClass("no-print"))
}; $kyu.afterLargeTileRender = function () { $kyu.ShowCenterFixed("LargeTileDiv") };
function hideLargeTile() { largeTileMode = !1; $("#kyubitDialogShadow").hide(); $("#LargeTileDiv").hide(); $("#KyubitDashboardTable").removeClass("no-print"); $("#dashFilterPanel").removeClass("no-print") }
function selectDashPDFExportButton(a) { 1 == a ? ($("#btnDashReportPDFDetailed").removeClass("optionSelected"), $("#btnDashReportPDFSimple").addClass("optionSelected"), localStorage.pdfExportOption = "simple") : ($("#btnDashReportPDFDetailed").addClass("optionSelected"), $("#btnDashReportPDFSimple").removeClass("optionSelected"), localStorage.pdfExportOption = "detailed") }
$kyu.startDragAround = function (a, b) { $(b).hasClass("DragHolder") && ($kyu.dragOperation = null, $kyu.dragAroundElement = $(b).parent().parent().parent().parent()[0], $kyu.dragAroundLeft = a.clientX - $($kyu.dragAroundElement).position().left, $kyu.dragAroundTop = a.clientY - $($kyu.dragAroundElement).position().top) }; function openSpreedsheet() { prepareTileAsExcel() }
function prepareTileAsExcel() { $kyu.prepareAnyTileImageData($("#LargeChartTile").attr("id"), "renderSurfaceLarge", $("#LargeChartTile").data("presentationtype"), openTileAsExcel) }
function openTileAsExcel(a) {
    $("#KyubitImageData").val(a); a = $kyu.getChartStage("renderSurfaceLarge"); a = Array.isArray(a.data) ? $kyu.consolidateTreeData(a.data) : a.data; $("#KyubitTitle").val(a.categoryName); $("#KyubitExportDescription").val($("#LargeTileDesc").html()); $("#KyubitDataSourceName").val(a.dataSourceName); $("#KyubitMeasureNames").val(a.measureNames); $("#KyubitCategoryName").val(a.categoryName); $("#KyubitSeriesName").val(a.seriesName ? a.seriesName : ""); $("#KyubitFilters").val(""); var b = !1, d = JSON.stringify(a.points),
        d = JSON.parse(d); a.OLAP || $.each(d, function (a, d) { $.each(d.pointVal, function (a, d) { if (isNaN(d)) return b = !0, !1 }) }); b ? alert("Not all numbers are numeric!") : ($("#KyubitDataValues").val(JSON.stringify(a.categoryName) + "@@@" + JSON.stringify(a.series) + "@@@" + JSON.stringify(d)), $("#KyubitExportForm").attr("action", $kyu.config.URL + "/Forms/ExcelTableReport.aspx"), $("#KyubitExportForm").submit())
}
$kyu.openTileAsPDF = function () { $.ajax({ type: "POST", contentType: "application/json; charset=utf-8", url: $kyu.config.URL + "/WebServices/DashboardPDFService.asmx/GetGUID", data: "{}", dataType: "json", success: function (a) { diagnoseResponse(a.d) && ($kyu.prepareImageSetGUID = a.d, 0 < $("#renderSurfaceLarge .DashHTMLTable").length || 0 < $("#renderSurfaceLarge .dashTable").length ? (a = $("#LargeChartTile")[0], $kyu.submitTileForPDF(a)) : $kyu.prepareLargeTileImageData()) } }) };
$kyu.prepareLargeTileImageData = function () { var a = $("#LargeChartTile")[0], b = $("#LargeTileHeader").html(), d = $(a).find(".renderSurface"); if ("Geo_Map" == $(a).data("presentationtype")) $kyu.prepareGeoMapImageData($(d).attr("id"), $kyu.prepareImageSetGUID, 0, 0, b); else if ("Table" != $(a).data("presentationtype")) $kyu.prepareChartImageData($(d).attr("id"), $kyu.prepareImageSetGUID, 0, 0, b); else { $kyu.submitTileForPDF(a); return } setTimeout(function () { $kyu.submitTileForPDF(a) }, 4E3) };
function CCollection() { var a = 0; this.add = function (b) { null != b && (a++, this[a - 1] = b) }; this.remove = function (b) { if (!(0 > b || b > this.length - 1)) { for (this[b] = null; b <= a; b++)this[b] = this[b + 1]; a-- } }; this.isEmpty = function () { return 0 == a }; this.size = function () { return a }; this.clear = function () { for (var b = 0; b < a; b++)this[b] = null; a = 0 }; this.clone = function () { for (var b = new CCollection, d = 0; d < a; d++)b.add(this[d]); return b } }
var menuManager = new MenuManager, cMenu = new ContextMenu, measureMenu = new ContextMenu, gridMenu = new ContextMenu, cellMenu = new ContextMenu, gridMeasureGroupsMenu = new ContextMenu, drillthroughMenu = new ContextMenu, container, subMenu1 = new ContextMenu, mobileDimensionsMenu = null, mobileMeasuresMenu = null, subContainer1, h1 = 22, h2 = 18;
function CCollection() { var a = 0; this.add = function (b) { null != b && (a++, this[a - 1] = b) }; this.remove = function (b) { if (!(0 > b || b > this.length - 1)) { for (this[b] = null; b <= a; b++)this[b] = this[b + 1]; a-- } }; this.isEmpty = function () { return 0 == a }; this.size = function () { return a }; this.clear = function () { for (var b = 0; b < a; b++)this[b] = null; a = 0 }; this.clone = function () { for (var b = new CCollection, d = 0; d < a; d++)b.add(this[d]); return b } }
function MenuManager() {
    function a() { for (var a = 0; a < this.VisibleMenus.size(); a++)this.VisibleMenus[a].Hide(); this.VisibleMenus.clear() } var b = new CCollection, d = new CCollection; this.Menus = b; this.VisibleMenus = d; this.CreateMenu = function (a, b, d) {
        var i = document.createElement("DIV"); $(i).bind("contextmenu", function () { return !1 }); i.style.display = "none"; i.className = "contextMenuDiv"; null != b && (i.style.zIndex = b); document.body.appendChild(i); a.Container = i; this.Menus.add(a); for (var b = "<table border='0' cellpadding='0' cellspacing='0' style='margin:2px;border-width:0px'>",
            h = 0; h < a.Items.size(); h++) {
            var j = a.Items[h]; j.Separator ? (b += "<tr height='3px'><td style='line-height:3px;' nowrap align='center' ></td>", b = "Large" == d ? b + ("<td style='line-height:3px;'  align='right'><img src='" + $kyu.config.URL + "/Images/ContextMenu/SeparatorLineLarge.gif' border='0' style='vertical-align:middle'></td></tr>") : b + ("<td style='line-height:3px;'  align='right'><img src='" + $kyu.config.URL + "/Images/ContextMenu/SeparatorLine.gif' border='0' style='vertical-align:middle'></td></tr>")) : null !=
                j.SubMenu ? (b += "<tr onmouseover='itemMouseOver(this)' onmouseout='itemMouseOut(this);'  onmousedown=\"$kyu.SelectSubMenu(this,'" + a.Title + "');suppresMenuHiding(event);" + j.SubMenu + '"', b = "" != j.Description ? b + (" title='" + j.Description + "'>") : b + ">", b += "<td style='width:22px;vertical-align:middle;' class='contextMenuRowLeft' nowrap align='center'>", b += "&nbsp;", b += "</td><td style='width:250px;vertical-align:middle' class='contextMenuRowRight'><table style='width:100%;height:100%' cellpadding='0' border='0' ><tr><td class='OpenSubmenu' style='width:100%;height:100%; text-decoration:none; padding-left:5px;cursor:hand;font-family:" +
                    $kyu.dashboardFont + ";font-size:" + $kyu.fontSize + ";color:" + $kyu.fontColor + "' >" + j.Title + "</td><td style='width:16px;'><img src='" + $kyu.config.URL + "/images/menuArrow2.gif' border='0' align='bottom' /></td></tr></table></td></tr>") : (b += "<tr  onmouseover='itemMouseOver(this);' onmouseout='itemMouseOut(this);'  onmouseup='" + j.ActionURL + ";suppresMenuHiding(event);'", j.Enabled || (b += " disabled='True'"), d && (b += " data-itemstyle='" + d + "'"), b = "" != j.Description ? b + (" title='" + j.Description + "'>") : b + ">", b = "Large" ==
                        d ? b + "<td style='min-width:40px; height:40px;line-height:40px;vertical-align:middle;font-size:14px;' " : b + "<td style='min-width:22px;vertical-align:middle;' class='contextMenuRowLeft'", b += " nowrap align='center' >", b = "" != j.Icon ? b + ("<img src='" + j.Icon + "' border='0' style='vertical-align:middle;margin-bottom:2px' />") : b + "&nbsp;", "Large" == d ? (b += "</td><td style='width:230px;vertical-align:middle' ><table style='width:100%;height:100%'><tr>", b += "<td style='width:100%;height:100%; text-decoration:none; padding-left:5px;cursor:hand;" +
                            (!j.Enabled ? "color:gray" : "") + "' >" + j.Title + "</td>") : (b += "</td><td style='width:250px;vertical-align:middle' class='contextMenuRowRight'><table style='width:100%;height:100%'><tr>", b += "<td class='OpenItem' style='width:100%;height:100%; text-decoration:none; padding-left:5px;font-family:" + $kyu.dashboardFont + ";font-size:" + $kyu.fontSize + ";color:" + $kyu.fontColor + ";cursor:hand;" + (!j.Enabled ? "color:gray" : "") + "' >" + j.Title + "</td>"), b += "</tr></table></td></tr>")
        } i.innerHTML = b + "</table>"; return i
    }; this.HideAllMenus =
        a; this.ShowMenu = function (a, b, d, i) {
            var i = i || window.event, h = null; i && (h = i.target || i.srcElement); suppresMenuHiding(i); if (a && "" != a.Container.style) {
                var j, l = 250, k = 0, m = a.Container, p = null; DeselectSubMenu(a); null != b && (b.HideSubMenu(), b.CurrentlyVisibleSubMenu = a, a.ParentMenu = b); this.VisibleMenus.add(a); null != a.ParentMenu && (p = a.ParentMenu.Container); m.style.backgroundColor = "white"; m.style.position = "Absolute"; var b = document.body.clientWidth, n = document.body.clientHeight, s = 0; null == i && null == d ? (h = mouseX, j = mouseY) :
                    (null == d && (d = h), s = null != a.ParentMenu ? a.ParentMenu.HorizontalDock : 0, "Chart" == currentView || null != a.ParentMenu ? (h = getX(d) + 220, j = getY(d), j -= $(window).scrollTop()) : i.clientX ? (h = i.clientX, j = i.clientY) : (h = $(window).width() / 2, j = $(window).height() / 2), i.explicitClientX ? (h = i.explicitClientX, j = i.explicitClientY) : d && ($(d).parent().hasClass("SelectedSubMenu") || "IMG" == d.tagName) ? h += 22 : null == a.ParentMenu && (i.clientX ? (h = i.clientX, j = i.clientY) : "undefined" != typeof UpdateReportFilters ? (h = getX($("#btnAddFilter")[0]) +
                        100, j = 235) : "undefined" != typeof mouseX ? (h = mouseX, j = mouseY) : (h = $(window).width() / 2, j = $(window).height() / 2))); null != p && (l = 494, k = 25); 0 == s ? h + 250 > b ? ($(m).css("left", h - l), a.HorizontalDock = 1) : ($(m).css("left", h), a.HorizontalDock = 0) : 0 < h - l ? ($(m).css("left", h - l), a.HorizontalDock = 1) : ($(m).css("left", h + l), a.HorizontalDock = 0); j + $(m).height() > n ? 0 < j - $(m).height() - 1 + k ? $(m).css("top", j - $(m).height() - 1 + k) : $(m).css("top", 0) : $(m).css("top", j - 1 + $(window).scrollTop()); m.style.display = ""
            }
        }; this.GetMenuByTitle = function (a) {
            for (var b =
                0; b < this.Menus.size(); b++)if (this.Menus[b].Title == a) return this.Menus[b]; return null
        }; this.RemoveMenu = function (a) { for (var b = 0; b < this.Menus.size(); b++)if (this.Menus[b].Title == a) { this.Menus.remove(b); break } }; this.RemoveAllMenus = function () { null != this._visibleMenus && a(); null != this._menus && this._menus.clear() }
}
function ContextMenu() {
    var a = new CCollection; this.Unique = this.Title = ""; this.Items = a; this.CurrentlyVisibleSubMenu = this.Container = this.ParentMenu = null; this.Hide = function () { this.Container.style.display = "none"; this.HideSubMenu(); if (null != menuManager) for (var a = 0; a < menuManager.VisibleMenus.size(); a++)if (menuManager.VisibleMenus[a].Title == this.Title) { menuManager.VisibleMenus.remove(a); break } }; this.HideSubMenu = function () {
        null != this.CurrentlyVisibleSubMenu && (this.CurrentlyVisibleSubMenu.Hide(), this.CurrentlyVisibleSubMenu =
            null)
    }; this.HorizontalDock = 0; this.SelectedTR = void 0
} function MenuItem() { this.ActionURL = this.Icon = this.Unique = this.Title = ""; this.Separator = !1; this.Description = ""; this.SubMenu = null; this.Enabled = !0 } function itemMouseOver(a) { 2 == a.childNodes.length && "SelectedSubMenu" != a.className && HighlightRow(a) } function itemMouseOut(a) { 2 == a.childNodes.length && "SelectedSubMenu" != a.className && UnhighlightRow(a) }
function HighlightRow(a) {
    if ("Large" == $(a).data("itemstyle")) { var b = $(a.childNodes[0]).find("img"); if (0 < b.length) { var d = $(b[0]).attr("src").replace(".png", "_neg.png"); $(b[0]).attr("src", d) } } else b = $(a.childNodes[0]).find("img"), 0 < b.length && -1 < $(b[0]).attr("src").indexOf("_pos.png") && (d = $(b[0]).attr("src").replace("_pos.png", "_neg.png"), $(b[0]).attr("src", d)); $(a.childNodes[0]).css("background-image", "none"); $(a.childNodes[0]).css("background-color", $kyu.mainColor).css("border-top-left-radius", "2px").css("border-bottom-left-radius",
        "2px").css("color", "white"); $(a.childNodes[1]).css("background-color", $kyu.mainColor).css("border-top-right-radius", "2px").css("border-bottom-right-radius", "2px").css("color", "white"); $(a.childNodes[1]).find(".OpenSubmenu").css("color", "white"); $(a.childNodes[1]).find(".OpenItem").css("color", "white"); 1 < a.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes.length && (a.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[1].childNodes[0].src = $kyu.config.URL + "/images/menuArrowWhite.gif")
}
function UnhighlightRow(a) {
    if ("Large" == $(a).data("itemstyle")) { var b = $(a.childNodes[0]).find("img"); if (0 < b.length) { var d = $(b[0]).attr("src").replace("_neg", ""); $(b[0]).attr("src", d) } } else b = $(a.childNodes[0]).find("img"), 0 < b.length && -1 < $(b[0]).attr("src").indexOf("_neg.png") && (d = $(b[0]).attr("src").replace("_neg.png", "_pos.png"), $(b[0]).attr("src", d)); $(a.childNodes[0]).css("background-color", "transparent").css("color", $kyu.fontColor).css("border-top-left-radius", "0px").css("border-bottom-left-radius",
        "0px"); $(a.childNodes[1]).css("background-color", "transparent").css("color", $kyu.fontColor).css("border-top-left-radius", "0px").css("border-bottom-left-radius", "0px"); $(a.childNodes[1]).find(".OpenSubmenu").css("color", $kyu.fontColor); $(a.childNodes[1]).find(".OpenItem").css("color", $kyu.fontColor); 1 < a.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes.length && (a.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[1].childNodes[0].src = $kyu.config.URL + "/images/menuArrow2.gif")
}
function ShadowRow() { } function UnshadowRow(a) { UnhighlightRow(a) } $kyu.HideMenu = function () { menuHiding ? menuManager.HideAllMenus() : menuHiding = !0 }; function getY(a) { for (var b = 0; null != a;)b += a.offsetTop, a = a.offsetParent; return b } function getX(a) { for (var b = 0; null != a;)b += a.offsetLeft, a = a.offsetParent; return b } var menuHiding = !0; function suppresMenuHiding(a) { menuHiding = !1; if (a = a || window.event) a.stopPropagation ? a.stopPropagation() : a.cancelBubble = !0 } function continueMenuHiding() { menuHiding = !0 }
$kyu.SelectSubMenu = function (a, b) { a.className = "SelectedSubMenu"; var d = menuManager.GetMenuByTitle(b); null != d && (DeselectSubMenu(d), d.SelectedTR = a, ShadowRow(a)) }; function DeselectSubMenu(a) { null != a.SelectedTR && (UnshadowRow(a.SelectedTR), a.SelectedTR.className = "") } var treeViewMode = "selectPeekCategory";
function toggleTreeNode(a) { "0" == $(a).data("expanded") ? ($(a).data("empty") && (getCubeTreeSegment($(a).data("empty"), $(a).parent().next()), $(a).data("empty", null)), $(a).data("expanded", "1"), $(a).attr("src", $kyu.config.URL + "/Images/minus.gif"), $(a).parent().next().show()) : ($(a).data("expanded", "0"), $(a).attr("src", $kyu.config.URL + "/Images/plus.gif"), $(a).parent().next().hide()) }
function selectTreeNode(a, b) {
    hideCubeStructurePicker(); if ("selectPeekCategory" == treeViewMode) openPeekAnalysis($(a).data("id"), null, currentColumnPosition, currentRowPosition, currentMeasureTitle, currentCellValue); else if ("selectPeekSeries" == treeViewMode) openPeekAnalysis(null, $(a).data("id"), currentColumnPosition, currentRowPosition, currentMeasureTitle, currentCellValue); else if ("chartView" == treeViewMode) hierarchyContextAction($(a).data("caption"), $(a).data("id")); else if ("dashboard" == treeViewMode || "Drill" ==
        treeViewMode) 1 == dashContextAction ? 4 == b ? tileDrillBy($(a).data("id")) : tileDrillBy(extractHierarchy($(a).data("id")) + ".children") : (addOLAPDashFilter($("#cubeStructurePickerCell").data("datasourceid"), $(a).data("caption"), extractHierarchy($(a).data("id"))), ShowMembersSelection($("#cubeStructurePickerCell").data("datasourceid"), extractHierarchy($(a).data("id")))); else if ("drillAnalyticTree" == treeViewMode) {
            var d; d = extractHierarchy($(a).data("id")); _operatingStage.data[0].OLAP.ModelID ? $kyu.addNewDrillLevel(_operatingStage,
                _operatingWedge, d) : $kyu.addNewDrillLevel(_operatingStage, _operatingWedge, d + ".children")
        } else if ("drillAnalyticTreeTable" == treeViewMode) { d = 4 == b ? $(a).data("id") : extractHierarchy($(a).data("id")); var e = $(a).data("caption"); $kyu.addTableAnalyticsLevel(_operatingStage, d, e) } else "decompositionMeasure" == treeViewMode ? (dtMeasureUnique = $(a).data("id"), $("#measureTitle").html("<img src='../images/userMeasure.png' border='0' style='vertical-align:middle;margin:-2px 4px 0px 0px'/>" + $(a).data("caption") + "<a class='dAction' href='javascript:void(0)'  onclick='selectMeasure()' style='margin-left:20px;font-size:12px'>" +
            lng("__edit") + "</a></div>"), decompMeasureSelected($(a).data("caption"))) : "decompositionFilters" == treeViewMode ? (addDecompOLAPDashFilter($("#cubeStructurePickerCell").data("datasourceid"), $(a).data("caption"), extractHierarchy($(a).data("id"))), ShowMembersSelection($("#cubeStructurePickerCell").data("datasourceid"), extractHierarchy($(a).data("id")))) : "nextDecompLevel" == treeViewMode ? nextDecompLevelSelected($(a).data("id"), $(a).data("caption")) : "insertDecompLevel" == treeViewMode ? insertDecompLevelRow(extractHierarchy($(a).data("id")),
                $(a).data("caption")) : "defineDashPeekCategory" == treeViewMode ? ($kyu.designMode ? ($("#peekCat").html($(a).data("caption")), $("#peekCat").data("levelunique", $(a).data("id"))) : (d = $kyu.getChartStage($(_operatingTile).find(".renderSurface").attr("id")), d.peekCategory = $(a).data("id"), d.peekCategoryTitle = $(a).data("caption"), $(_operatingTile).data("opt_peekcat", $(a).data("id")), $(_operatingTile).data("opt_peekcattitle", $(a).data("caption"))), $("#peekChartTR").show()) : "specificMeasure" == treeViewMode ? ($("#specificMeasure").data("unique",
                    $(a).data("id")), $("#specificMeasure").html($(a).data("caption"))) : "specificMeasureKPI" == treeViewMode && ($("#specificMeasureKPI").data("unique", $(a).data("id")), $("#specificMeasureKPI").html($(a).data("id")))
}
function getCubeTreePicker(a, b, d, e) {
    e && (ANALYSIS_TYPE = e); treeViewMode = b; d ? $("#CubeStructurePickerTitle").html(d) : $("#CubeStructurePickerTitle").html($("#CubeStructurePickerTitle").data("title")); if (currentDataSourceId == $("#cubeStructurePickerCell").data("datasourceid")) ShowGlobalDialog("CubeStructurePickerDiv"); else {
        d = "Dimensions"; "decompositionMeasure" == treeViewMode && (d = "Measures"); var f = null, g = null; 100 == e ? (f = $kyu.config.URL + "/WebServices/CubeStructureAnalytics.asmx/GetPickerHTMLP", g = "{'dataSourceID':" +
            checkNull(a) + ",'structureType':'" + d + "','treeViewMode':'" + b + "','token':" + $kyu.checkNull($kyu.token) + "}") : (f = $kyu.config.URL + "/WebServices/CubeStructure.asmx/GetPickerHTMLP", g = "{'dataSourceID':" + checkNull(a) + ",'structureType':'" + d + "','token':" + $kyu.checkNull($kyu.token) + "}"); g = g.replace(/'/g, '"'); g = JSON.parse(g); $.ajax({
                type: "POST", contentType: "application/json; charset=utf-8", url: f, data: g, dataType: "jsonp", success: function (b) {
                    $kyu.diagnoseResponse(b) && (b = b.replace(/<img src='../g, "<img src='" + $kyu.config.URL),
                        $("#cubeStructurePickerCell").html(b), $("#cubeStructurePickerCell").data("datasourceid", a), $("#kyubitDialogShadow").width($(window).width()), $("#kyubitDialogShadow").height($(window).height()), $("#kyubitDialogShadow").show(), $kyu.ShowCenterFixed("CubeStructurePickerDiv"))
                }
            })
    }
} function hideCubeStructurePicker() { $("#kyubitDialogShadow").hide(); $("#CubeStructurePickerDiv").hide() }
$kyu.showLegendMenu = function (a, b, d) {
    $kyu.HideMenu(); _operatingTile = $("#" + a.divID).parents(".tile")[0]; menuManager.HideAllMenus(); menuManager.RemoveAllMenus(); _legendMenu = new ContextMenu; _legendMenu.Title = "LegendMenu"; var e; _sortingsMenu = new ContextMenu; _sortingsMenu.Title = "Sorting"; e = new MenuItem; e.Title = $kyu.lng("__asc"); e.ActionURL = 'javascript:$kyu.HideMenu();$kyu.setColumnSorting("' + a.divID + '",' + b.seriaIndex + ',"ASC")'; _sortingsMenu.Items.add(e); e = new MenuItem; e.Title = $kyu.lng("__desc"); e.ActionURL =
        'javascript:$kyu.HideMenu();$kyu.setColumnSorting("' + a.divID + '",' + b.seriaIndex + ',"DESC")'; _sortingsMenu.Items.add(e); e = new MenuItem; e.Title = $kyu.lng("__removeSorting"); e.ActionURL = "javascript:$kyu.HideMenu();changeChartRemoveSorting()"; _sortingsMenu.Items.add(e); menuManager.CreateMenu(_sortingsMenu, 232); e = new MenuItem; e.Title = $kyu.lng("__sorting"); e.SubMenu = "menuManager.ShowMenu(_sortingsMenu, _legendMenu, null, event);setTimeout( continueMenuHiding, 200 );"; _legendMenu.Items.add(e); _topsMenu = new ContextMenu;
    _topsMenu.Title = "Top"; e = new MenuItem; e.Title = "5"; e.ActionURL = 'javascript:$kyu.HideMenu(); $kyu.setTop("' + a.divID + '",' + b.seriaIndex + ", 5)"; _topsMenu.Items.add(e); e = new MenuItem; e.Title = "10"; e.ActionURL = 'javascript:$kyu.HideMenu(); $kyu.setTop("' + a.divID + '",' + b.seriaIndex + ", 10)"; _topsMenu.Items.add(e); e = new MenuItem; e.Title = "20"; e.ActionURL = 'javascript:$kyu.HideMenu(); $kyu.setTop("' + a.divID + '",' + b.seriaIndex + ", 20)"; _topsMenu.Items.add(e); e = new MenuItem; e.Title = "50"; e.ActionURL = 'javascript:$kyu.HideMenu(); $kyu.setTop("' +
        a.divID + '",' + b.seriaIndex + ", 50)"; _topsMenu.Items.add(e); e = new MenuItem; e.Title = "100"; e.ActionURL = 'javascript:$kyu.HideMenu(); $kyu.setTop("' + a.divID + '",' + b.seriaIndex + ", 100)"; _topsMenu.Items.add(e); e = new MenuItem; e.Title = $kyu.lng("__removeFilter"); e.ActionURL = "javascript:$kyu.HideMenu(); changeChartRemoveTop()"; _topsMenu.Items.add(e); menuManager.CreateMenu(_topsMenu, 232); e = new MenuItem; e.Title = $kyu.lng("__top"); e.SubMenu = "menuManager.ShowMenu(_topsMenu, _legendMenu, null, event);setTimeout( continueMenuHiding, 200 );";
    _legendMenu.Items.add(e); if ("Column_Chart" == $(_operatingTile).data("presentationtype") || "Line_Chart" == $(_operatingTile).data("presentationtype") || "Area_Chart" == $(_operatingTile).data("presentationtype")) e = new MenuItem, e.Separator = !0, _legendMenu.Items.add(e), e = new MenuItem, e.Title = $kyu.lng("__trendLine"), e.ActionURL = 'javascript:$kyu.HideMenu();changeChartTrendSeries("' + b.partialText + '")', _legendMenu.Items.add(e), e = new MenuItem, e.Title = $kyu.lng("__averageLine"), e.ActionURL = 'javascript:$kyu.HideMenu();changeChartAverageSeries("' +
        b.partialText + '")', _legendMenu.Items.add(e); e = new MenuItem; e.Separator = !0; _legendMenu.Items.add(e); e = new MenuItem; e.Title = $kyu.lng("__valLabels"); e.ActionURL = 'javascript:$kyu.HideMenu();changeChartSeriesValueLabels("' + b.partialText + '")'; _legendMenu.Items.add(e); menuManager.CreateMenu(_legendMenu, 218); menuManager.ShowMenu(_legendMenu, null, null, d); setTimeout(continueMenuHiding, 230)
};
function changeChartRemoveSorting() { $(_operatingTile).data("sortcolumn", null); $(_operatingTile).data("sortorder", null); $kyu.renderTile(_operatingTile) } function changeChartRemoveTop() { $(_operatingTile).data("top", null); $kyu.renderTile(_operatingTile) }
function changeChartTrendSeries(a) { !$(_operatingTile).data("opt_trendline") || -1 == $(_operatingTile).data("opt_trendline").indexOf(a + ";") ? $(_operatingTile).data("opt_trendline") ? $(_operatingTile).data("opt_trendline", $(_operatingTile).data("opt_trendline") + a + ";") : $(_operatingTile).data("opt_trendline", a + ";") : $(_operatingTile).data("opt_trendline", $(_operatingTile).data("opt_trendline").replace(a + ";", "")); $kyu.renderTile(_operatingTile) }
function changeChartAverageSeries(a) { !$(_operatingTile).data("opt_averageline") || -1 == $(_operatingTile).data("opt_averageline").indexOf(a + ";") ? $(_operatingTile).data("opt_averageline") ? $(_operatingTile).data("opt_averageline", $(_operatingTile).data("opt_averageline") + a + ";") : $(_operatingTile).data("opt_averageline", a + ";") : $(_operatingTile).data("opt_averageline", $(_operatingTile).data("opt_averageline").replace(a + ";", "")); $kyu.renderTile(_operatingTile) }
function changeChartSeriesValueLabels(a) {
    _operatingTile && ((!$(_operatingTile).data("opt_displayvalues") || "None" == $(_operatingTile).data("opt_displayvalues")) && $(_operatingTile).data("opt_displayvalues", "All"), $(_operatingTile).data("opt_displayvaluesfilterseries") ? -1 < $(_operatingTile).data("opt_displayvaluesfilterseries").indexOf(a + ";") ? ($(_operatingTile).data("opt_displayvaluesfilterseries", $(_operatingTile).data("opt_displayvaluesfilterseries").replace(a + ";", "")), $(_operatingTile).data("opt_displayvaluesfilterseries") ||
        $(_operatingTile).data("opt_displayvalues", "None")) : $(_operatingTile).data("opt_displayvaluesfilterseries", $(_operatingTile).data("opt_displayvaluesfilterseries") + a + ";") : $(_operatingTile).data("opt_displayvaluesfilterseries", a + ";"), $kyu.renderTile(_operatingTile))
} function isIE() { return $.browser.msie || -1 < navigator.userAgent.indexOf("Trident") };
